(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    444132,      11177]
NotebookOptionsPosition[    420044,      10386]
NotebookOutlinePosition[    420843,      10412]
CellTagsIndexPosition[    420800,      10409]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Generation of Data for Testing the Revised Calibration Software\
\>", "Title"],

Cell["\<\
\tcalibration algorithm/code:\t\[Bullet] Tsai-Wilson,
\t\t\t\t\t\[Bullet] Kim,
\t\t\t\t\t\[Bullet] DLT\
\>", "Subtitle",
 CellChangeTimes->{{3.4117293403250723`*^9, 3.4117293465197983`*^9}, {
  3.413104787504335*^9, 3.4131048481242313`*^9}, {3.4132076374998417`*^9, 
  3.413207647697074*^9}, {3.413207699770657*^9, 3.413207700014862*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
0. Definition of the Parameters Used Throughout This Document\
\>", "Section",
 CellChangeTimes->{{3.413499430541936*^9, 3.413499436090013*^9}, {
  3.413499469098995*^9, 3.413499481972054*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<VectorAnalysis`\>\"", "]"}]], "Input"],

Cell["0.1 Raw parameters", "Subsection",
 CellChangeTimes->{3.4117055215778303`*^9, 3.4134995002556343`*^9}],

Cell["\<\
The dimensions of all objects are given in millimeters but, in the end, image \
positions are given in pixels.  We follow Tsai & Wilson' s convention and \
define
\t\[Bullet] Ncx, the number of sensor elements in the camera' s X direction \
(sels),
\t\[Bullet] Nfx, the number of pixels in the frame grabber' s X direction \
(pixels),
\t\[Bullet] dx, X dimension of a camera sensor element (mm/sel),
\t\[Bullet] dy, Y dimension of a camera sensor element (mm/sel),
\t\[Bullet] dpx effective X dimension of pixel in frame grabber (mm/pixel),
\t\[Bullet] dpy effective Y dimension of pixel in frame grabber (mm/pixel).
  \t\[Bullet] Cx, Cy, pixel coordinates of the true image center
\t\[Bullet] sx, pixel h/v scaling ratio
To these parameters, we add the skewing parameter \[Sigma] (see later)\
\>", "Text",
 CellChangeTimes->{{3.4134997593231993`*^9, 3.413499804197106*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"my\[Psi]", "=", 
   RowBox[{"N", "[", 
    RowBox[{"\[Pi]", "/", "6"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"my\[Theta]", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], "/", "8"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"my\[CurlyPhi]", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["myT", "x"], "=", 
    RowBox[{"-", "300."}]}], ";"}], " ", 
  RowBox[{"(*", " ", "mm", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["myT", "y"], "=", "100."}], ";"}], " ", 
  RowBox[{"(*", " ", "mm", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["myT", "z"], "=", 
    RowBox[{"-", "2000"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "mm", " ", "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myNcx", "=", "768"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myNcy", "=", "494"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mydx", "=", "0.005729166667"}], ";"}], " ", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mm", "/", "sensor"}], " ", "elt"}], " ", "*)"}],
   FontColor->RGBColor[0, 0, 1]]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mydy", "=", "0.006680161943"}], ";"}], " ", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"mm", "/", "sensor"}], " ", "elt"}], " ", "*)"}],
   FontColor->RGBColor[0, 0, 1]], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"myNfx", "=", "640"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myNfy", "=", "480"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myCx", "=", "320"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myCy", "=", "240"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mysx", "=", "1.0"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mydpx", "=", 
    RowBox[{"mydx", "*", 
     RowBox[{"myNcx", "/", "myNfx"}]}]}], ";"}], " ", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"mm", "/", "pixel"}], " ", "*)"}],
   FontColor->RGBColor[0, 0, 1]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mydpy", "=", 
    RowBox[{"mydy", "*", 
     RowBox[{"myNcy", "/", "myNfy"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myFoc", "=", "8.0"}], ";"}], " ", 
  StyleBox[
   RowBox[{"(*", " ", "mm", " ", "*)"}],
   FontColor->RGBColor[0, 0, 1]]}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["my\[Kappa]", "1"], "=", "0.02"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myfpx", "=", 
    RowBox[{"myFoc", "/", "mydpx"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"focal", " ", "length", " ", "in", " ", "pixels"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myfpy", "=", 
   RowBox[{"myFoc", "/", "mydpy"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"my\[Sigma]", "=", "0."}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myskw", "=", 
    RowBox[{"my\[Sigma]", "*", "myfpy"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["myLarge\[Kappa]", "1"], "=", "0.05"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myLarge\[Sigma]", "=", "0.06"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myLargeSkw", "=", 
   RowBox[{"myLarge\[Sigma]", "*", "myfpy"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4117008752070227`*^9, 3.4117009680823803`*^9}, {
   3.411701177456257*^9, 3.4117011888522663`*^9}, {3.41170122117089*^9, 
   3.411701268533692*^9}, {3.411704432944283*^9, 3.411704460601843*^9}, {
   3.411704523325145*^9, 3.411704575374606*^9}, 3.411710458183798*^9, {
   3.411710511744051*^9, 3.411710511994713*^9}, {3.413192624087387*^9, 
   3.413192629556511*^9}, {3.4132098202657003`*^9, 3.4132098223935204`*^9}, {
   3.413210372686798*^9, 3.4132103742442303`*^9}, {3.413477203847541*^9, 
   3.413477235611722*^9}, {3.41349128184857*^9, 3.413491287305418*^9}, {
   3.413499526278553*^9, 3.413499584730452*^9}, 3.413499890370109*^9, {
   3.41349995613361*^9, 3.413499957531764*^9}, {3.413500123810479*^9, 
   3.413500128021936*^9}, {3.4135185934643583`*^9, 3.4135187986484537`*^9}, {
   3.41351944794769*^9, 3.4135195259585047`*^9}, {3.4135196178501663`*^9, 
   3.4135196182545156`*^9}, {3.414701162364429*^9, 3.4147011802567987`*^9}, {
   3.41470153653928*^9, 3.414701569893692*^9}, {3.414701644859779*^9, 
   3.4147016748618717`*^9}}],

Cell[CellGroupData[{

Cell["0.2 Definition of the substitution rule", "Subsection",
 CellChangeTimes->{{3.411695847020062*^9, 3.411695861429132*^9}, 
   3.411705524009371*^9, 3.4134995035976048`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"projRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]", "\[Rule]", "my\[Psi]"}], ",", 
    RowBox[{"\[Theta]", "\[Rule]", "my\[Theta]"}], ",", 
    RowBox[{"\[CurlyPhi]", "\[Rule]", "my\[CurlyPhi]"}], ",", 
    RowBox[{
     SubscriptBox["T", "x"], "\[Rule]", 
     SubscriptBox["myT", "x"]}], ",", 
    RowBox[{
     SubscriptBox["T", "y"], "\[Rule]", 
     SubscriptBox["myT", "y"]}], ",", 
    RowBox[{
     SubscriptBox["T", "z"], "\[Rule]", 
     SubscriptBox["myT", "z"]}], ",", 
    RowBox[{"Ncx", "\[Rule]", "myNcx"}], ",", 
    RowBox[{"Ncy", "\[Rule]", "myNcy"}], ",", 
    RowBox[{"dx", "\[Rule]", "mydx"}], ",", 
    RowBox[{"dy", "\[Rule]", "mydy"}], ",", 
    RowBox[{"Nfx", "\[Rule]", "myNfx"}], ",", 
    RowBox[{"Nfy", "\[Rule]", "myNfy"}], ",", 
    RowBox[{"Cx", "\[Rule]", "myCx"}], ",", 
    RowBox[{"Cy", "\[Rule]", "myCy"}], ",", 
    RowBox[{"sx", "\[Rule]", "mysx"}], ",", 
    RowBox[{"dpx", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"mydx", "*", 
       RowBox[{"myNcx", "/", "myNfx"}]}], ")"}]}], ",", 
    RowBox[{"dpy", "\[Rule]", "mydpy"}], ",", 
    RowBox[{"f", "\[Rule]", "myFoc"}], ",", 
    RowBox[{
     SubscriptBox["\[Kappa]", "1"], "\[Rule]", 
     SubscriptBox["my\[Kappa]", "1"]}], ",", 
    RowBox[{"\[Sigma]", "\[Rule]", "my\[Sigma]"}], ",", 
    RowBox[{"fpx", "\[Rule]", "myfpx"}], ",", 
    RowBox[{"fpy", "\[Rule]", "myfpy"}], ",", 
    RowBox[{"skw", "\[Rule]", "myskw"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Psi]", "\[Rule]", "0.5235987755982988`"}], ",", 
   RowBox[{"\[Theta]", "\[Rule]", 
    RowBox[{"-", "0.39269908169872414`"}]}], ",", 
   RowBox[{"\[CurlyPhi]", "\[Rule]", 
    RowBox[{"-", "0.5235987755982988`"}]}], ",", 
   RowBox[{
    SubscriptBox["T", "x"], "\[Rule]", 
    RowBox[{"-", "300.`"}]}], ",", 
   RowBox[{
    SubscriptBox["T", "y"], "\[Rule]", "100.`"}], ",", 
   RowBox[{
    SubscriptBox["T", "z"], "\[Rule]", 
    RowBox[{"-", "2000"}]}], ",", 
   RowBox[{"Ncx", "\[Rule]", "768"}], ",", 
   RowBox[{"Ncy", "\[Rule]", "494"}], ",", 
   RowBox[{"dx", "\[Rule]", "0.005729166667`"}], ",", 
   RowBox[{"dy", "\[Rule]", "0.006680161943`"}], ",", 
   RowBox[{"Nfx", "\[Rule]", "640"}], ",", 
   RowBox[{"Nfy", "\[Rule]", "480"}], ",", 
   RowBox[{"Cx", "\[Rule]", "320"}], ",", 
   RowBox[{"Cy", "\[Rule]", "240"}], ",", 
   RowBox[{"sx", "\[Rule]", "1.`"}], ",", 
   RowBox[{"dpx", "\[Rule]", "0.0068750000004`"}], ",", 
   RowBox[{"dpy", "\[Rule]", "0.006874999999670832`"}], ",", 
   RowBox[{"f", "\[Rule]", "8.`"}], ",", 
   RowBox[{
    SubscriptBox["\[Kappa]", "1"], "\[Rule]", "0.02`"}], ",", 
   RowBox[{"\[Sigma]", "\[Rule]", "0.`"}], ",", 
   RowBox[{"fpx", "\[Rule]", "1163.6363635686612`"}], ",", 
   RowBox[{"fpy", "\[Rule]", "1163.6363636920773`"}], ",", 
   RowBox[{"skw", "\[Rule]", "0.`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.413519536289043*^9, {3.4135195961446123`*^9, 3.41351962356295*^9}, 
   3.413632455574531*^9, 3.413811434087686*^9, 3.414693886510085*^9, 
   3.414701592611693*^9, 3.414701690087304*^9, 3.4151633606718073`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"distortRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ncx", "\[Rule]", "myNcx"}], ",", 
    RowBox[{"Ncy", "\[Rule]", "myNcy"}], ",", 
    RowBox[{"dx", "\[Rule]", "mydx"}], ",", 
    RowBox[{"dy", "\[Rule]", "mydy"}], ",", 
    RowBox[{"Nfx", "\[Rule]", "myNfx"}], ",", 
    RowBox[{"Nfy", "\[Rule]", "myNfy"}], ",", 
    RowBox[{"Cx", "\[Rule]", "myCx"}], ",", 
    RowBox[{"Cy", "\[Rule]", "myCy"}], ",", 
    RowBox[{"sx", "\[Rule]", "mysx"}], ",", 
    RowBox[{"dpx", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"mydx", "*", 
       RowBox[{"myNcx", "/", "myNfx"}]}], ")"}]}], ",", 
    RowBox[{"dpy", "\[Rule]", "mydpy"}], ",", 
    RowBox[{"f", "\[Rule]", "myFoc"}], ",", 
    RowBox[{
     SubscriptBox["\[Kappa]", "1"], "\[Rule]", 
     SubscriptBox["myLarge\[Kappa]", "1"]}], ",", 
    RowBox[{"\[Sigma]", "\[Rule]", "myLarge\[Sigma]"}], ",", 
    RowBox[{"fpx", "\[Rule]", "myfpx"}], ",", 
    RowBox[{"fpy", "\[Rule]", "myfpy"}], ",", 
    RowBox[{"skw", "\[Rule]", "myLargeSkw"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4116958819254923`*^9, 3.41169611381663*^9}, {
  3.4116961697963743`*^9, 3.411696272891512*^9}, {3.413499595621106*^9, 
  3.413499602788705*^9}, {3.4135187627477922`*^9, 3.413518766529509*^9}, {
  3.413518810025585*^9, 3.413518851585533*^9}, {3.4135195507532387`*^9, 
  3.413519589672154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Ncx", "\[Rule]", "768"}], ",", 
   RowBox[{"Ncy", "\[Rule]", "494"}], ",", 
   RowBox[{"dx", "\[Rule]", "0.005729166667`"}], ",", 
   RowBox[{"dy", "\[Rule]", "0.006680161943`"}], ",", 
   RowBox[{"Nfx", "\[Rule]", "640"}], ",", 
   RowBox[{"Nfy", "\[Rule]", "480"}], ",", 
   RowBox[{"Cx", "\[Rule]", "320"}], ",", 
   RowBox[{"Cy", "\[Rule]", "240"}], ",", 
   RowBox[{"sx", "\[Rule]", "1.`"}], ",", 
   RowBox[{"dpx", "\[Rule]", "0.0068750000004`"}], ",", 
   RowBox[{"dpy", "\[Rule]", "0.006874999999670832`"}], ",", 
   RowBox[{"f", "\[Rule]", "8.`"}], ",", 
   RowBox[{
    SubscriptBox["\[Kappa]", "1"], "\[Rule]", "0.05`"}], ",", 
   RowBox[{"\[Sigma]", "\[Rule]", "0.06`"}], ",", 
   RowBox[{"fpx", "\[Rule]", "1163.6363635686612`"}], ",", 
   RowBox[{"fpy", "\[Rule]", "1163.6363636920773`"}], ",", 
   RowBox[{"skw", "\[Rule]", "69.81818182152463`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.411696275174711*^9, 3.411698997988885*^9, {3.4117012533230343`*^9, 
   3.4117012704503317`*^9}, 3.411704027088632*^9, {3.41170453963864*^9, 
   3.411704578959344*^9}, 3.4117055284427767`*^9, {3.411710463984806*^9, 
   3.411710474628237*^9}, 3.411710515366765*^9, 3.411821580782672*^9, 
   3.411900268787552*^9, 3.4119970069968567`*^9, 3.412000954483632*^9, 
   3.412425777102789*^9, 3.412947524538097*^9, 3.4131054459641457`*^9, 
   3.4131919302408457`*^9, 3.4131926396661253`*^9, 3.4132098261246023`*^9, 
   3.413210382980103*^9, 3.413418767894943*^9, 3.4134996039700823`*^9, 
   3.4134998957322893`*^9, 3.413499961418549*^9, 3.4135001325866337`*^9, {
   3.413518856498535*^9, 3.4135188614011927`*^9}, {3.4135195908589354`*^9, 
   3.413519598874422*^9}, 3.413632455646304*^9, 3.413811434154066*^9, 
   3.4146938865817413`*^9, 3.414701592701603*^9, 3.414701690160309*^9, 
   3.415163360744581*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["1. Camera-toWorld Transformation: Extrinsic Parameters", "Section",
 CellChangeTimes->{{3.411705028603356*^9, 3.41170503766291*^9}, {
  3.413499453179041*^9, 3.413499463706118*^9}}],

Cell[CellGroupData[{

Cell["1.1 Pose transform", "Subsection",
 CellChangeTimes->{{3.411705071683094*^9, 3.4117050717979727`*^9}}],

Cell["1.1.1 Translation term", "Subsubsection",
 CellChangeTimes->{{3.411705073936098*^9, 3.411705074542306*^9}}],

Cell[TextData[{
 "The \"world\" and \"camera\" coordinate systems are different. We take for \
granted that the transformation between the two is expressend in the camera's \
coordinate system. It is given by :\n\t\[Bullet] a translation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["T",
     FontWeight->"Bold",
     FontSlant->"Plain"], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["T", "x"], ",", " ", 
      SubscriptBox["T", "y"], ",", " ", 
      SubscriptBox["T", "z"]}], "}"}]}], TraditionalForm]]],
 ",\n\t\[Bullet] a rotation specified by the yaw, pitch, and roll angles, \
\[Psi], \[Theta], and \[CurlyPhi] respectively."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TransVec", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["T", "x"], ",", 
     SubscriptBox["T", "y"], ",", 
     SubscriptBox["T", "z"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransMat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", 
       SubscriptBox["T", "x"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", 
       SubscriptBox["T", "y"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", 
       SubscriptBox["T", "z"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "TransMat", "]"}]}], "Input",
 CellChangeTimes->{{3.411698652483509*^9, 3.411698681111363*^9}, {
  3.411698785450654*^9, 3.411698867374957*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      SubscriptBox["T", "x"]},
     {"0", "1", "0", 
      SubscriptBox["T", "y"]},
     {"0", "0", "1", 
      SubscriptBox["T", "z"]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4116988697710752`*^9, 3.411705176456687*^9, 
  3.411820617755466*^9, 3.4119002575385847`*^9, 3.411996937934602*^9, 
  3.412000951840476*^9, 3.412425770703521*^9, 3.412947521226941*^9, 
  3.413105400422736*^9, 3.413191926710691*^9, 3.413418763784233*^9, 
  3.413632455801125*^9, 3.4138114342888317`*^9, 3.414693886736343*^9, 
  3.4147015927687187`*^9, 3.4147016902267714`*^9, 3.4151633608127537`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.1.2 Construction of the rotation matrix", "Subsubsection",
 CellChangeTimes->{{3.411705077152124*^9, 3.411705077789731*^9}}],

Cell[TextData[{
 "We assume that we apply Yaw, then Pitch, then Roll (around the ",
 StyleBox["fixed",
  FontWeight->"Bold"],
 " axes)."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bigRotX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}], ",", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4116983900657043`*^9, 3.411698404593886*^9}, {
  3.411698459012945*^9, 3.4116984668960876`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "RotX", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "bigRotX", "]"}]}], "Input",
 CellChangeTimes->{{3.411698409394346*^9, 3.4116984128160067`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}]},
     {"0", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265063807*^9, 3.411680047916349*^9, 
  3.411698419983941*^9, 3.411698468927807*^9, 3.411705176625543*^9, 
  3.4118206179427958`*^9, 3.4119002576751432`*^9, 3.411996938102085*^9, 
  3.412000952065145*^9, 3.412425770861657*^9, 3.41294752136574*^9, 
  3.413105400581644*^9, 3.4131919268946533`*^9, 3.413418764047634*^9, 
  3.413632455901638*^9, 3.413811434370583*^9, 3.4146938868289223`*^9, 
  3.414701592859831*^9, 3.4147016903357077`*^9, 3.415163360936759*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "0"},
     {"0", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265063807*^9, 3.411680047916349*^9, 
  3.411698419983941*^9, 3.411698468927807*^9, 3.411705176625543*^9, 
  3.4118206179427958`*^9, 3.4119002576751432`*^9, 3.411996938102085*^9, 
  3.412000952065145*^9, 3.412425770861657*^9, 3.41294752136574*^9, 
  3.413105400581644*^9, 3.4131919268946533`*^9, 3.413418764047634*^9, 
  3.413632455901638*^9, 3.413811434370583*^9, 3.4146938868289223`*^9, 
  3.414701592859831*^9, 3.4147016903357077`*^9, 3.415163360962144*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RotY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"bigRotY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4116984263767767`*^9, 3.411698485239341*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "RotY", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "bigRotY", "]"}]}], "Input",
 CellChangeTimes->{{3.4116984342644587`*^9, 3.41169843782163*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]},
     {"0", "1", "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265135487*^9, 3.411680048056986*^9, 
  3.411698487309635*^9, 3.411705176789682*^9, 3.411820618026659*^9, 
  3.411900257747121*^9, 3.4119969381855*^9, 3.412000952227173*^9, 
  3.412425770946426*^9, 3.4129475214504137`*^9, 3.41310540066742*^9, 
  3.413191926993862*^9, 3.4134187641569223`*^9, 3.4136324560284243`*^9, 
  3.413811434491736*^9, 3.414693886946465*^9, 3.414701592946582*^9, 
  3.4147016904384813`*^9, 3.4151633610652246`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "0"},
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265135487*^9, 3.411680048056986*^9, 
  3.411698487309635*^9, 3.411705176789682*^9, 3.411820618026659*^9, 
  3.411900257747121*^9, 3.4119969381855*^9, 3.412000952227173*^9, 
  3.412425770946426*^9, 3.4129475214504137`*^9, 3.41310540066742*^9, 
  3.413191926993862*^9, 3.4134187641569223`*^9, 3.4136324560284243`*^9, 
  3.413811434491736*^9, 3.414693886946465*^9, 3.414701592946582*^9, 
  3.4147016904384813`*^9, 3.415163361090762*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotZ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], ",", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bigRotZ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], ",", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.411698526793997*^9, 3.411698547934664*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "RotZ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "bigRotZ", "]"}]}], "Input",
 CellChangeTimes->{{3.4116985523374033`*^9, 3.411698555743773*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265528054*^9, 3.4116800483077993`*^9, 
  3.411698559545084*^9, 3.411705176976303*^9, 3.4118206181916924`*^9, 
  3.411900257830165*^9, 3.4119969382693453`*^9, 3.412000952391509*^9, 
  3.412425771046155*^9, 3.4129475215330276`*^9, 3.41310540074806*^9, 
  3.41319192709398*^9, 3.4134187642725153`*^9, 3.413632456152478*^9, 
  3.413811434606798*^9, 3.414693887062604*^9, 3.41470159302993*^9, 
  3.4147016905400953`*^9, 3.4151633611980352`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "0", "0"},
     {
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623265528054*^9, 3.4116800483077993`*^9, 
  3.411698559545084*^9, 3.411705176976303*^9, 3.4118206181916924`*^9, 
  3.411900257830165*^9, 3.4119969382693453`*^9, 3.412000952391509*^9, 
  3.412425771046155*^9, 3.4129475215330276`*^9, 3.41310540074806*^9, 
  3.41319192709398*^9, 3.4134187642725153`*^9, 3.413632456152478*^9, 
  3.413811434606798*^9, 3.414693887062604*^9, 3.41470159302993*^9, 
  3.4147016905400953`*^9, 3.415163361223228*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"RotMat", "=", 
   RowBox[{"RotZ", ".", "RotY", ".", "RotX"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bigRotMat", "=", 
   RowBox[{"bigRotZ", ".", "bigRotY", ".", "bigRotX"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bigTransfMat", "=", 
   RowBox[{"TransMat", ".", "bigRotZ", ".", "bigRotY", ".", "bigRotX"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "RotMat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "bigRotMat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "bigTransfMat", "]"}]}], "Input",
 CellChangeTimes->{{3.411698593058017*^9, 3.411698615203697*^9}, {
  3.411698691344689*^9, 3.411698775288455*^9}, {3.4116988892092323`*^9, 
  3.411698898050605*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4116988988445168`*^9, 3.411705177102563*^9, 
  3.41182061835085*^9, 3.4119002579131403`*^9, 3.411996938336726*^9, 
  3.412000952520246*^9, 3.412425771112844*^9, 3.412947521606468*^9, 
  3.413105400823928*^9, 3.413191927197731*^9, 3.4134187643764668`*^9, 
  3.413632456266081*^9, 3.4138114347185287`*^9, 3.414693887167571*^9, 
  3.4147015931027308`*^9, 3.414701690627366*^9, 3.4151633613083143`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4116988988445168`*^9, 3.411705177102563*^9, 
  3.41182061835085*^9, 3.4119002579131403`*^9, 3.411996938336726*^9, 
  3.412000952520246*^9, 3.412425771112844*^9, 3.412947521606468*^9, 
  3.413105400823928*^9, 3.413191927197731*^9, 3.4134187643764668`*^9, 
  3.413632456266081*^9, 3.4138114347185287`*^9, 3.414693887167571*^9, 
  3.4147015931027308`*^9, 3.414701690627366*^9, 3.4151633613342447`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      SubscriptBox["T", "x"]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], 
      SubscriptBox["T", "y"]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], 
      SubscriptBox["T", "z"]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4116988988445168`*^9, 3.411705177102563*^9, 
  3.41182061835085*^9, 3.4119002579131403`*^9, 3.411996938336726*^9, 
  3.412000952520246*^9, 3.412425771112844*^9, 3.412947521606468*^9, 
  3.413105400823928*^9, 3.413191927197731*^9, 3.4134187643764668`*^9, 
  3.413632456266081*^9, 3.4138114347185287`*^9, 3.414693887167571*^9, 
  3.4147015931027308`*^9, 3.414701690627366*^9, 3.415163361355245*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.1.3 The complete change of coordinates", "Subsubsection",
 CellChangeTimes->{{3.411705085119351*^9, 3.4117050852286053`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w2c", "[", 
    RowBox[{"{", 
     RowBox[{"Xw_", ",", "Yw_", ",", "Zw_"}], "}"}], "]"}], "=", 
   RowBox[{
    RowBox[{"RotMat", ".", 
     RowBox[{"{", 
      RowBox[{"Xw", ",", "Yw", ",", "Zw"}], "}"}]}], "+", "TransVec"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.411698652347514*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.2 Checking that it is OK", "Subsection",
 CellChangeTimes->{{3.411705098324998*^9, 3.411705098780352*^9}}],

Cell["1.2.1 Generation of 3D points in \"World\" coordinates", "Subsubsection",
 CellChangeTimes->{{3.411705113725319*^9, 3.411705151785657*^9}}],

Cell["\<\
We generate a set of points in the world coordinate system and check that \
they look all right in the camera's coordinate system. \
\>", "Text"],

Cell[GraphicsData["PICT", "\<\
C?@000000<P1FP0A0_l<0?on0000B00004P000000000b05J0000002Q06@01TA1
A3Em002Q06A4FDA1A3Em0P000@00002d0013W`0_@_L0bSKF0?Pg[P8T3AT00001
0000000_@_L0bSKF0?Pg[P8T3AT00@0000000000000000000040000000000000
0000000100000@000000000000000000004000000000000000000001000000=h
0004e0001;`000D40004k0000N`0005X00005000000000HH0000]000?EL003h;
0006B<0NB@K[>]R3@3E^5/mb/<K033@L<P171P0000000000@2MjR2oHA=107;N/
R[F?hT0bKO4QJ__g000000000010AIFUFQD[o40T:O[Q;NW[`3m/nF3fT@400000
000000000000000000000000000000000000000000000000?o000000000lZWTi
C9j:2P000000000000000000002lZWTiC9j:2So`000000000000000000000000
000000000000000000000000002ol00000000000000000000000000000000000
0000042_@0000000?o000000002oeA5Xo:j0Fco]d=7B]MB>_l>N[g2bAj/00000
000003oPECeHkgg8?m?j=ClJ8DlojJ@GeG=ddP0000000000?nU[o6I?ljdoakn[
2J<hakoRPITIal14000000000000000000000000000000000000000000000000
000000001m0000nP00013P00002ol00000000;bZNCU<WXX:00000000000ol000
0000080000000000P00000000010[d000000041bHiF`0000@62gBT0000000000
0000000000000000000000000010=`000000040g00000000@4/[Mo1cMI800000
0000000000000000000000000010=`000000040g00000000@3L000000010=`00
000003o`000000000000000000000000000000000000000000000000000ol000
000000000000000000000000000000000000000000000000?o00000000000000
00000000000000000000000000000000000003o`000000000003J00000000001
00000P000040000000000000004ol000000003o`00000000?o000000000og<c<
c<c<cCoS<c<c<c<c?n0000000000000200000000004000010000000000000000
000003o`00000000@4L000000010A`0000000<1>00000000?o000000000ol000
000003o`0000000000000000000000000000041VP000000000000@0000000001
00000000000000000000000000000000000003o`00000000?o000000000ol000
0000000000400003000000000000000000000000000000000000000000000000
000000000000000000004@0000000000000000000000000000000000000ol000
000000000000000000000000000okGOT;8F@/SoHcgCNVm=l00000000000oiYDF
@/QI33oVUAT;8F@/00000000000of<m_CNVm>3o]MnKdgY_D0000000000000000
000003o`0000000000000000002of<n5T;8F@So]MnKdgY_D00000000002oiYDN
Vm=jL3oVUAT;8F@/00000000002okGOb5T;8FCoHcgCNVm=l00000000002ol000
000000000000000000000000002okGOb5T;8FKoHch/QI2b600000000002oiYDN
Vm=jL;oVUAjKdgY`00000000002of<n5T;8F@[o]Mnm=jKdh0000000000000000
00000;o`0000000000000000000of<m_CNVm>;o]Mnm=jKdh00000000000oiYDF
@/QI3;oVUAjKdgY`00000000000okGOT;8F@/[oHch/QI2b600000000000ol000
0000000000000000000000000000000000000000ooooooooool0079WHR1EKV]^
KgM^0<0QNJQgeNlc`3A9K9OB0Vg0AH9?l/8_j00000000000`25NLiTNGZ50>;JU
S[/mdl0Sb03MRcgd000000000010Eaf740`WQD0e0YE8^dND`3b`>`EUHVD00000
000000000000000000000000000000000000000000000000?o000000000lZWTi
C9j:2P000000000000000000002lZWTiC9j:2So`000000000000000000000000
000000000000000000000000002ol00000000000000000000000000000000000
0000042_@0000000?o000000002oab35NGMKo[oJfEd2QHT>_nagMW8[njP00000
00000;oCfJR^oR<1?n`nM13EoH>oeY]^]0cI5`0000000000?ngN3<D;Lf/obbF]
^T`oFKoBR;mf1d3;000000000000000000000000000000000000000000000000
000000001m0000nP00013P00002ol00000000;bZNCU<WXX:00000000000ol000
0000080000000000P00000000010[d000000041`3CA00000@5kaiT0000000000
0000000000000000000000000010B2g4f`[8:T0l00000000@5S43V>9@^X00000
0000000000000000000000000010DP000000040l00000000@58000000010?000
000003o`000000000000000000000000000000000000000000000000000ol000
000000000000000000000000000000000000000000000000?o00000000000000
00000000000000000000000000000000000003o`000000000003J00000000001
000000000040000000000000004ol000000003o`00000000?o000000000og<c<
c<c<cCoS<c<c<c<c?n0000000000000200000000004000010000000000000000
000003o`00000000@5P]a=/:b2Y0C00000000<1Xa0iSRD;Z?o000000000ol000
000003o`0000000000000000000000000000041VP000000000000@0000000001
00000000000000000000000000000000000003o`00000000?o000000000ol000
0000000000400003000000000000000000000000000000000000000000000000
000000000000000000001@0000000000000000000000000000000000002ol000
00000;o`0000000000000000000ol00000000;o`0000000000000000000ol000
000003o`0000000000000000002ol000000003o`0000000000000000002ol000
00000;o`00000000000000000000000000000000ool006<04000079WHR0`LR0P
83TiIb0P834fHP000@0000000000000000000040000000000000000000000000
0@00000000000000000000400000000000000000000100000@00004000000000
0000000S_`00000000000000000000000P010040000200000000000000000000
00000000000000000000000000000000000000000000000000010001D0000FSo
oooooooooooo0000000000000000003oo`000000004kQQH1HTnX00000?oo0000
000000000000003oo`000000004kQQH1HTnX0040003Lim@06@<;0=FB?ooiZYd0
007/ooe5__ohdah01D1D0@400000000000400000]0000CP0000000000005M8@0
1f^600000@000000TAbR0@;`1P2HnW<13_KP002Ml@000000000000000000/HL0
0000of0o2?nKGZh00@00006Nl0000000000000000001LBT000000@;`1`2A7:80
0@00ooooo`0007`0000`ooooooooooooooooooooo`0000<000000000U0000;@0
001X000170000=000@0000000000000000000040000000000000000000000000
0@0000000000000000000040000000000000000000010000000000000000ool0
0000003oof=]NF/0b000omP0000000/033DP0H6[d075K?0000000020000000@0
00180000000000400000ooooo`0000Cooooo0000B000000000000000000000/1
M;>X0H6[d075K?0000000020000000`0002D0000000000400018ooooo`000300
0001ooooo`0001P0000000000@0004P0000:08V;T042m^00X8^@0@kfh000P000
000]ooooo`0000P000000000H00007cooooo0000<000030000010001D?oooooo
oooo0001k03ETSoonJZM0<OWe?no@`/0gBOD01T32`3C0FX05;Oj0=<1JP0D]oX0
[DOD00C32`3Lim@068<;0<V3J@0OL>h0bH=Y01m`kP2ZQm@0:X<;000000000040
000<0000000000000000@0100400@00000000000000000000000000000000000
000000000000001>Kg9]HF`00000000000000000000000000000000000000000
0000003oo`0000000?ooHfeiJ`00000000000000000000000@00000000000000
0000000000000000000000000000008000000000000100800000000000000000
0800000000000000080000<00P0600<00000000000000000I000000000000000
000000000000001>Kg9]HF`00000000000000000000000000000000000000100
00=b0003PP0013P00`0000`0000000000G1a00000000008000000000A0000400
003`FV<00P0400000000000000000000000000000P0000000@0300000003ool0
000000Coo`00000000000207^=X8>7l0000000h02`030P003P00000000000000
0001@0000D0000000000000000000003BOfoooX000000000000000`02@030P00
30000000000000000400@010040000000000000000000003BOgoooh000000000
000100h02`030P003_ooo3`0000000000001@0000D0000000000000000000003
BOfoooX000000000000100`02@030P003?ooo3`0000000000400@010040000<0
0000000000000003BOgnooh000000000000@P0002X0000000000000000000000
0000000000001mdHH0000000009P1mdLT0OM2a000000000080OLjY000P0dA6EB
<`0000000@000000200000@000080000000000`000000001>00000000@0000/0
00000000000:007oo`0000000000000000000000000000000000000000000000
0000000000000000000000T000000000000000800>1300dL`000000090000000
00000000000100000@0001`0000<000000000000000000000@00004000000000
0001000000000000000000000000000000000000000000000P06000000000000
00000000000000000000P000000000000000P0000`0200H00`000gWOoooo0000
001T000000000000000000000003000030000000000002@00000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000005004000000EDJFeUL`>_1QX0
:0;h/3@3[`EP0_R`=0J`D[P000010jl5L0@h0I04=h/Z0000028010L00kOb0000
0@000040001<0000:0>_1QX3[`HH0jl5T2`00XE07Q^l06bG@0@gRX@00RM809bE
e02MHKH4>06@13N;:P00000R00@701@010000005E6U]IG<3[`HJ02P2n;0d0jl5
H0;h/3@6/5:h00000@>_1G04>06@13N;:P00000R00@700>glP00004000010000
C00002P3[`HJ0jl660>_1I0/00:5@1hK_01/Ud04=hZ4008WB02LUM@0WF6f13P1
T0@gRbX000008P041`0D00@000001EAYKFEc0jl66P0X0_R`=0>_1F02n;0d1[1B
^0000043[`E`13P1T0@gRbX000008P041`03]o80000100000@0004`0000X0jl6
6P>_1QP3[`F@;002QD0N6k`0K9M013N:Q0029dP0W9GD09eQ]P@h0I04=h/Z0000
028010L05004000000EDJFeUL`>_1QX0:0;h/3@3[`EP0_R`=0J`D[P000010jl5
L0@h0I04=h/Z0000028010L00kOb00000@000040001<0000:0>_1QX3[`HH0jl5
T2`00XE07Q^l06bG@0@gRX@00RM809bEe02MHKH4>06@13N;:P00000R00@70000
0@0000@00@041TMUKVEfHIl007aS1gA;om99H00002`3oom0PP0<>63oodP00F0k
6001>]Koogkc1gA8001d>7l003R0oom801C5H00002`30011P00<>63oodP00420
O`0X:0<003P3oon@7`0X@H80782O02AFh`Hn>0@00I0O02BJi000B0000@041TMU
KVEfHL07=2`0R<Q0PP0@>l0003^00058002L;028_T6209B@?`1H>7T004P0;:5P
0000Ef06?d6202@hN@00>80004_ondF0N@1<PH<0086<03A80l`eP44053Qi000h
P000Book9C_300180018P7l0D8630021S00DB0<00@041TMUKVEfH@15LT2200`k
`8RnB00023_0R=<hO`14B03=AF0000200@00P3l0F901000h000:?61VH[0M000h
Hf=Y>9l0?4P3`?V0@@0D?61VHSR0000hHf=YB0?15H1101@hN@00B00`kF00000X
0`00@880=3Qi001;ooQ5Ol000@041TMUKVEfHAT0]2P00011PP0<>628aTP006`h
H8RjB000I8PI0;@X0000@88033QPR;Y8001@Ol07=D6200`hOP00B000@5N01Sm1
PP0<>628b4P0030hH000B000:3P0002H6@2Z>7l0M4P0c7EP0000P040080o08R@
0@00>600000@0003LP000h8000@h00<0000<00000000005`L@00000000020000
000004@000100000l5QS00801000000000000000000000000000008000000040
0`0000000ooo00000004ool000000000000P1kSJ23Qo0000000>00/00`8000h0
00000000000000000D000050000000000000000000000dWm_ooj000000000000
000<00T00`8000`000000000000000100400@010000000000000000000000dWm
ooon0000000000000@0>00/00`8000kooo`l0000000000000D00005000000000
0000000000000dWm_ooj0000000000000@0<00T00`8000cooo`l000000000010
0400@010000300000000000000000dWmo_on000000000000480000Z000000000
00000000000000000000000000OM660000000002H0OM7907g@/@000000000207
g>Z@0080=4AUDS<000000040000000P00004000020000000000<000000000CP0
00000040000;0000000000002P01ool000000000000000000000000000000000
00000000000000000000000000000000000:0000000000000002003P@`0=h<00
000002@000000000000000000@000040000L0000300000000000000000000040
00010000000000000@0000000000000000000000000000000000000000000080
1P0000000000000000000000000000000800000000000000080000<00P0600<0
00=igoooo`000000I000000000000000000000000`0000`000000000000T0000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000001@010000005
E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6/5:h00000@>_1G04>06@13N;:P00000R
00@700>glP00004000010000C00002P3[`HJ0jl660>_1I0/00:5@1hK_01/Ud04
=hZ4008WB02LUM@0WF6f13P1T0@gRbX000008P041`0D00@000001EAYKFEc0jl6
6P0X0_R`=0>_1F02n;0d1[1B^0000043[`E`13P1T0@gRbX000008P041`03]o80
000100000@0004`0000X0jl66P>_1QP3[`F@;002QD0N6k`0K9M013N:Q0029dP0
W9GD09eQ]P@h0I04=h/Z0000028010L05004000000EDJFeUL`>_1QX0:0;h/3@3
[`EP0_R`=0J`D[P000010jl5L0@h0I04=h/Z0000028010L00kOb00000@000040
001<0000:0>_1QX3[`HH0jl5T2`00XE07Q^l06bG@0@gRX@00RM809bEe02MHKH4
>06@13N;:P00000R00@701@010000005E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6
/5:h00000@>_1G04>06@13N;:P00000R00@700>glP00004000010000C00002P3
[`HJ0jl660>_1I0/00:5@1hK_01/Ud04=hZ4008WB02LUM@0WF6f13P1T0@gRbX0
00008P041`0000400004004010I7IFiUMV4J0011P?n8OkgB58PL001l00Me@8;i
?3Qm00200@:H>242T7`80jJjHOo<CX0087`80ZJChOolTl7on9>QooBCPOo`T040
29@Qof0kP`00>j@003_5000kiP00>9`003Rm000hH@0h><000DP01=5P0000>9h0
03Ro004010I7IFiUMV43j410P00<>8<004P000PhW@00>00007`L8Jj00@2X>240
X7`80jJ3hOolPl7on8>QooB3POo`CX0087`80ZJ@0@08U27o`92Q062@`@1TT>40
J94106bA8@1`TD40M92105b0X@1L><40H3R0oom;oolmP040B3PQ004010I7IFiU
MV480ZJnXOoDT04029@Qoi0X1002>j<003_5000kiP00@H01:5B3n7hkP`01>7co
ocP4oomlOQWFO1h1eS]T001o?AXDOad252PL0050P@0@Ock8D3^Loom80010>7So
ocRIoolh_P01B00068S400680`01O<H7M9`4004010I7IFiUMV62onPkNooo:1/0
0D620;Qo7/1@>1coog`N0MHkG000O]d254P0091GFPPl>1[oog`N0MHjmP00O1[H
@7kM0QA0P00/O[Kb53Qf000hU@00>Il004P3:LV0@@0D;0<0042000`je@00>eX0
0CQg000hUP00>Il004P3000040000g8000>20004>0030000300000000001L740
000000000P00000000140000@0000?1IH`0200@0000000000000000000000000
00020000000100<0000000?oo`0000001?oo00000000000080NhfPPhO`000000
3P0;00<2000>000000000000000000500001@000000000000000000000=9oKoo
nP00000000000000300900<2000<0000000000000000@0100400@00000000000
0000000000=9oOoooP000000000000403P0;00<2000>oool?000000000000050
0001@000000000000000000000=9oKoonP00000000000040300900<2000<oool
?00000000000@0100400@0000`0000000000000000=9oOkooP00000000000120
000:P00000000000000000000000000000000007gAQP000000000V07gAb@1md;
40000000000P1mcZT00203A4IE8c00000001000000080000100000P000000000
30000000004h0000000100002`000000000000X00Ooo00000000000000000000
0000000000000000000000000000000000000000000000002`00000000000000
0P00h4<03Ac00000000T0000000000000000004000010000700000`000000000
00000000000100000@0000000000004000000000000000000000000000000000
00000000000200H0000000000000000000000000000000200000000000000020
000300801P030003NMooool0000006@00000000000000000000000<0000<0000
0000000090000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
000D00@000001EAYKFEc0jl66P0X0_R`=0>_1F02n;0d1[1B^0000043[`E`13P1
T0@gRbX000008P041`03]o80000100000@0004`0000X0jl66P>_1QP3[`F@;002
QD0N6k`0K9M013N:Q0029dP0W9GD09eQ]P@h0I04=h/Z0000028010L050040000
00EDJFeUL`>_1QX0:0;h/3@3[`EP0_R`=0J`D[P000010jl5L0@h0I04=h/Z0000
028010L00kOb00000@000040001<0000:0>_1QX3[`HH0jl5T2`00XE07Q^l06bG
@0@gRX@00RM809bEe02MHKH4>06@13N;:P00000R00@701@010000005E6U]IG<3
[`HJ02P2n;0d0jl5H0;h/3@6/5:h00000@>_1G04>06@13N;:P00000R00@700>g
lP00004000010000C00002P3[`HJ0jl660>_1I0/00:5@1hK_01/Ud04=hZ4008W
B02LUM@0WF6f13P1T0@gRbX000008P041`0D00@000001EAYKFEc0jl66P0X0_R`
=0>_1F02n;0d1[1B^0000043[`E`13P1T0@gRbX000008P041`03]o8000010000
0@0004`0000X0jl66P>_1QP3[`F@;002QD0N6k`0K9M013N:Q0029dP0W9GD09eQ
]P@h0I04=h/Z0000028010L000010000100100@6AfE^IGIQI008X0@0391U00R`
1@0<P640682101b0X@0PP<40983Q02R10@0/PB40<85103A;oo<mE606?d6200`h
H001B000@3QRK>Z80`00:000046202aoh?]i@H8093QQ08PhPQ:@B0>3SH1101AD
H0HnO000=5@3fGi8000100@6AfE^IGIQ8@1`O0P3YX?Qooa>P00PO0P2YY0100RD
8Ok0T641F9210Eb@X@5PT<41I93Q0FRA0@5/TB41L9510GB80@5fE006md62012P
0@60E0@7?4P000bP0@60E0@7?3QRK?:XH`00O607=D6201QlP0LdO00H042200`h
H00100@6AfE^IGIQ0001@88033QP00180038P841JXQT000hX`01O:07=2`00410
P@08>:00@3QQ0?AlY@LdB00inF00000hH@5H>840R3RP06a80gfAP440581Q0>`h
0?ooT640^;010:@h0@3dT040VSQQ08Q80gXUP44057aP1cE1PP0100@6AfE^IGIQ
000=O0T3YSRQ010hP@20Q6@0280400BDI@08T0D01480oo201008T0D0281Q01R0
P@0LP:40883102B0h@0XP@40;84Q0321@@0dBoon_H010DPh8@50O0P3YTj0021l
20:VT04029@Qo/2@H@5HT841G92Q0F2@`@0:00X0000000000000ool000000000
06=]NF/00@000040000000000000000/[P000000000000000000004000B<oooo
oooooooooooo00400000ME000000000000010000000000000?mVKXD000000040
0?ooR[00000000000001000000000000002ITG/00@000000000000000?ooh`07
0300001bIf8P<S8fLR0P83MW820P=3QR000200000P0000000000000002>o0000
00000000000000000@001>coooooooooo`000N`0^1?O0ITm0@3AYm@1dF<;0;QC
g`6Io@40NNOD0IWm0@2hDml1VOd10=/We05/H`/0000@0003LP000h8000@h00<0
000<00000000005`L@00000000020000000004@000100000l5Yg008010000000
000000000000000000000080000000400`0000000ooo00000004ool000000000
000P1kSJ23Qo0000000>00/00`8000h000000000000000000D00005000000000
0000000000000dWm_ooj000000000000000<00T00`8000`00000000000000010
0400@010000000000000000000000dWmooon0000000000000@0>00/00`8000ko
oo`l0000000000000D000050000000000000000000000dWm_ooj000000000000
0@0<00T00`8000cooo`l0000000000100400@010000300000000000000000dWm
o_on000000000000480000Z00000000000000000000000000000000000OM6600
00000002H0OM7907g@/@000000000207g>Z@0080=4AUDS<000000040000000P0
0004000020000000000<000000000CP000000040000;0000000000002P01ool0
0000000000000000000000000000000000000000000000000000000000000000
00080000000000000002003P@`0?bT00000002@000000000000000000@000040
000L000030000000000000000000004000010000000000000@00000000000000
000000000000000000000000000000801P000000000000000000000000000000
0800000000000000080000<00P0600<000=igoooo`000000I000000000000000
000000000`0000`000000000000T000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000001@010000005E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6
/5:h00000@>_1G04>06@13N;:P00000R00@700>glP00004000010000C00002P3
[`HJ0jl660>_1I0/00:5@1hK_01/Ud04=hZ4008WB02LUM@0WF6f13P1T0@gRbX0
00008P041`0D00@000001EAYKFEc0jl66P0X0_R`=0>_1F02n;0d1[1B^0000043
[`E`13P1T0@gRbX000008P041`03]o80000100000@0004`0000X0jl66P>_1QP3
[`F@;002QD0N6k`0K9M013N:Q0029dP0W9GD09eQ]P@h0I04=h/Z0000028010L0
5004000000EDJFeUL`>_1QX0:0;h/3@3[`EP0_R`=0J`D[P000010jl5L0@h0I04
=h/Z0000028010L00kOb00000@000040001<0000:0>_1QX3[`HH0jl5T2`00XE0
7Q^l06bG@0@gRX@00RM809bEe02MHKH4>06@13N;:P00000R00@701@010000005
E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6/5:h00000@>_1G04>06@13N;:P00000R
00@700>glP00004000010000C00002P3[`HJ0jl660>_1I0/00:5@1hK_01/Ud04
=hZ4008WB02LUM@0WF6f13P1T0@gRbX000008P041`0000400004004010I7IFiU
MV402^eP0000R1l025@0ggm0PP0<;1h0042200`hH?ooB00132`L0011PP0L;1`0
0D6201@/7002@H8033QPoom8003/P7l072P30011PP0HR1l025@0iom1PP0<Booi
DF0000287`04>80005>03gbH7`04R7l023PO004010I7IFiUMV4O01b@7`0T>l00
0I?O022@W`0X;1`0092O02a1PP0<:1d00D2001R0O`0T>00009P3000hH000B000
L2PK0010PP0/>7d004_on5eP0000O7/KND2200`hH?ooB000C8PO00QC`2KfV1l0
29=o01b0O`0L>000091o004010I7IFiUMV4O00@7lO6@0000000G=c07^=X80000
1cP00On@7`0/1o7aT0ObLJ00000001Lg40NhfPQ>P00PO0P2YY?Qoo`7lO6@T040
29@Qol0k``00X6@013P0002@100XR0@03C_T000X0000E6?GOT2200`/0`00@880
33QP004010I7IFiUMV6200a8018MH00008PO00QD0=mo@880G8Qo00ADHnmnE607
_D6204aDH0Mk@H80:3Qo000hP000>:000TP03neP0000;0<0046200`hH000B001
68PO00PhH001D60^=3Qo002H7`08Bool;F0000287`08E03OORP0000040000g80
00>20004>0030000300000000001L740000000000P00000000140000@0000?1H
M`0200@000000000000000000000000000020000000100<0000000?oo`000000
1?oo00000000000080NhfPP7hU6@00003P0;00<2000>00000000000000000050
0001@000000000000000000000=9oKoonP00000000000000300900<2000<0000
000000000000@0100400@000000000000000000000=9oOoooP00000000000040
3P0;00<2000>oool?0000000000000500001@000000000000000000000=9oKoo
nP00000000000040300900<2000<oool?00000000000@0100400@0000`000000
0000000000=9oOkooP00000000000120000:P000000000000000000000000000
00000007gAQP000000000V07gAb@1md;40000000000P1mcZT00203A4IE8c0000
0001000000080000100000P00000000030000000004h0000000100002`000000
000000X00Ooo0000000000000000000000000000000000000000000000000000
00000000000000002`000000000000000P00h4<048i00000000T000000000000
0000004000010000700000`00000000000000000000100000@00000000000040
0000000000000000000000000000000000000000000200H00000000000000000
00000000000000200000000000000020000300801P030003NMooool0000006@0
0000000000000000000000<0000<000000000000900000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000D00@000001EAYKFEc0jl66P0X0_R`
=0>_1F02n;0d1[1B^0000043[`E`13P1T0@gRbX000008P041`03]o8000010000
0@0004`0000X0jl66P>_1QP3[`F@;002QD0N6k`0K9M013N:Q0029dP0W9GD09eQ
]P@h0I04=h/Z0000028010L05004000000EDJFeUL`>_1QX0:0;h/3@3[`EP0_R`
=0J`D[P000010jl5L0@h0I04=h/Z0000028010L00kOb00000@000040001<0000
:0>_1QX3[`HH0jl5T2`00XE07Q^l06bG@0@gRX@00RM809bEe02MHKH4>06@13N;
:P00000R00@701@010000005E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6/5:h0000
0@>_1G04>06@13N;:P00000R00@700>glP00004000010000C00002P3[`HJ0jl6
60>_1I0/00:5@1hK_01/Ud04=hZ4008WB02LUM@0WF6f13P1T0@gRbX000008P04
1`0D00@000001EAYKFEc0jl66P0X0_R`=0>_1F02n;0d1[1B^0000043[`E`13P1
T0@gRbX000008P041`03]o80000100000@0004`0000X0jl66P>_1QP3[`F@;002
QD0N6k`0K9M013N:Q0029dP0W9GD09eQ]P@h0I04=h/Z0000028010L000010000
100100@6AfE^IGIQhd8DT0L103T800@haP0P@P3oO72U00M1PP0PO:T3YX06001l
hd8DT0L103T800@haP04@P3ok82400281001E03Ood6200b02@04T0<1P94S0HB0
J@08CX0087`80ZJ@0@08U27o`81S0HRX1002PH@017aS0Q@hP00100@6AfE^IGIQ
0@18>240@7`80jI>P00PO0P2YY0100RD8Oo0R0@00E@0com1PP0HZ0@00U@043Yl
X`8DP0D104P00120X`68Z0@00W`50:il00Me@H80881S0HRX1004PH@01WaS0Q@h
P?ooB0<;LH1101B00@18>240@7`80jI>P00100@6AfE^IGIQ8Oo0R0@00E@0com1
PP0HZ0@00U@043YlH`8DP0<104P00120H`68Z0@00W`302j1Q004O0<3N3R0oom8
0`/EP440580104Ph8@10O0P3YTj0021l20:VTn7oo9?1ooRCXOodTh7ol90100RD
8On`Xl@01:>T00HkQ00100@6AfE^IGIQO002On@J57oo0QA8000POoghD86L00Ph
O`00>83oodP32Zf0@@0D>mkoob`N0011POoPP040F3PQ051l20>VPn7oo8?1ooR3
XOodPh7ol4j0021l20:VT04029@Qol281001E03?od6201RX1002E00@>WaS0QB0
H`00010000<^0003?P000b`00`0000`0000000000G1a00000000008000000000
?0000400002dFGL00P0300000000000000000000000000000P0000000@000000
0003ool00000h4L7hU6@0000000002000@0<00T00`8000cooo`l000000000010
0400@010000300000000000000000dWmo_on000000000000000<00T00`8000`0
00000000000000100400@010000000000000000000000dWmooon000000000000
0@0>00/00`8000kooo`l0000000000000D000050000000000000000000000dWm
_ooj000000000000480000Z00000000000000000000000000000000000OM6600
00000002H0OM7907g@/@000000000207g>Z@0080=4AUDS<000000040000000P0
0004000020000000000<000000000CP000000040000;0000000000002P01ool0
0000000000000000000000000000000000000000000000000000000000000000
00090000000000000002003P@`0?bT00000002@000000000000000000@000040
000L000030000000000000000000004000010000000000000@00000000000000
000000000000000000000000000000801P000000000100000000000000000000
0800000000000000080000<00P0600<000=igoooo`000000I000000000000000
000000000P0000`000000000000T000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000001@010000005E6U]IG<3[`HJ02P2n;0d0jl5H0;h/3@6
/5:h00000@>_1G04>06@13N;:P00000R00@700>glP00004000010000C00002P3
[`HJ0jl660>_1I0/00:5@1hK_01/Ud04=hZ4008WB02LUM@0WF6f13P1T0@gRbX0
00008P041`0D00@000001EAYKFEc0jl66P0X0_R`=0>_1F02n;0d1[1B^0000043
[`E`13P1T0@gRbX000008P041`03]o80000100000@0004`0000X0jl66P>_1QP3
[`F@;002QD0N6k`0K9M013N:Q0029dP0W9GD09eQ]P@h0I04=h/Z0000028010L0
5004000000EDJFeUL`>_1QX0:0;h/3@3[`EP0_R`=0J`D[P000010jl5L0@h0I04
=h/Z0000028010L00kOb00000@000040001<0000:0>_1QX3[`HH0jl5T2`00XE0
7Q^l06bG@0@gRX@00RM809bEe02MHKH4>06@13N;:P00000R00@700000@0000<0
0@041TMUKVEfHB40@7`80jI>P00PO0P2YY0100RD8Oo0PH:=`4P2oFV0@@0DP040
B3PQ041l20>VCX0087b68gTh0000T0D0042200`hH001CX0088P4000/001@@880
E8`6004/0013@88023S600681P00;000ET2200PhaP01R0H00@041TMUKVEfH@<0
07`01g@/001@@H8032`002Y0PP0<>6000Dj0020ha000R0<007`01g@/000Z@H80
54200D0/000Q@H8024P00CB8h`00R0H007cW1gAl00MdO0L003QS004haP01@H80
33QP001>P00PR0H008SS001l00MdO>L00@041TMUKVEfHH80B2`7024hH`01@8;o
g3R00018000L78@02XP3000hQ?o@O007M7b08Q@hH`01R0<002`00250P_oPT8D0
03QP005>P00PR0<002`0024hH`01@8;om8P3000/000Q>6<00D22ooB80`00O007
MD2200`hH000CX00000;1kmZf6Somd0000008P08:000P00000040000<0000000
000800000?ooool0000;5mUI06Somd0000008P08:000P00000040000H0000000
000;00000?ooool0000>077GPP46LW00VIdR0DH0A`00P00000?o0000c0001K15
N7Ab000000000;Coooooooooooooooooooooooooooooooooooooooooooooool0
0001ooooo`000200000800000@001K00000>05Y1T`39=aH0WDfP0CQ_L`00P000
00?o0001/0001915N7Ab0005d0000;Cooooooooooooooooooooooooooooooooo
ooooooooooooool000010000]00002L0000?00000@002V000004ooooo`0004P0
0000000000002XL00003ooooo`000200000000000@002/l00006ooooo`000400
000000000@002^l00002ooooo`0001@0000000000@002bl000040001>00004P0
0000000000002d<000090=cWe00I0`/0eI8oooVZW@00P000000N000270000100
0000000;R`000B0000600001V0000CP00005ooooo`000P@0000000000@002i/0
00020001P00001@0000000000@003Il000090=FB?ooiZYd0anODokm32`00P000
000N0002F00001000000000=/`000B0000840001V0000CP000090=dWe00I0`/0
d`5Z01BgnP00P000000N0002U00001000000000=``000B0000600001V0000CP0
00090=<1JP0D]oX0[DOD00C32`00P000000N0002d00001000000000=d`000B00
00840001V0000CP000090=cWe00HP`/0bH=Y01m`kP00P000000N000330000100
0000000=h`000B0000600001V0000CP000090<V3J@0OL>h0ZXOD02Z32`00P000
000N0003T00001000000000=l`000B0000840001V0000CP00008ooooo`0006@0
0001E5QD80003P<000010001800001P0000000000@003VL000080003B0000:P0
0004E5QD80003Wl0000>07fWe05Xh`/0SZOD0GKS2`00P00000040003`0001kYD
F5@P000?9oooool0000>0:BWe04jh`/0]JOD0DSS2`00P00000040003l0001kYD
F5@P000FhOooool0000>09jWe042h`/0[jOD0A3S2`00P0000004000480001kYD
F5@P000NVoooool0000>00fUP@6J;3l0UQLL0R>=6@00P00000?o0005700000A7
LVA=000VE@0017@000=P0004Y0001;`0004h0001>?ooooooooooooooooooool0
00010003H00001P0000000000@009UT000030001D0000200000000000@009W40
00020002100001@0000000000@009Y4000040001V00004P00000000000009ZD0
00010004M00002P0000@00000@009^d000030004S0000200000000000@009aD0
00020004Y00001@0000000000@009cD000090;PCg`6I?@40dJOD0M5S2`00P000
00060005D00001000000000WB@001=@000D400002@2hDml1VOd107WWe06Io@40
080000001P001H@0000@000000009eT000CD0005100000T0^5?O0IWm0@3K9m@1
K6<;0020000000H000Fh00004000000002MY0004e0001@@0000>0=JWe05hh`/0
ijOD0HSS2`00P00000040005j0001kYDF5@P000WNOooool0000>0<nWe06kh`/0
h:OD0LcS2`00P0000004000660001kYDF5@P000_<oooool0000>07HWe065H`/0
QbOD0IES2`00P0000004ooooo`001VYDF5@P000fkOooool00:40I006A454=Gd1
01h06W9bLW9bLP0100X000000<P1FP1a04h0D01[06H0N01U06h0H`1/0600J`1L
06/0E`1/05<0K@1A0700D01c0500M@1B07L0EP1h05X0N01N07L0HP1e06D0L`1V
0700I@1^07407P1K0480IP1`05/0@P1U06h0IP1`05`0A@1K04806[Bd];Bd]01a
01h0AP1:0580M`1804`0DP1g0500M@1604X0B01<01YbLW9bLW80L@0N05/0A@1V
07<0G01506H0L01U07<0F`1805`0A@0J/K6a/K6a07407P1804`0EP1h04/0C@1F
07P0DP1g04P0C01;04d06W9bLW9bLP1a01h0F01806D0M@1K04P0I@1c0680M@1H
04X0F`1801ZUYJFUYJD0L@0N04/0C@1J07P0D01=05X0N01F07P0B`1=0500C@0J
T92@T92@07407P1@04`0GP1h05@0C01N07L0FP1h0500C@1D04`06WMgMgMgM`1a
01h0E01:0680M`1H04X0HP1e05h0M`1D04`0F01:01[lo?clo?`0L@1>04D0?`1L
04d0F`1205`0A@1K04P0F01:05@0C01@04d0B`1=04P0C01604X0A@1704H0A@19
0480C@100540?`1F03l0F@1105/0@P0JLW9bLW9b07408P1005/0K@1^05@0KP1]
06D0F01K0400I01D06h0E01^01[=cLg=cLd0L@0N03l0201]06h0F00806d0I@1D
06h0?`0@05P0200J[Zj^[Zj^07407P0[00P0E01^03l0401D06h0@01T02/0200o
01006]kNg]kNgP1a0280:`0005P0400o0100:`0804<0001H00P0?`0@03l0400J
001S01000280E@1H0@408P1F05/1000R05L0GP400280E`1Q0@408P1H06@1000R
05T0I`400280F@1Z0@408P1J06d1000R05/0L0400280G01c0@008P1L07H0000S
00008P1M07Pe301a02H0IP2[06/0/P1[0:/0J@2[06H0[01V0:`0JP2b06X0/P1[
0:/08P1E05P10@0R05P0F@410280F`1K00408P1M05`00@0R05l0G@hQ07409P1n
06L0Q@1]0800I`1n06X0OP1/07h0K02506d0Q@1]0800I`0R05D0FOl10280F01H
o`408P1K05Oo0@0R05h0E_l10280H@1Eo`408P1S05Co0@0R06H0Dol10280J@1B
maX0L@0V0840AP2804`0P@160840B@2204`0PP1<08P0A`2804L0P@160:40UP0:
0@0000000000002P09P06P000000000/00P050EDJFeUL`0301@0108000D02@0=
00h0;P04o`3o000@00500001@000:imH0EX0X02I0:00U`2Q09H02P4000000000
0000X02H00d0300@@0100400@000:`P30F<0X02I0:00U`2Q09H02P4000000000
0000X02H00d03P0@00500001@000:01o0741F02P09T0X02G0:40UP0:0@000000
0000002P09P03@0<01100400@010000[2@<1H`2P09T0X02G0:40UP0:0@000000
0000002P09P03@0>01000D000050000X07T0>@5I0:00V@2P09L0X@2F00X10000
000000000:00V00=00`04400@010040002/80`5S0:00V@2P09L06_ooooooo`1a
01h0003@0<L1F@000=00?`5I0<L1F@280=00003@01X00000000080000=00?`5I
02<0000Q0<L1F@0S00008@280=008`000240003@02<0000P00H0gP2?0=h0800=
0>/0U@3[02004`3i09/0n@0P01T11`2R0@L0800O0AD0Z04E02009P4R0:h18P0P
02`1<02e0C00800b0Ch0^`4n0200>@5<0<41C00P00h0d01=0ET0800K0=00FP5I
0200:@3@06P1F@0P03L0d01f0ET080140=00P`5I0200DP3@0941F@0P0600d02N
0ET0801]0=00[05I0200N`3@0;X1F@0Jh`07030007407P270<l0X04208T0c`27
0<l0WP420:010@290<l0L@0V09/0oP2R0@L0X@3n09h0o`2K0@40V`410:811`2R
0@L0X@3n07407P1@0<l0R03A08P0d@280<l0D03?0500d@280=40L@0V04X0c01C
0=<0DP3C05<0d01B0<`0DP3<04X0d01:0=00DP3C07407P270:L0Z03@08L0c`29
0=00Z02X0:H0Y`270<l0L@0V0:<0XP2[0:/0X`2W0:H0Z@2Y0:/0Z@2[0:/0XP2[
0:80X`2W0:40UP0:0@0000000000002P09P06P000000000=00h04001@0000D00
02]^=@5J0:00V@2P09L0X@2F00X10000000000000:00V00=00`04400@0100400
02/80`5g0:00V@2P09L0X@2F00X10000000000000:00V00=00h04001@0000D00
02P0ZP3b0EP0X02I0:00U`2Q09H02P40000000000000X02H00d0300@@0100400
@000:`T30GL0X02I0:00U`2Q09H02P40000000000000X02H00d03P0@00500001
@000:01A0;`1F@2P09T0X02G0:40UP0:0@0000000000002P09P03@0<01100400
@010000[20<1M`2P09T0X02G0?l\>"], "Graphics",
 ImageSize->{346, 200},
 ImageMargins->{{28, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptsPerRow", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsWorld", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"100.", "j"}], ",", 
         RowBox[{"150.", "i"}], ",", "10.0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.411683298714014*^9, 3.411683308632815*^9}, 
   3.411824386106741*^9, 3.411824436050096*^9, {3.412000854159452*^9, 
   3.412000854208871*^9}, 3.4134996786629543`*^9}],

Cell["1.2.2 Visualization of the points in \"World\" coordinates", \
"Subsubsection",
 CellChangeTimes->{{3.4117051341196117`*^9, 3.411705162730134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", 
  RowBox[{"PtsWorld", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1500"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "200"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.411824387976596*^9, 3.411824437772743*^9}],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], 
   Point3DBox[{{0, 0, 10.}, {100., 0, 10.}, {200., 0, 10.}, {300., 0, 10.}, {
     400., 0, 10.}, {500., 0, 10.}, {600., 0, 10.}, {700., 0, 10.}, {
     800., 0, 10.}, {900., 0, 10.}, {0, 150., 10.}, {100., 150., 10.}, {200., 
     150., 10.}, {300., 150., 10.}, {400., 150., 10.}, {500., 150., 10.}, {
     600., 150., 10.}, {700., 150., 10.}, {800., 150., 10.}, {900., 150., 
     10.}, {0, 300., 10.}, {100., 300., 10.}, {200., 300., 10.}, {300., 300., 
     10.}, {400., 300., 10.}, {500., 300., 10.}, {600., 300., 10.}, {700., 
     300., 10.}, {800., 300., 10.}, {900., 300., 10.}, {0, 450., 10.}, {100., 
     450., 10.}, {200., 450., 10.}, {300., 450., 10.}, {400., 450., 10.}, {
     500., 450., 10.}, {600., 450., 10.}, {700., 450., 10.}, {800., 450., 
     10.}, {900., 450., 10.}, {0, 600., 10.}, {100., 600., 10.}, {200., 600., 
     10.}, {300., 600., 10.}, {400., 600., 10.}, {500., 600., 10.}, {600., 
     600., 10.}, {700., 600., 10.}, {800., 600., 10.}, {900., 600., 10.}, {
     0, 750., 10.}, {100., 750., 10.}, {200., 750., 10.}, {300., 750., 10.}, {
     400., 750., 10.}, {500., 750., 10.}, {600., 750., 10.}, {700., 750., 
     10.}, {800., 750., 10.}, {900., 750., 10.}, {0, 900., 10.}, {100., 900., 
     10.}, {200., 900., 10.}, {300., 900., 10.}, {400., 900., 10.}, {500., 
     900., 10.}, {600., 900., 10.}, {700., 900., 10.}, {800., 900., 10.}, {
     900., 900., 10.}, {0, 1050., 10.}, {100., 1050., 10.}, {200., 1050., 
     10.}, {300., 1050., 10.}, {400., 1050., 10.}, {500., 1050., 10.}, {600., 
     1050., 10.}, {700., 1050., 10.}, {800., 1050., 10.}, {900., 1050., 
     10.}, {0, 1200., 10.}, {100., 1200., 10.}, {200., 1200., 10.}, {300., 
     1200., 10.}, {400., 1200., 10.}, {500., 1200., 10.}, {600., 1200., 
     10.}, {700., 1200., 10.}, {800., 1200., 10.}, {900., 1200., 10.}, {
     0, 1350., 10.}, {100., 1350., 10.}, {200., 1350., 10.}, {300., 1350., 
     10.}, {400., 1350., 10.}, {500., 1350., 10.}, {600., 1350., 10.}, {700., 
     1350., 10.}, {800., 1350., 10.}, {900., 1350., 10.}}]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  PlotRange->{{0, 1000}, {0, 1500}, {0, 200}},
  PlotRangePadding->{{Automatic, Automatic}, {Automatic, Automatic}, {
    Automatic, Automatic}}]], "Output",
 CellChangeTimes->{
  3.411623266314466*^9, 3.4116800490904007`*^9, {3.411683302845331*^9, 
   3.411683312639145*^9}, 3.411698959740686*^9, 3.41170399868434*^9, 
   3.4117051842290583`*^9, {3.411820813596052*^9, 3.411820818365275*^9}, 
   3.411823914210662*^9, 3.41182416419039*^9, 3.411824396167241*^9, 
   3.4118244420881863`*^9, 3.4119002586721573`*^9, 3.411996939369005*^9, 
   3.4120009527889557`*^9, 3.41242577187046*^9, 3.412947522442746*^9, 
   3.4131054441818647`*^9, 3.4131919278100157`*^9, 3.413418765225486*^9, 
   3.413499699921199*^9, 3.413519642154912*^9, 3.4136324573686028`*^9, 
   3.413811435714267*^9, 3.414693888086977*^9, 3.414701593239441*^9, 
   3.414701690779728*^9, 3.415163362227474*^9},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
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
Y2bh+Qf/kr3ok/FHU9zwI98Q9fo78fk+8w==\
\>"]]
}, Open  ]],

Cell["1.2.3 Visualization of the points in \"Camera\" coordinates", \
"Subsubsection",
 CellChangeTimes->{{3.4117051940170383`*^9, 3.4117052071759367`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PtsCam", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"w2c", ",", "PtsWorld"}], "]"}], "//.", "projRules"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.411623240225148*^9, 3.411623271811831*^9, {3.411823881185334*^9, 
   3.411823890540575*^9}, 3.4118243899912357`*^9, 3.411824446777274*^9, {
   3.413499645809677*^9, 3.413499647765152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "PtsCam", "]"}]], "Input"],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], Point3DBox[CompressedData["
1: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
7WtV1b6biv8Ba4qyNw==
    "]]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  PlotRange->{{-305.3701257427382, 775.5856900098726}, {-318.4188487788233, 
    1238.9825992744736`}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}}]], "Output",
 CellChangeTimes->{
  3.411623220103353*^9, {3.4116232668253098`*^9, 3.411623275729269*^9}, 
   3.411680049255165*^9, 3.411683317074683*^9, 3.411698960200369*^9, 
   3.411704005522648*^9, 3.411705213073287*^9, 3.411820826360051*^9, 
   3.411823919489876*^9, 3.41182416901464*^9, 3.411824449256153*^9, 
   3.4119002590061283`*^9, 3.41199693957932*^9, 3.412000952856821*^9, 
   3.412425772104526*^9, 3.412947522624918*^9, 3.4131054443100033`*^9, 
   3.413191928054915*^9, 3.413418765516876*^9, 3.41349965101451*^9, 
   3.413499684417059*^9, 3.413519645153853*^9, 3.413632457572672*^9, 
   3.413811435879059*^9, 3.4146938882035*^9, 3.414701593404941*^9, 
   3.4147016908837147`*^9, 3.415163362475659*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Modeling the Perfect Camera", "Section",
 CellChangeTimes->{{3.411705272940365*^9, 3.411705281395955*^9}, {
  3.411705405830948*^9, 3.4117054104560947`*^9}}],

Cell[CellGroupData[{

Cell["2.1 Perspective projection: pinhole model", "Subsection",
 CellChangeTimes->{3.411705286122744*^9}],

Cell["2.1.1 The classical pinhole model", "Subsubsection",
 CellChangeTimes->{3.411705288220481*^9}],

Cell[TextData[{
 "I use -",
 StyleBox["f",
  FontSlant->"Italic"],
 " in the projection equation because Z is negative and I want to keep a \
positive value for the focal length."
}], "Text",
 CellChangeTimes->{{3.4117038702683563`*^9, 3.411703940113062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Proj", "[", 
    RowBox[{"{", 
     RowBox[{"X_", ",", "Y_", ",", "Z_"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "f"}], " ", 
      RowBox[{"X", "/", "Z"}]}], ",", 
     RowBox[{
      RowBox[{"-", "f"}], " ", 
      RowBox[{"Y", "/", "Z"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4117038585071573`*^9, 3.4117038603515263`*^9}}],

Cell["2.1.2 Checking that it looks right", "Subsubsection",
 CellChangeTimes->{3.411705290171894*^9}],

Cell["\<\
We project points that form a square grid on a vertical plane looked at from \
a 45 degree angle\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"theOrigin", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1000."}], ",", " ", "1000.", ",", " ", "3000."}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ptsPerRow", "=", "10"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Pts3D", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"100.", 
           RowBox[{"j", "/", 
            SqrtBox["2"]}]}], ",", 
          RowBox[{
           RowBox[{"-", "100."}], "i"}], ",", 
          RowBox[{"100.", 
           RowBox[{"j", "/", 
            SqrtBox["2"]}]}]}], "}"}], "+", "theOrigin"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4120008542574463`*^9, 3.4120008542687187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pts2D", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Proj", ",", "Pts3D"}], "]"}], "/.", "projRules"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4134997254337273`*^9, 3.413499727735339*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Pts2D", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], PointBox[CompressedData["
1:eJxd02tIU3EYBvBzNqVISfqQhqIUCJaopBlIF8/6YEydRIpCdPGCVqAhGUFL
m4JaipYXCLSEBEGxtJQS96n/ISuXOu8VhDpNtznZ3MVtbs5t5eq8cN4/HM7X
H8/7PJmlBceKKIoS/P0K9/4i/2zfY///RcIbaSUl3zJYv5+tL8MSskT0o7WN
1SCK9cuVnpGPsIy3KF2TFOVmhfreilF/inHZc8WiH8msUDau2x+qYBx91cnd
jZOs8HDzrfmZF4yttthh6K9kBQP9leFDA4xF5k4inWOs4JKqJ8QayhjjGhKV
MedZ2rL+XjL7mdG1WedzmrpZur0pI+X2DviEp3wPfIJPQrNnWQY+QbYhjFnN
Ax+92VavuSwBH90wXGMY/AA+OpbeDsxJBh81e5ok5sjBR5UHBxdcHQQfFVW8
70tkCOcj3re0ucJ0Anz0Id8DH9V3X/z7WS/4KEmea1RIcT7iXQmKCzibwPmI
N/7ihe4WEecjnjpt4JOhEc5H3Npyz3NjFecjbkl7wJXHzZyP7A7/kj/cmAPf
7nG1uPTgdc5H3It7b4nzEXeskmmU9nA+slvbK+9IEYHPtWYQp85NgM+VHi69
S46Ab2d4LNpOAsC3E90oG4lvBp+zy1+3mf0RfM6jqvzipw/A5+hSvMqPaQWf
s933wOcUvDNkfXeDz1HWIn1dUwW+7fXxgrqSm+DbLrQOntObwGfX9KcWKTLB
Z7/T4THd6wSfzVmmqI7Ug89Wv3bg2skI8Nki3tiz0r6Cz8bfB7Hy90Gs/H2Q
Lf4+yBZ/H2SLvw9i4e+DWPj7IGb+PoiZvw9i5vePmPj9IybUPyPqnxH1bxP1
z4D6Z0D906P+6VH/dOi+OnTfdXRfLbqvFt1Xg+6rQfdVo/uq0X3V6L4rKL9l
lN8yyk+F8lOh/JZQfosov0WU3wLKbwHlN4N808g3jXxTyDeFfJPIp0Q+JfJN
IN/EP98fj+xTOg==
    "]]},
  Axes->True,
  PlotRange->{{-3, 3}, {-3, 3}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.411623287179607*^9, 3.411680049354179*^9, 3.411683323124467*^9, {
   3.411703986966516*^9, 3.4117040107725487`*^9}, {3.411705297118061*^9, 
   3.4117053055352287`*^9}, 3.41182084494873*^9, 3.411900259330171*^9, 
   3.411996939870825*^9, 3.412000953076499*^9, 3.41242577242511*^9, 
   3.412947522943439*^9, 3.413105444500989*^9, 3.413191928270873*^9, 
   3.4134187658317738`*^9, 3.413499733422593*^9, 3.413632457888206*^9, 
   3.4138114362825823`*^9, 3.41469388853821*^9, 3.4147015935755377`*^9, 
   3.414701691035614*^9, 3.415163362757193*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.2 Millimeters to pixels", "Subsection",
 CellChangeTimes->{3.4117053289503813`*^9}],

Cell["2.2.1 Define intyyrinsic parameters", "Subsubsection",
 CellChangeTimes->{{3.4118214142061043`*^9, 3.411821421980788*^9}, {
  3.412432786425988*^9, 3.412432787283909*^9}}],

Cell[TextData[{
 "The dimensions of all objects are given in millimeters but, in the end, \
image positions are given in pixels.  We follow Tsai & Wilson's convention \
and define\n\t\[Bullet] Ncx, the number of sensor elements in the camera's X \
direction (sels),\n\t\[Bullet] Nfx, the number of pixels in the frame \
grabber's X direction (pixels),\n\t\[Bullet] dx, X dimension of a camera \
sensor element (mm/sel),\n\t\[Bullet] dy, Y dimension of a camera sensor \
element (mm/sel),\n\t\[Bullet] dpx effective X dimension of pixel in frame \
grabber (mm/pixel),\n\t\[Bullet] dpy effective Y dimension of pixel in frame \
grabber (mm/pixel).\n\t\[Bullet] Cx, Cy, pixel coordinates of the true image \
center\n\t\[Bullet] sx, pixel h/v scaling ratio\n\nIt is easy to check that \
dpx = ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"dx", " ", "Ncx"}], "Nfx"]]],
 ". One can assume that the same ratio (camera vs. frame grabber) is kept for \
the Y dimension, so that dpy = ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"dy", " ", "Ncx"}], "Nfx"]]]
}], "Text",
 CellChangeTimes->{{3.4118213166648617`*^9, 3.4118213712787*^9}}],

Cell[CellGroupData[{

Cell["2.2.2 First, the \"integer pixels\"", "Subsubsection",
 CellChangeTimes->{3.4117053316913357`*^9, 3.4118214279412403`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mm2pixel", "[", 
    RowBox[{"{", 
     RowBox[{"px_", ",", "py_"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"px", "/", "dpx"}], "]"}], "+", "Cx"}], ",", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"py", "/", "dpy"}], "]"}], "+", "Cy"}]}], "}"}]}], 
  ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.2.3 Then, the \"float pixels\"", "Subsubsection",
 CellChangeTimes->{3.411705333338307*^9, 3.411821431368312*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mm2flPixel", "[", 
    RowBox[{"{", 
     RowBox[{"px_", ",", "py_"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"px", "/", "dpx"}], "+", "Cx"}], ",", 
     RowBox[{
      RowBox[{"py", "/", "dpy"}], "+", "Cy"}]}], "}"}]}], ";"}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.3 Finally, check if the point is within image boundaries", \
"Subsection",
 CellChangeTimes->{3.411705337331024*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"isItIn", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "<", "0"}], " ", "||", " ", 
      RowBox[{"x", "\[GreaterEqual]", "Nfx"}], "||", 
      RowBox[{"y", "<", "0"}], "||", 
      RowBox[{"y", "\[GreaterEqual]", "Nfy"}]}], ",", "0", ",", "1"}], 
    "]"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.4 Inverse transformations", "Subsection",
 CellChangeTimes->{{3.411707939733882*^9, 3.4117079560237722`*^9}}],

Cell["2.4.1 Equations of the inverse transformation", "Subsubsection",
 CellChangeTimes->{{3.411708089519511*^9, 3.411708101121442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pixel2mm", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "Cx"}], ")"}], "*", "dpx"}], "]"}], ",", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", "Cy"}], ")"}], "*", "dpy"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4117079597560377`*^9, 3.4117080521107197`*^9}, {
  3.411708168648407*^9, 3.4117081789575768`*^9}, {3.411708323364461*^9, 
  3.411708325585531*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"flPixel2mm", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "Cx"}], ")"}], "*", "dpx"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "-", "Cy"}], ")"}], "*", "dpy"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411708064948888*^9, 3.411708076600955*^9}, {
  3.4117081839888773`*^9, 3.4117081861315536`*^9}, {3.411708318185676*^9, 
  3.41170832070761*^9}}],

Cell["2.4.2 Verification", "Subsubsection",
 CellChangeTimes->{{3.411708083055749*^9, 3.411708113448696*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pixel2mm", "[", 
   RowBox[{"mm2pixel", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "200"}], "}"}], "]"}], "]"}], "//.", 
  "distortRules"}]], "Input",
 CellChangeTimes->{{3.4117081225255737`*^9, 3.411708153985009*^9}, {
   3.411708199483007*^9, 3.411708237500942*^9}, 3.411820898514832*^9, {
   3.411820954130579*^9, 3.411821061095786*^9}, {3.41182109617668*^9, 
   3.411821182132262*^9}, {3.411821215538957*^9, 3.411821252333909*^9}, 
   3.411821287660562*^9, 3.411821463474848*^9, 3.41351967915891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"100", ",", "200"}], "}"}]], "Output",
 CellChangeTimes->{
  3.411708154929199*^9, {3.4117081905007973`*^9, 3.411708238267272*^9}, 
   3.4117083342376547`*^9, 3.411820881776794*^9, 3.411821063028573*^9, {
   3.411821175360338*^9, 3.411821185873077*^9}, 3.4118212549374228`*^9, 
   3.411821288557178*^9, 3.411821465200302*^9, 3.4119002594952097`*^9, 
   3.411996940048316*^9, 3.412000953257442*^9, 3.412425772610298*^9, 
   3.412947523147048*^9, 3.41310544480399*^9, 3.413191928523885*^9, 
   3.413210316440596*^9, 3.4134187660856247`*^9, 3.413519680079896*^9, 
   3.413632458098081*^9, 3.413811436466138*^9, 3.4146938887283773`*^9, 
   3.414701614138145*^9, 3.414701691335169*^9, 3.415163362920775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"flPixel2mm", "[", 
   RowBox[{"mm2flPixel", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "200"}], "}"}], "]"}], "]"}], "//.", 
  "distortRules"}]], "Input",
 CellChangeTimes->{{3.4117081225255737`*^9, 3.411708153985009*^9}, {
   3.411708199483007*^9, 3.411708269420445*^9}, 3.41182129587918*^9, 
   3.4118214691234493`*^9, 3.413519682555345*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"100", ",", "200"}], "}"}]], "Output",
 CellChangeTimes->{3.41170827129523*^9, 3.4117083358546143`*^9, 
  3.4118208818637257`*^9, 3.411821297331766*^9, 3.411821470350439*^9, 
  3.4119002595448303`*^9, 3.411996940100251*^9, 3.412000953358294*^9, 
  3.4124257726767893`*^9, 3.4129475231984243`*^9, 3.41310544485592*^9, 
  3.413191928612156*^9, 3.4132103188759747`*^9, 3.413418766174205*^9, 
  3.413519683444449*^9, 3.4136324581797*^9, 3.413811436538117*^9, 
  3.414693888800157*^9, 3.414701614212707*^9, 3.414701691408752*^9, 
  3.4151633629886303`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Obviously this one does not invert properly because of rounding error\
\>", "Text",
 CellChangeTimes->{{3.413519710764207*^9, 3.413519741587573*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mm2pixel", "[", 
   RowBox[{"pixel2mm", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "200"}], "}"}], "]"}], "]"}], "//.", 
  "distortRules"}]], "Input",
 CellChangeTimes->{{3.4117083511767807`*^9, 3.411708355016437*^9}, {
   3.4118214743365793`*^9, 3.411821476317322*^9}, 3.41351968564615*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"29", ",", "240"}], "}"}]], "Output",
 CellChangeTimes->{3.411708356450706*^9, 3.411820881947461*^9, 
  3.411821477912387*^9, 3.411900259594459*^9, 3.411996940149515*^9, 
  3.41200095342354*^9, 3.412425772767378*^9, 3.412947523249132*^9, 
  3.4131054449058228`*^9, 3.41319192869767*^9, 3.41341876625786*^9, 
  3.4135196873595943`*^9, 3.413632458266273*^9, 3.4138114366045723`*^9, 
  3.4146938888656797`*^9, 3.41470161427942*^9, 3.414701691493001*^9, 
  3.415163363059926*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mm2flPixel", "[", 
   RowBox[{"flPixel2mm", "[", 
    RowBox[{"{", 
     RowBox[{"100", ",", "200"}], "}"}], "]"}], "]"}], "//.", 
  "distortRules"}]], "Input",
 CellChangeTimes->{{3.411708410389729*^9, 3.411708418672523*^9}, {
   3.4118214810795527`*^9, 3.411821482562644*^9}, 3.4135196933168373`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"100", ",", "200"}], "}"}]], "Output",
 CellChangeTimes->{3.41170841968123*^9, 3.411820882030299*^9, 
  3.411821483913774*^9, 3.411900259644157*^9, 3.41199694020021*^9, 
  3.412000953489843*^9, 3.4124257728810787`*^9, 3.412947523299335*^9, 
  3.413105444955926*^9, 3.41319192878087*^9, 3.413418766475334*^9, 
  3.413519694674515*^9, 3.413632458345696*^9, 3.413811436671205*^9, 
  3.414693888932317*^9, 3.414701614346199*^9, 3.414701691576647*^9, 
  3.415163363125906*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Modeling the Imperfect Camera", "Section",
 CellChangeTimes->{{3.411705220378179*^9, 3.411705227518703*^9}, {
  3.41170537053229*^9, 3.411705422030233*^9}}],

Cell[CellGroupData[{

Cell["3.1 Distortion and un-distortion", "Subsection",
 Evaluatable->False,
 CellChangeTimes->{{3.411705233495915*^9, 3.411705233942293*^9}, {
  3.41170542510224*^9, 3.411705426211751*^9}},
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell["\<\
First we define the un-distortion transformation given by Tsai\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnDistort", "[", "md_", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["\[Kappa]", "1"], " ", 
       RowBox[{"md", ".", "md"}]}]}], ")"}], " ", "md"}]}], ";"}]], "Input",
 AspectRatioFixed->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Next, we move on to distortion...\nWe have:  m",
 StyleBox["u",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 "  = (1 + ",
 StyleBox["\[Kappa]",
  FontFamily->"Symbol"],
 StyleBox["1",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 " m",
 StyleBox["2",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Superscript"}],
 StyleBox["u",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 ") m",
 StyleBox["d ",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 ", so if  we pose  m",
 StyleBox["d",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 " = ",
 StyleBox["\[Alpha]",
  FontFamily->"Symbol"],
 " m",
 StyleBox["u",
  FontSize->10,
  FontVariations->{"CompatibilityType"->"Subscript"}],
 " , we can solve for ",
 StyleBox["\[Alpha] ",
  FontFamily->"Symbol"],
 "..."
}], "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EquaCubique", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         SubscriptBox["\[Kappa]", "1"], " ", 
         SuperscriptBox["\[Alpha]", "2"], " ", 
         SuperscriptBox["ru", "2"]}]}], ")"}]}], "-", "1"}], ",", 
    "\[Alpha]"}], "]"}]}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", "\[Alpha]", "+", 
  RowBox[{
   SuperscriptBox["ru", "2"], " ", 
   SuperscriptBox["\[Alpha]", "3"], " ", 
   SubscriptBox["\[Kappa]", "1"]}]}]], "Output",
 CellChangeTimes->{3.411623201064789*^9, 3.41168004707154*^9, 
  3.411705433102013*^9, 3.4118215030583963`*^9, 3.411900259868713*^9, 
  3.411996940408688*^9, 3.4120009536276827`*^9, 3.4124257734331217`*^9, 
  3.412947523606556*^9, 3.413105445073889*^9, 3.413191929177127*^9, 
  3.4134187666858883`*^9, 3.413499907606324*^9, 3.413632458561689*^9, 
  3.413811436852304*^9, 3.414693889217327*^9, 3.4147016144274406`*^9, 
  3.41470169167203*^9, 3.415163363211203*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EquatoSolve", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    FractionBox["EquaCubique", 
     RowBox[{
      SubscriptBox["\[Kappa]", "1"], "  ", 
      SuperscriptBox["ru", "2"]}]], ",", "\[Alpha]"}], "]"}]}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Alpha]", "3"], "-", 
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["ru", "2"], " ", 
    SubscriptBox["\[Kappa]", "1"]}]], "+", 
  FractionBox["\[Alpha]", 
   RowBox[{
    SuperscriptBox["ru", "2"], " ", 
    SubscriptBox["\[Kappa]", "1"]}]]}]], "Output",
 CellChangeTimes->{3.411623201127718*^9, 3.411680047151733*^9, 
  3.411705433162457*^9, 3.411821503129854*^9, 3.411900259911539*^9, 
  3.4119969405171223`*^9, 3.412000953690441*^9, 3.412425773514688*^9, 
  3.412947523733039*^9, 3.413105445122953*^9, 3.41319192926432*^9, 
  3.413418766756411*^9, 3.413499908706882*^9, 3.41363245871469*^9, 
  3.4138114369202843`*^9, 3.414693889281661*^9, 3.414701614526379*^9, 
  3.4147016917623873`*^9, 3.415163363300084*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "When the discriminant is  > 0 , only one solution is real. It happens to be \
the third in the output of the Solve function. When  the discriminant is  < 0 \
, there are three real solutions. Since  we always have ",
 StyleBox["p",
  FontSlant->"Italic"],
 " > 0, however, the latter case is not something we should waste time on."
}], "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Alpha]Sol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Alpha]", "3"], "+", 
      RowBox[{"p", " ", "\[Alpha]"}], "-", "p"}], "==", "0"}], ",", 
    "\[Alpha]"}], "]"}]}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["2", "3"], ")"}], 
          RowBox[{"1", "/", "3"}]], " ", "p"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]]}], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"9", " ", "p"}], "+", 
          RowBox[{
           SqrtBox["3"], " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"27", " ", 
              SuperscriptBox["p", "2"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
        RowBox[{"1", "/", "3"}]], 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "/", "3"}]], " ", 
        SuperscriptBox["3", 
         RowBox[{"2", "/", "3"}]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox["3"]}]}], ")"}], " ", "p"}], 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"2", "/", "3"}]], " ", 
        SuperscriptBox["3", 
         RowBox[{"1", "/", "3"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox["3"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "3"}]], " ", 
        SuperscriptBox["3", 
         RowBox[{"2", "/", "3"}]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox["3"]}]}], ")"}], " ", "p"}], 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"2", "/", "3"}]], " ", 
        SuperscriptBox["3", 
         RowBox[{"1", "/", "3"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           SqrtBox["3"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "/", "3"}]], " ", 
        SuperscriptBox["3", 
         RowBox[{"2", "/", "3"}]]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.411623201257825*^9, 3.411680047210826*^9, 
  3.411705433231105*^9, 3.411821503275498*^9, 3.411900260036357*^9, 
  3.411996940673615*^9, 3.41200095375882*^9, 3.412425773649374*^9, 
  3.412947523925509*^9, 3.4131054452226753`*^9, 3.413191929365142*^9, 
  3.41341876695323*^9, 3.413499910185972*^9, 3.413632458963612*^9, 
  3.413811437225642*^9, 3.414693889458828*^9, 3.414701614598159*^9, 
  3.414701691844198*^9, 3.415163364104607*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["We can now define the distorsion function:", "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Distort", "[", "mu_", "]"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ru2", "=", 
        RowBox[{"mu", ".", "mu"}]}], ",", 
       RowBox[{"p", "=", 
        RowBox[{"Evaluate", "[", 
         FractionBox["1", 
          RowBox[{
           SubscriptBox["\[Kappa]", "1"], " ", "ru2"}]], "]"}]}], ",", 
       RowBox[{"BigTerm", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"9", " ", "p"}], "+", 
           RowBox[{
            SqrtBox["3"], " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"27", " ", 
               SuperscriptBox["p", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["p", "3"]}]}]]}]}], ")"}], 
         RowBox[{"1", "/", "3"}]]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["2", "3"], ")"}], 
            RowBox[{"1", "/", "3"}]], " ", "p"}], "BigTerm"]}], "+", 
        FractionBox["BigTerm", 
         SuperscriptBox["18", 
          RowBox[{"1", "/", "3"}]]]}], ")"}], " ", "mu"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411704178527543*^9, 3.4117041922872467`*^9}},
 AspectRatioFixed->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.2 Checking that it works fine", "Subsection",
 CellChangeTimes->{3.411705455991836*^9}],

Cell[CellGroupData[{

Cell["3.2.1 Distorsion and undistorsion invert each other", "Subsubsection",
 CellChangeTimes->{3.4117054580604153`*^9}],

Cell[CellGroupData[{

Cell["We check that the functions perform as expected.", "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Distort", "[", 
    RowBox[{"UnDistort", "[", 
     RowBox[{"{", 
      RowBox[{"20.", ",", "30."}], "}"}], "]"}], "]"}], "//.", 
   "distortRules"}], "]"}]], "Input",
 CellChangeTimes->{{3.413499823858305*^9, 3.413499825902173*^9}, 
   3.4135198145439663`*^9},
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"20.000000000000007`", ",", "30.000000000000014`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.411623201408123*^9, 3.4116800473194103`*^9, 
  3.411705444515998*^9, 3.411821503409568*^9, 3.4119002601339207`*^9, 
  3.411996940783622*^9, 3.412000953890991*^9, 3.412425773880351*^9, 
  3.41294752408146*^9, 3.413105445337742*^9, 3.4131919295136013`*^9, 
  3.413418767112176*^9, 3.413499827726337*^9, 3.413499913804927*^9, 
  3.4134999762248087`*^9, 3.4135198152219667`*^9, 3.41363245915088*^9, 
  3.41381143735502*^9, 3.414693889692815*^9, 3.414701614703706*^9, 
  3.414701691967331*^9, 3.4151633643533287`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"UnDistort", "[", 
    RowBox[{"Distort", "[", 
     RowBox[{"{", 
      RowBox[{"50.", ",", "40."}], "}"}], "]"}], "]"}], "//.", 
   "distortRules"}], "]"}]], "Input",
 CellChangeTimes->{3.413499835268216*^9, 3.4135198176939917`*^9},
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"50.00000000000004`", ",", "40.000000000000036`"}], "}"}]], "Output",\

 CellChangeTimes->{3.411623201478264*^9, 3.411680047398053*^9, 
  3.4117054467295094`*^9, 3.411821503503228*^9, 3.411900260209923*^9, 
  3.4119969408657207`*^9, 3.412000954140799*^9, 3.412425774208029*^9, 
  3.4129475241484747`*^9, 3.413105445419718*^9, 3.4131919296217327`*^9, 
  3.413418767217656*^9, 3.413499836443694*^9, 3.413499915055978*^9, 
  3.413499977230323*^9, 3.413519818309091*^9, 3.413632459238299*^9, 
  3.4138114374469213`*^9, 3.414693889790244*^9, 3.4147016148060923`*^9, 
  3.41470169206793*^9, 3.415163364514827*^9}]
}, Open  ]],

Cell["3.2.2 Distorsion looks good", "Subsubsection",
 CellChangeTimes->{3.4117054602359867`*^9}],

Cell["\<\
Nb.: The units used for the distorsion equation are milimeters.\
\>", "Text"],

Cell[CellGroupData[{

Cell["\<\
For our comparison of the method taking into account distortion vs. the one \
ignoring them, we will study the deformations of a rectangular set of points \
(in pixel units).\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cRect", "=", 
   RowBox[{"{", 
    RowBox[{".2", ",", ".2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"side", "=", "2."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"half", "=", 
   RowBox[{"side", "/", "2.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsPerRow", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ratio", "=", 
   RowBox[{"side", "/", "ptsPerRow"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.41200085427567*^9, 3.412000854280583*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PixelSquare", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "*", "ratio"}], "-", "half"}], ",", 
          RowBox[{"-", "half"}]}], "}"}], "+", "cRect"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "ptsPerRow"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"half", ",", 
          RowBox[{
           RowBox[{"i", "*", "ratio"}], "-", "half"}]}], "}"}], "+", 
        "cRect"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "ptsPerRow"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"half", "-", 
           RowBox[{"i", "*", "ratio"}]}], ",", "half"}], "}"}], "+", 
        "cRect"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "ptsPerRow"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "half"}], ",", 
          RowBox[{"half", "-", 
           RowBox[{"i", "*", "ratio"}]}]}], "}"}], "+", "cRect"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "ptsPerRow"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.412000854286222*^9, 3.412000854299842*^9}},
 AspectRatioFixed->True]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DistortNum", "[", "mu_", "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Distort", "[", "mu", "]"}], "/.", "distortRules"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.4134998518085203`*^9, {3.413499921217842*^9, 3.413499922290221*^9}, 
   3.413519825805985*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"notSoSquare", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"DistortNum", ",", "PixelSquare"}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["\<\
Note that, for the time being, the \"image\" is displayed upside down , \
'cause I dunno how  to  invert  the  orientation of the axes.\
\>", "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StraightRect", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"PixelSquare", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJyNlD0KwkAQhUNu4hWMdsLeQTyBoNh5FQsR4l/tFQQhdSDYWFkZEATBIsED
qNmdeZAHAw6E4SPL/LzZneF83JlEURT/vlHjs2fa2Br+MfUGvieN9cC3jzfw
1fsUfPHnE3Du/Qp89H6pPFhE3pRd+L8F5+36XIjfB4f8O3BJ8ah+R/056t+9
isbO4Iri1XT+3e7XZMkLlrrAoitYdAWLrmDRFSy6KquuyqorOG/Xp7qCRVdw
SfGofkf9OepfdQVXFK+m85bncxwn5CnMOrjO0EcXTHNwNAfRKTF1pDmcDu36
MpqDzHFvzjnk34DDHGLzHoX+Zn/fS+te870XXc13w+9KdAXT3lBd6V0n5rsX
XZVVV9or2Buqq7mXRFew6GruPdGV9+UXTWaHPg==
     "]]}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.4116232018279247`*^9, 3.4116800476727448`*^9, 
  3.411705473414506*^9, 3.411821539448267*^9, 3.4119002603394136`*^9, 
  3.411996941061473*^9, 3.412000954340273*^9, 3.412425775083665*^9, 
  3.412947524340373*^9, 3.413105445727953*^9, 3.413191929870689*^9, 
  3.413418767582624*^9, 3.4134998619287567`*^9, 3.413499928855893*^9, 
  3.413499985157987*^9, 3.413519835891974*^9, 3.41363245945128*^9, 
  3.413811437632905*^9, 3.414693889971182*^9, 3.4147016149529457`*^9, 
  3.414701692335155*^9, 3.4151633647173567`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrookyRect", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"notSoSquare", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJx1VFtIlGEQXbpsYnmFLOyCuy1pN7VSA1HGhwoqMdIFNTNM8iHBtJ4yS7MH
lczcJAwjiEh2UcEUE/dhlym8LYS3CtSHzbTN/TG1/oV6MLrofvONsOHDMvzM
zsw538w56cX5ugKNRrNu+WdciagkdGTnhQxy/HK2aOjFTwsq5weeT/1Ix5kL
pzoiS82olG2Zm0p14kebMjtf+BaVxxFWuz4ZJ9rNXY1lLah4Yyu+My1VN6Qm
ovImzX97QTM6ht/bKhe1qHijP1rHN9Z1Rf9CZSXGaJLqg+Ov6h/GoTLZl7XD
kgvefIyW8hvAQXVUD6J/kuwPEzRXzLeAwDdK+FLABz/48AMf/vA1JKw8K38Z
T1BsSZrpECw4J/udfrHodrUfc2nr4HvakafDhip099QX99z0gGqOaodZDbpr
EpJbazT/f9sN+raqbejq/HvbsbME1LGmjt6EXpz2xj5QP2dscqWUoXM0PiAy
TAeqZ/fdE4EROL5Qvl5rrwD19+jrW2dycUxE8GhPRvsFHUSHX25D95U68Gy+
bEyc34NWL9594AkIn9EZniU92Dp+Y9r9SuZB5A/LehD1JtkfRP+LNH8XiPl3
JD4Q+PQSPzB+wQ+Yn+APzP/+p+68wTiYyzgXHLJ/BNRr1VG1jRWwEFq7mLz0
AVRj5oHwgGz41n+69GWvAdT4e0rnbOGaUfxPR3WZq32or5gzxHN99rKKk3AL
Hv3EawB4D8Sb9yD2Qu+UQ++Ww+8o35X3IN7dZjZdetJSNCj3grwH2puof8R7
9elPd1DJdyHw7eW74T3QXQl+1/nu1rxL+U13zHdNdy7vXugghnRxlHXCuiEd
sa5IZ0J3zaxDocsR6RPAvkE6Zt8gnbPuyQeEb/yRPmGzpEaFNs27ZR7ZN6hO
1AeyD3F/8gsxv43wHSdfm2CfY9/w8jOSL7b6+uU/1+zK3w==
     "]]}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.41162320743896*^9, 3.411680047741506*^9, 
  3.411705479614711*^9, 3.411821539613608*^9, 3.4119002603951*^9, 
  3.411996941140642*^9, 3.4120009543742*^9, 3.412425775180635*^9, 
  3.41294752439721*^9, 3.4131054457938232`*^9, 3.4131919299630613`*^9, 
  3.413418767675024*^9, 3.413499864525799*^9, 3.4134999316543407`*^9, 
  3.413499987641439*^9, 3.413519838308659*^9, 3.413632459551445*^9, 
  3.413811437705308*^9, 3.4146938900492277`*^9, 3.41470161504674*^9, 
  3.414701692426427*^9, 3.415163364793988*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"StraightRect", ",", "CrookyRect"}], "]"}]], "Input",
 CellChangeTimes->{3.413500148535145*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJyNlD0KwkAQhUNu4hWMdsLeQTyBoNh5FQsR4l/tFQQhdSDYWFkZEATBIsED
qNmdeZAHAw6E4SPL/LzZneF83JlEURT/vlHjs2fa2Br+MfUGvieN9cC3jzfw
1fsUfPHnE3Du/Qp89H6pPFhE3pRd+L8F5+36XIjfB4f8O3BJ8ah+R/056t+9
isbO4Iri1XT+3e7XZMkLlrrAoitYdAWLrmDRFSy6KquuyqorOG/Xp7qCRVdw
SfGofkf9OepfdQVXFK+m85bncxwn5CnMOrjO0EcXTHNwNAfRKTF1pDmcDu36
MpqDzHFvzjnk34DDHGLzHoX+Zn/fS+te870XXc13w+9KdAXT3lBd6V0n5rsX
XZVVV9or2Buqq7mXRFew6GruPdGV9+UXTWaHPg==
      "]]}}, {{}, {}, 
    {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJx1VFtIlGEQXbpsYnmFLOyCuy1pN7VSA1HGhwoqMdIFNTNM8iHBtJ4yS7MH
lczcJAwjiEh2UcEUE/dhlym8LYS3CtSHzbTN/TG1/oV6MLrofvONsOHDMvzM
zsw538w56cX5ugKNRrNu+WdciagkdGTnhQxy/HK2aOjFTwsq5weeT/1Ix5kL
pzoiS82olG2Zm0p14kebMjtf+BaVxxFWuz4ZJ9rNXY1lLah4Yyu+My1VN6Qm
ovImzX97QTM6ht/bKhe1qHijP1rHN9Z1Rf9CZSXGaJLqg+Ov6h/GoTLZl7XD
kgvefIyW8hvAQXVUD6J/kuwPEzRXzLeAwDdK+FLABz/48AMf/vA1JKw8K38Z
T1BsSZrpECw4J/udfrHodrUfc2nr4HvakafDhip099QX99z0gGqOaodZDbpr
EpJbazT/f9sN+raqbejq/HvbsbME1LGmjt6EXpz2xj5QP2dscqWUoXM0PiAy
TAeqZ/fdE4EROL5Qvl5rrwD19+jrW2dycUxE8GhPRvsFHUSHX25D95U68Gy+
bEyc34NWL9594AkIn9EZniU92Dp+Y9r9SuZB5A/LehD1JtkfRP+LNH8XiPl3
JD4Q+PQSPzB+wQ+Yn+APzP/+p+68wTiYyzgXHLJ/BNRr1VG1jRWwEFq7mLz0
AVRj5oHwgGz41n+69GWvAdT4e0rnbOGaUfxPR3WZq32or5gzxHN99rKKk3AL
Hv3EawB4D8Sb9yD2Qu+UQ++Ww+8o35X3IN7dZjZdetJSNCj3grwH2puof8R7
9elPd1DJdyHw7eW74T3QXQl+1/nu1rxL+U13zHdNdy7vXugghnRxlHXCuiEd
sa5IZ0J3zaxDocsR6RPAvkE6Zt8gnbPuyQeEb/yRPmGzpEaFNs27ZR7ZN6hO
1AeyD3F/8gsxv43wHSdfm2CfY9/w8jOSL7b6+uU/1+zK3w==
      "]]}}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.411623210075151*^9, 3.411680047808496*^9, 
  3.411705479749683*^9, 3.411821539699333*^9, 3.411900260488781*^9, 
  3.411996941244685*^9, 3.412000954406715*^9, 3.41242577614399*^9, 
  3.412947524447171*^9, 3.413105445860504*^9, 3.4131919301269407`*^9, 
  3.413418767775785*^9, 3.413499880583374*^9, 3.4134999373531218`*^9, 
  3.413499990808354*^9, 3.413500149328535*^9, 3.413519841078918*^9, 
  3.413632459642619*^9, 3.413811437790966*^9, 3.414693890132259*^9, 
  3.41470161524577*^9, 3.4147016925090714`*^9, 3.415163364877481*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.3 Skewing and de-skewing", "Subsection",
 CellChangeTimes->{{3.4134989495858507`*^9, 3.413498966904169*^9}}],

Cell[CellGroupData[{

Cell["3.3.1 Define the transformations", "Subsubsection",
 CellChangeTimes->{{3.413499271551251*^9, 3.413499277994025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Skew", "[", "m_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "\[Sigma]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "m"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.413499029150185*^9, 3.413499060285655*^9}, {
  3.413499097452263*^9, 3.41349918084446*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Unskew", "[", "m_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "\[Sigma]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ".", "m"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.413499192219104*^9, 3.413499199954891*^9}, {
  3.413499253597393*^9, 3.4134992625163193`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.3.2 Verify with the square", "Subsubsection",
 CellChangeTimes->{{3.413499295095152*^9, 3.4134993160660067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SkewedSquare", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Skew", ",", "PixelSquare"}], "]"}], "/.", "distortRules"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.413500004586589*^9, 3.413500012711404*^9}, {
   3.413500064638751*^9, 3.413500110195096*^9}, 3.413519847638549*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SkewedRect", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"SkewedSquare", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413500039861372*^9, 3.41350006906634*^9}},
 AspectRatioFixed->True],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJx1lA1IVEEQx49DIiJCIsIkQkOsEJGyQ8RqEJOIkCgkIkRCKkTiioiQiCAq
zL60Mu3ytOzTJCQ0wkIcURENM/tAEb9Tu3t3ld57FyERtTtvd4LCheP4sftm
Z+b/n919JC/2oMPhcIpftvzH4Oq+6f3pF9HwyHUbfTNVDYlL9jBPNRecnhuK
Y54oTtnR+XiGefjpwvXxRiFzf2bN69azS5nftpzoep6azdwWevLTd/gCc+2N
4+IGUzPU3ZEfbGFul9tzw8x9MR2VDyc5P+gvSnAu3t7CPPz1Wv6xZ7HME/K6
S1uZp0aSosUVzP7IvKz3oTrmYMbNMwviRpm/yfT3RjLPfvxlvci8x2y6K67s
HEubnym/V/j5EC0wqb5UnEyWayOYTbuC51c14dhvWmBKOYpTcJC+94BpFMob
8QOdTwZLRst1YTdtl4MVTQHxJXEZWPa5TaUOWmBJtaoawN73gnVg30ohGXSr
/KxT1DCw47vAkuWPJIF9fxVY9ctOTmyrh3Edj8Ilgs7fGkuTEUHXZ/3oHVxe
lAC6/rDdX/jSI1cvhNd+byvJWQezKl44XRqqFkL6PKW3RtfxH5vCXO6Kq8yh
eNmgMPMM9aOROSjUF5Iy+6WaeVnM01TuCuZPIlthGeZRF8gOMQ9QeU7md6J5
MR1e5s6IKOHov+cbyA9JmtFL83KOuZXa42B+Q/bsYia71fQwD5F+LuZxsgvX
g1Py+gKuF32kf+P8rPQP6flXeit90Kf0tfXrQTUvWl/0K/2U/uiX7ah8pPyx
Af33BxZtPvoAlL/Rb8+P8pcHDdn+6LvKf8lo0PNSrf2Jhuqv8reeq+ZalZ8h
Xxv3LeV/Lxpy3DPK1XxUY0A8ZhFRZXp+MJArBb2u5qsSAyU5wpGlaPvbiQHb
X3o+MUDv1WU1v/n/vpd/AKj9tqc=
     "]]}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.413500048340928*^9, 3.413500052332528*^9}, {
   3.4135000852632217`*^9, 3.413500140631258*^9}, 3.413519849825551*^9, 
   3.413632459872188*^9, 3.413811437923443*^9, 3.414693890260048*^9, 
   3.414701615381372*^9, 3.414701692638266*^9, 3.415163365038772*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"StraightRect", ",", "SkewedRect"}], "]"}]], "Input",
 CellChangeTimes->{3.41350016330494*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJyNlD0KwkAQhUNu4hWMdsLeQTyBoNh5FQsR4l/tFQQhdSDYWFkZEATBIsED
qNmdeZAHAw6E4SPL/LzZneF83JlEURT/vlHjs2fa2Br+MfUGvieN9cC3jzfw
1fsUfPHnE3Du/Qp89H6pPFhE3pRd+L8F5+36XIjfB4f8O3BJ8ah+R/056t+9
isbO4Iri1XT+3e7XZMkLlrrAoitYdAWLrmDRFSy6KquuyqorOG/Xp7qCRVdw
SfGofkf9OepfdQVXFK+m85bncxwn5CnMOrjO0EcXTHNwNAfRKTF1pDmcDu36
MpqDzHFvzjnk34DDHGLzHoX+Zn/fS+te870XXc13w+9KdAXT3lBd6V0n5rsX
XZVVV9or2Buqq7mXRFew6GruPdGV9+UXTWaHPg==
      "]]}}, {{}, {}, 
    {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJx1lA1IVEEQx49DIiJCIsIkQkOsEJGyQ8RqEJOIkCgkIkRCKkTiioiQiCAq
zL60Mu3ytOzTJCQ0wkIcURENM/tAEb9Tu3t3ld57FyERtTtvd4LCheP4sftm
Z+b/n919JC/2oMPhcIpftvzH4Oq+6f3pF9HwyHUbfTNVDYlL9jBPNRecnhuK
Y54oTtnR+XiGefjpwvXxRiFzf2bN69azS5nftpzoep6azdwWevLTd/gCc+2N
4+IGUzPU3ZEfbGFul9tzw8x9MR2VDyc5P+gvSnAu3t7CPPz1Wv6xZ7HME/K6
S1uZp0aSosUVzP7IvKz3oTrmYMbNMwviRpm/yfT3RjLPfvxlvci8x2y6K67s
HEubnym/V/j5EC0wqb5UnEyWayOYTbuC51c14dhvWmBKOYpTcJC+94BpFMob
8QOdTwZLRst1YTdtl4MVTQHxJXEZWPa5TaUOWmBJtaoawN73gnVg30ohGXSr
/KxT1DCw47vAkuWPJIF9fxVY9ctOTmyrh3Edj8Ilgs7fGkuTEUHXZ/3oHVxe
lAC6/rDdX/jSI1cvhNd+byvJWQezKl44XRqqFkL6PKW3RtfxH5vCXO6Kq8yh
eNmgMPMM9aOROSjUF5Iy+6WaeVnM01TuCuZPIlthGeZRF8gOMQ9QeU7md6J5
MR1e5s6IKOHov+cbyA9JmtFL83KOuZXa42B+Q/bsYia71fQwD5F+LuZxsgvX
g1Py+gKuF32kf+P8rPQP6flXeit90Kf0tfXrQTUvWl/0K/2U/uiX7ah8pPyx
Af33BxZtPvoAlL/Rb8+P8pcHDdn+6LvKf8lo0PNSrf2Jhuqv8reeq+ZalZ8h
Xxv3LeV/Lxpy3DPK1XxUY0A8ZhFRZXp+MJArBb2u5qsSAyU5wpGlaPvbiQHb
X3o+MUDv1WU1v/n/vpd/AKj9tqc=
      "]]}}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.413500164664261*^9, 3.413519852507535*^9, 
  3.413632459966861*^9, 3.413811438089366*^9, 3.414693890348638*^9, 
  3.414701615463418*^9, 3.4147016927268047`*^9, 3.415163365110849*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StraightenedSquare", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Unskew", ",", "SkewedSquare"}], "]"}], "/.", "distortRules"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.413517013580154*^9, 3.413517027187443*^9}, 
   3.4135198571649437`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StraightenedRect", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"StraightenedSquare", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "1", ",", "0"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413500039861372*^9, 3.41350006906634*^9}, {
  3.413517061902741*^9, 3.413517085614614*^9}},
 AspectRatioFixed->True],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0, 1, 0], LineBox[CompressedData["
1:eJyNlD0KAkEMhRdv4hVc7YS5g3gCQbHzKoI/4G/tFQTBemGxsbJSEATBQvEA
6k6SB/sgYGAJHztkkpdMWoNOtZskSeX3tQu/v88Km8PfetHA17SwOvj8iQY+
RT8DH+P5FJxFPwVvox8ZN4dJNOMg/5fgrJxfkPgNsNy/Al8oHuUfqL5A9YdH
XtgB/KR4Lzr/Ltfrst4L1rzAqitYdQWrrmDVFSy6jY1NV2PTFZyV8zNdwaor
+ELxKP9A9QWq33QFPynei857ns9xHLknd/PgPKWOGpj6EKgPqlPq6ig6T4x3
m3J+e+qD9nHt9lnuX4ClDxV3jqS+/t9z6c01z73q6r4bfleqK5j2hulK7zp1
373Ot7HpSnsFe8N0dfeS6gpWXd29p7ryvvwCSoaHPg==
     "]]}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.413517068083112*^9, 3.413517087199164*^9}, 
   3.413519859985467*^9, 3.413632460072796*^9, 3.413811438188972*^9, 
   3.4146938904600687`*^9, 3.414701615559607*^9, 3.4147016928326607`*^9, 
   3.415163365208674*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"StraightRect", ",", "SkewedRect", ",", "StraightenedRect"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.41350016330494*^9, {3.413517093855747*^9, 3.413517094392756*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJyNlD0KwkAQhUNu4hWMdsLeQTyBoNh5FQsR4l/tFQQhdSDYWFkZEATBIsED
qNmdeZAHAw6E4SPL/LzZneF83JlEURT/vlHjs2fa2Br+MfUGvieN9cC3jzfw
1fsUfPHnE3Du/Qp89H6pPFhE3pRd+L8F5+36XIjfB4f8O3BJ8ah+R/056t+9
isbO4Iri1XT+3e7XZMkLlrrAoitYdAWLrmDRFSy6KquuyqorOG/Xp7qCRVdw
SfGofkf9OepfdQVXFK+m85bncxwn5CnMOrjO0EcXTHNwNAfRKTF1pDmcDu36
MpqDzHFvzjnk34DDHGLzHoX+Zn/fS+te870XXc13w+9KdAXT3lBd6V0n5rsX
XZVVV9or2Buqq7mXRFew6GruPdGV9+UXTWaHPg==
      "]]}}, {{}, {}, 
    {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJx1lA1IVEEQx49DIiJCIsIkQkOsEJGyQ8RqEJOIkCgkIkRCKkTiioiQiCAq
zL60Mu3ytOzTJCQ0wkIcURENM/tAEb9Tu3t3ld57FyERtTtvd4LCheP4sftm
Z+b/n919JC/2oMPhcIpftvzH4Oq+6f3pF9HwyHUbfTNVDYlL9jBPNRecnhuK
Y54oTtnR+XiGefjpwvXxRiFzf2bN69azS5nftpzoep6azdwWevLTd/gCc+2N
4+IGUzPU3ZEfbGFul9tzw8x9MR2VDyc5P+gvSnAu3t7CPPz1Wv6xZ7HME/K6
S1uZp0aSosUVzP7IvKz3oTrmYMbNMwviRpm/yfT3RjLPfvxlvci8x2y6K67s
HEubnym/V/j5EC0wqb5UnEyWayOYTbuC51c14dhvWmBKOYpTcJC+94BpFMob
8QOdTwZLRst1YTdtl4MVTQHxJXEZWPa5TaUOWmBJtaoawN73gnVg30ohGXSr
/KxT1DCw47vAkuWPJIF9fxVY9ctOTmyrh3Edj8Ilgs7fGkuTEUHXZ/3oHVxe
lAC6/rDdX/jSI1cvhNd+byvJWQezKl44XRqqFkL6PKW3RtfxH5vCXO6Kq8yh
eNmgMPMM9aOROSjUF5Iy+6WaeVnM01TuCuZPIlthGeZRF8gOMQ9QeU7md6J5
MR1e5s6IKOHov+cbyA9JmtFL83KOuZXa42B+Q/bsYia71fQwD5F+LuZxsgvX
g1Py+gKuF32kf+P8rPQP6flXeit90Kf0tfXrQTUvWl/0K/2U/uiX7ah8pPyx
Af33BxZtPvoAlL/Rb8+P8pcHDdn+6LvKf8lo0PNSrf2Jhuqv8reeq+ZalZ8h
Xxv3LeV/Lxpy3DPK1XxUY0A8ZhFRZXp+MJArBb2u5qsSAyU5wpGlaPvbiQHb
X3o+MUDv1WU1v/n/vpd/AKj9tqc=
      "]]}}, {{}, {}, 
    {RGBColor[0, 1, 0], LineBox[CompressedData["
1:eJyNlD0KAkEMhRdv4hVc7YS5g3gCQbHzKoI/4G/tFQTBemGxsbJSEATBQvEA
6k6SB/sgYGAJHztkkpdMWoNOtZskSeX3tQu/v88Km8PfetHA17SwOvj8iQY+
RT8DH+P5FJxFPwVvox8ZN4dJNOMg/5fgrJxfkPgNsNy/Al8oHuUfqL5A9YdH
XtgB/KR4Lzr/Ltfrst4L1rzAqitYdQWrrmDVFSy6jY1NV2PTFZyV8zNdwaor
+ELxKP9A9QWq33QFPynei857ns9xHLknd/PgPKWOGpj6EKgPqlPq6ig6T4x3
m3J+e+qD9nHt9lnuX4ClDxV3jqS+/t9z6c01z73q6r4bfleqK5j2hulK7zp1
373Ot7HpSnsFe8N0dfeS6gpWXd29p7ryvvwCSoaHPg==
      "]]}}},
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-2, 2}, {-2, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.413517095806291*^9, 3.413519863145509*^9, 
  3.4136324601855803`*^9, 3.413811438273878*^9, 3.414693890620529*^9, 
  3.414701615650766*^9, 3.414701692925809*^9, 3.415163365294738*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["3.4 The objects we will try to recompute", "Subsection",
 CellChangeTimes->{{3.41473783952873*^9, 3.4147378868848953`*^9}}],

Cell[CellGroupData[{

Cell["\<\
3.4.1 The \"state vector\" of the Tsai calibration calculations\
\>", "Subsubsection",
 CellChangeTimes->{{3.411699025121303*^9, 3.4116990404807663`*^9}, 
   3.411705546939373*^9, 3.4132078650518913`*^9, 3.413209452206778*^9, {
   3.413518081257807*^9, 3.413518084321563*^9}, {3.414737883446396*^9, 
   3.414737884772613*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullStateVec", "=", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "bigTransfMat", "]"}], ",", "12"}], "]"}], "//.",
    " ", "projRules"}]}]], "Input",
 CellChangeTimes->{{3.4116990438297253`*^9, 3.411699098921105*^9}, {
  3.4116994697508802`*^9, 3.411699471840521*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8001031451912656`", ",", "0.26730591487442346`", ",", 
   RowBox[{"-", "0.5370125742738174`"}], ",", 
   RowBox[{"-", "300.`"}], ",", 
   RowBox[{"-", "0.46193976625564337`"}], ",", "0.8456708580912725`", ",", 
   RowBox[{"-", "0.26730591487442346`"}], ",", "100.`", ",", 
   "0.3826834323650898`", ",", "0.46193976625564337`", ",", 
   "0.8001031451912656`", ",", 
   RowBox[{"-", "2000"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4116990919597187`*^9, 3.41169947301305*^9, 
  3.411704035578383*^9, 3.41170554963262*^9, 3.4117104750162067`*^9, 
  3.411710524014276*^9, 3.4118216076087227`*^9, 3.411900281194777*^9, 
  3.411997007241756*^9, 3.412000954803944*^9, 3.412425777699548*^9, 
  3.41294752479916*^9, 3.413105446202503*^9, 3.4131919306049547`*^9, 
  3.4131926539187183`*^9, 3.413418768540872*^9, 3.413422927035082*^9, 
  3.4135171216868*^9, 3.413519888689147*^9, 3.4136324607027807`*^9, 
  3.4138114387219954`*^9, 3.414693891030007*^9, 3.414701616128303*^9, 
  3.414701693491004*^9, 3.415163365377336*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullScaledStateVec", "=", 
  RowBox[{
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"1", "/", "f"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", 
       "bigTransfMat"}], "]"}], ",", "12"}], "]"}], "//.", " ", 
   "projRules"}]}]], "Input",
 CellChangeTimes->{{3.4116990438297253`*^9, 3.411699098921105*^9}, {
  3.4116994697508802`*^9, 3.411699471840521*^9}, {3.4134228954443207`*^9, 
  3.4134229218395987`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8001031451912656`", ",", "0.26730591487442346`", ",", 
   RowBox[{"-", "0.5370125742738174`"}], ",", 
   RowBox[{"-", "300.`"}], ",", 
   RowBox[{"-", "0.46193976625564337`"}], ",", "0.8456708580912725`", ",", 
   RowBox[{"-", "0.26730591487442346`"}], ",", "100.`", ",", 
   "0.04783542904563622`", ",", "0.05774247078195542`", ",", 
   "0.1000128931489082`", ",", 
   RowBox[{"-", "250.`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.413422924408271*^9, 3.413517121752646*^9, 
  3.41351988875601*^9, 3.413632460860227*^9, 3.41381143878741*^9, 
  3.41469389109706*^9, 3.4147016163082247`*^9, 3.414701693572279*^9, 
  3.4151633655224447`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullScaledNormalizedStateVec", "=", 
  RowBox[{"fullScaledStateVec", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"fullScaledStateVec", "[", 
      RowBox[{"[", "12", "]"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.413425545740995*^9, 3.413425590714799*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`", ",", 
   RowBox[{"-", "1.`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.413425591626278*^9, 3.4135171218181887`*^9, 
  3.4135198888213263`*^9, 3.4136324609421864`*^9, 3.413811438854273*^9, 
  3.414693891163829*^9, 3.414701616377503*^9, 3.414701693657894*^9, 
  3.415163365592396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partialScaledStateVec", "=", 
  RowBox[{"Take", "[", 
   RowBox[{"fullScaledNormalizedStateVec", ",", "11"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.411699434553651*^9, 3.4116994481411858`*^9}, {
  3.411699481088562*^9, 3.411699484145159*^9}, {3.411701483611663*^9, 
  3.4117015198587637`*^9}, {3.413421000581458*^9, 3.413421001376383*^9}, {
  3.413425065885626*^9, 3.4134250918934097`*^9}, {3.413425140450506*^9, 
  3.4134251520134172`*^9}, {3.413425583784685*^9, 3.413425587192499*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.411699485040361*^9, {3.4117014896939297`*^9, 3.411701521351746*^9}, 
   3.411704035652088*^9, 3.411704616063861*^9, 3.41170555819972*^9, 
   3.411710417232814*^9, 3.4117104750877743`*^9, 3.4117105249958887`*^9, 
   3.411821607680254*^9, 3.411900281257*^9, 3.411997007296926*^9, 
   3.4120009548738194`*^9, 3.41242577777782*^9, 3.412947524855386*^9, 
   3.4131054462594023`*^9, 3.4131919306779957`*^9, 3.413192653967967*^9, 
   3.413418768623159*^9, 3.413421003605646*^9, 3.413422280978599*^9, 
   3.4134251537249937`*^9, 3.413425593888668*^9, 3.4135171218682613`*^9, 
   3.413519888871633*^9, 3.413632461028599*^9, 3.413811438925349*^9, 
   3.414693891230691*^9, 3.414701616478321*^9, 3.41470169374179*^9, 
   3.415163365659596*^9}]
}, Open  ]],

Cell[TextData[{
 "Terms 1-3 and 5-7 of the partial scaled state vector are the first two rows \
of the rotation matrix scaled by (-f/Tz). The sum s of the squares of these \
terms should therefore be ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"f", "/", "Tz"}], ")"}], "2"], "."}]}], TraditionalForm]]],
 " From this we can get Tz/f =-",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{"2", "/", "s"}]], ".", " ", "If"}], " ", "we", " ", "multiply", 
    " ", "the", " "}], TraditionalForm]]],
 "partial scaled state vector by this number, we should get back the full \
scaled vector. We can then use the nominal focal length to multiply terms \
9-12 of the vector to get our computed full state vector."
}], "Text",
 CellChangeTimes->{{3.413431873230447*^9, 3.413432127239188*^9}, {
  3.413432162996059*^9, 3.4134322739289207`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"v", ",", "partialScaleToFullStateVect"}], "]"}]], "Input",
 CellChangeTimes->{{3.413432372622023*^9, 3.413432392139069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"partialScaleToFullStateVect", "[", "v_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       SqrtBox[
        RowBox[{"2", "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "2"]}], ")"}]}]]}], ",", 
      RowBox[{"newV", "=", 
       RowBox[{"s", "*", 
        RowBox[{"Append", "[", 
         RowBox[{"v", ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"newV", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "7", "]"}], "]"}], ",", 
       RowBox[{"newV", "[", 
        RowBox[{"[", "8", "]"}], "]"}], ",", 
       RowBox[{"f", "*", 
        RowBox[{"newV", "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ",", 
       RowBox[{"f", "*", 
        RowBox[{"newV", "[", 
         RowBox[{"[", "10", "]"}], "]"}]}], ",", 
       RowBox[{"f", "*", 
        RowBox[{"newV", "[", 
         RowBox[{"[", "11", "]"}], "]"}]}], ",", 
       RowBox[{"f", "*", 
        RowBox[{"newV", "[", 
         RowBox[{"[", "12", "]"}], "]"}]}]}], "}"}], "//.", "projRules"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.413431701442313*^9, 3.413431726994845*^9}, {
   3.4134317924469557`*^9, 3.413431864472843*^9}, {3.413432282272833*^9, 
   3.413432344118129*^9}, 3.413432396330689*^9, 3.413432461709962*^9, {
   3.413432546299554*^9, 3.413432613841071*^9}, {3.4134326614130907`*^9, 
   3.413432778006201*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"partialScaleToFullStateVect", "[", "partialScaledStateVec", "]"}],
    "-", "fullStateVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.413432408518265*^9, 3.413432467173202*^9}, {
  3.4134326238284473`*^9, 3.413432627104035*^9}, {3.4134327951993217`*^9, 
  3.413432807927084*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.413432411747964*^9, 3.413432443888341*^9}, 
   3.413432473929591*^9, 3.413432628262835*^9, {3.413432783598503*^9, 
   3.41343280879246*^9}, 3.4135171219477777`*^9, 3.413519888951681*^9, 
   3.413632461146956*^9, 3.413811439157082*^9, 3.414693891327239*^9, 
   3.414701616592617*^9, 3.414701693872879*^9, 3.415163365790208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.4.2 The projection matrix of the DLT algorithm", "Subsubsection",
 CellChangeTimes->{{3.41351809405639*^9, 3.413518129891344*^9}, {
  3.414737890655387*^9, 3.414737894660595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CalibMat", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "fpx"}], ",", "skw", ",", "Cx"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "fpy"}], ",", "Cy"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "/.", 
    "projRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "CalibMat", "]"}]}], "Input",
 CellChangeTimes->{{3.413518134945468*^9, 3.413518137909884*^9}, {
  3.413518266118877*^9, 3.413518407452692*^9}, {3.4135184708486643`*^9, 
  3.413518489094248*^9}, {3.413518574862669*^9, 3.4135185855834208`*^9}, {
  3.413518935598792*^9, 3.413518959590683*^9}, {3.4135189979733543`*^9, 
  3.41351900592216*^9}, {3.413519055554412*^9, 3.4135190589176607`*^9}, {
  3.4138122616655407`*^9, 3.413812282438168*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1163.6363635686612`"}], "0.`", "320"},
     {"0", 
      RowBox[{"-", "1163.6363636920773`"}], "240"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.413518355380488*^9, 3.413518408247451*^9}, 
   3.413518495830545*^9, {3.413518954654619*^9, 3.413518960502635*^9}, 
   3.413519006840316*^9, 3.413519059843624*^9, 3.413519889000987*^9, 
   3.413632461212492*^9, 3.413811439219532*^9, 3.4138122855987787`*^9, 
   3.413817654118206*^9, 3.414693891401682*^9, 3.4147016166607227`*^9, 
   3.414701693940617*^9, 3.415163365882552*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProjMat", "=", 
   RowBox[{
    RowBox[{"CalibMat", ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ".", 
     "bigTransfMat"}], "/.", "projRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "ProjMat", "]"}]}], "Input",
 CellChangeTimes->{{3.4135190093486834`*^9, 3.41351904781365*^9}, {
  3.4135190960782757`*^9, 3.413519132780943*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "808.5704159933841`"}], 
      RowBox[{"-", "163.2261575430623`"}], "880.9203655798354`", 
      RowBox[{"-", "290909.09092940163`"}]},
     {"629.3739336181067`", 
      RowBox[{"-", "873.1878182883328`"}], "503.07163762376183`", 
      RowBox[{"-", "596363.6363692078`"}]},
     {"0.3826834323650898`", "0.46193976625564337`", "0.8001031451912656`", 
      RowBox[{"-", "2000.`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.413519050345186*^9, 3.413519061886183*^9}, {
   3.413519114562976*^9, 3.413519133663005*^9}, 3.4135198890513887`*^9, 
   3.41363246144471*^9, 3.41381143928615*^9, 3.413812288833836*^9, 
   3.4138123715268307`*^9, 3.413817649534943*^9, 3.414693891481476*^9, 
   3.4147016167278843`*^9, 3.414701694006963*^9, 3.415163365956421*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ProjVect", "=", 
  RowBox[{"Flatten", "[", "ProjMat", "]"}]}]], "Input",
 CellChangeTimes->{{3.413519199728408*^9, 3.4135192110202847`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "808.5704159933841`"}], ",", 
   RowBox[{"-", "163.2261575430623`"}], ",", "880.9203655798354`", ",", 
   RowBox[{"-", "290909.09092940163`"}], ",", "629.3739336181067`", ",", 
   RowBox[{"-", "873.1878182883328`"}], ",", "503.07163762376183`", ",", 
   RowBox[{"-", "596363.6363692078`"}], ",", "0.3826834323650898`", ",", 
   "0.46193976625564337`", ",", "0.8001031451912656`", ",", 
   RowBox[{"-", "2000.`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.413519211819113*^9, 3.413519889100176*^9, 3.413632461509719*^9, 
   3.4138114393519793`*^9, 3.413812374525436*^9, {3.413817651784747*^9, 
   3.413817655933804*^9}, 3.414693891609908*^9, 3.414701616793236*^9, 
   3.414701694073352*^9, 3.4151633660255957`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.5 Decomposition of the projection matrix", "Subsection",
 CellChangeTimes->{{3.414697114864773*^9, 3.414697134044841*^9}, {
  3.414737898806587*^9, 3.414737929325252*^9}}],

Cell[CellGroupData[{

Cell["\<\
3.5.1 First, I work out the equation by starting with a generic 3x3 matrix M \
(upper-left 3-x3 subpart of P)\
\>", "Subsubsection",
 CellChangeTimes->{{3.414697137225564*^9, 3.41469716700093*^9}, {
   3.414697206401279*^9, 3.4146972272225924`*^9}, 3.41469812022609*^9, {
   3.414737934351694*^9, 3.414737935045085*^9}}],

Cell[TextData[{
 "M = K R, with K upper triangular and R orthogonal, so the decomposition is \
unique.  We right-multiply M in sequence by 3 rotation matrices ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "x"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "y"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "z"], TraditionalForm]]],
 " that set to 0 respectively the terms (3,2), (3,1) and (2,1) of the matrix. \
In the end we get ",
 Cell[BoxData[
  FormBox[
   RowBox[{"K", "=", 
    RowBox[{
     SubscriptBox["R", "x"], 
     SubscriptBox["R", "y"], 
     SubscriptBox["R", "y"]}]}], TraditionalForm]]],
 " and R =  ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["R", "z", "T"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["R", "y", "T"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["R", "z", "T"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.414697231352316*^9, 3.4146973760746117`*^9}, {
  3.4146975743382807`*^9, 3.4146976534166727`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m21", ",", "m22", ",", "m23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m31", ",", "m32", ",", "m33"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M", "]"}]}], "Input",
 CellChangeTimes->{{3.414695860972185*^9, 3.414695894939652*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m11", "m12", "m13"},
     {"m21", "m22", "m23"},
     {"m31", "m32", "m33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414695896449443*^9, 3.4151633660925007`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MRx", ",", "RxT"}], "}"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "=", 
        RowBox[{
         RowBox[{"-", "m33"}], "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]]}]}], ",", 
       RowBox[{"s1", "=", 
        RowBox[{"m32", "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]]}]}], ",", 
       RowBox[{"Rx", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "c1", ",", 
            RowBox[{"-", "s1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "s1", ",", "c1"}], "}"}]}], "}"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", ".", "Rx"}], ",", 
       RowBox[{"Transpose", "[", "Rx", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MRx", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "RxT", "]"}]}], "Input",
 CellChangeTimes->{{3.414695911892715*^9, 3.414696046764575*^9}, {
  3.4146960939787607`*^9, 3.414696101738721*^9}, {3.414696204414831*^9, 
  3.414696211414894*^9}, {3.414697687676241*^9, 3.414697804304385*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m11", 
      RowBox[{
       FractionBox[
        RowBox[{"m13", " ", "m32"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]], "-", 
       FractionBox[
        RowBox[{"m12", " ", "m33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m12", " ", "m32"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]]]}], "-", 
       FractionBox[
        RowBox[{"m13", " ", "m33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}]},
     {"m21", 
      RowBox[{
       FractionBox[
        RowBox[{"m23", " ", "m32"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]], "-", 
       FractionBox[
        RowBox[{"m22", " ", "m33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m22", " ", "m32"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]]]}], "-", 
       FractionBox[
        RowBox[{"m23", " ", "m33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}]},
     {"m31", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["m32", "2"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]]]}], "-", 
       FractionBox[
        SuperscriptBox["m33", "2"], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414697805596508*^9, 3.415163366160355*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["m33", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}], 
      FractionBox["m32", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m32", "2"], "+", 
         SuperscriptBox["m33", "2"]}]]]},
     {"0", 
      RowBox[{"-", 
       FractionBox["m32", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}], 
      RowBox[{"-", 
       FractionBox["m33", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414697805596508*^9, 3.415163366184507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m11", ",", "mp12", ",", "mp13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m21", ",", "mp22", ",", "mp23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m31", ",", "0", ",", "mp33"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M2", "]"}]}], "Input",
 CellChangeTimes->{{3.414696232425441*^9, 3.414696278048314*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m11", "mp12", "mp13"},
     {"m21", "mp22", "mp23"},
     {"m31", "0", "mp33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414696278608234*^9, 3.4146966252525578`*^9, 
  3.415163366258986*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MRxRy", ",", "RyTRxT"}], "}"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c2", ",", "s2"}], "}"}], ",", 
     RowBox[{"M2", ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c2", ",", "0", ",", "s2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "s2"}], ",", "0", ",", "c2"}], "}"}]}], "}"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MRxRy", "]"}]}], "Input",
 CellChangeTimes->{{3.414696077415913*^9, 3.414696141296164*^9}, {
  3.414696286583542*^9, 3.4146963065004063`*^9}, {3.4146978399308653`*^9, 
  3.4146978640067663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({MRxRy, RyTRxT}\\) and \\!\\({\\(\\({\\(\\(\\(\
\\(c2\\\\ m11\\)\\) - \\(\\(mp13\\\\ s2\\)\\)\\)\\), mp12, \\(\\(\\(\\(c2\\\\ \
mp13\\)\\) + \\(\\(m11\\\\ s2\\)\\)\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(c2\\\\ \
m21\\)\\) - \\(\\(mp23\\\\ s2\\)\\)\\)\\), mp22, \\(\\(\\(\\(c2\\\\ \
mp23\\)\\) + \\(\\(m21\\\\ s2\\)\\)\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(c2\\\\ \
m31\\)\\) - \\(\\(mp33\\\\ s2\\)\\)\\)\\), 0, \\(\\(\\(\\(c2\\\\ mp33\\)\\) + \
\\(\\(m31\\\\ s2\\)\\)\\)\\)}\\)\\)}\\) are not the same shape. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Set/shape\\\", \
ButtonNote -> \\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.415163366741309*^9}],

Cell[BoxData[
 TagBox["MRxRy",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.4146961427480917`*^9, {3.4146962906932297`*^9, 3.414696307527693*^9}, 
   3.41516336676128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MRxRy", ",", "RyTRxT"}], "}"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c2", "=", 
        RowBox[{"mp33", "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"m31", "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]}], ",", 
       RowBox[{"Ry", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c2", ",", "0", ",", "s2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "s2"}], ",", "0", ",", "c2"}], "}"}]}], "}"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M2", ".", "Ry"}], ",", 
       RowBox[{
        RowBox[{"Transpose", "[", "Ry", "]"}], ".", "RxT"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MRxRy", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "RyTRxT", "]"}]}], "Input",
 CellChangeTimes->{{3.414696424192423*^9, 3.4146964875892353`*^9}, {
  3.414696589281389*^9, 3.4146966053896027`*^9}, {3.414696650534935*^9, 
  3.414696676295516*^9}, {3.414697882332715*^9, 3.414697961443145*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m31", " ", "mp13"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]]}], "+", 
       FractionBox[
        RowBox[{"m11", " ", "mp33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]]}], "mp12", 
      RowBox[{
       FractionBox[
        RowBox[{"m11", " ", "m31"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]], "+", 
       FractionBox[
        RowBox[{"mp13", " ", "mp33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m31", " ", "mp23"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]]}], "+", 
       FractionBox[
        RowBox[{"m21", " ", "mp33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]]}], "mp22", 
      RowBox[{
       FractionBox[
        RowBox[{"m21", " ", "m31"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]], "+", 
       FractionBox[
        RowBox[{"mp23", " ", "mp33"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]]}]},
     {"0", "0", 
      RowBox[{
       FractionBox[
        SuperscriptBox["m31", "2"], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]], "+", 
       FractionBox[
        SuperscriptBox["mp33", "2"], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414696490208675*^9, {3.414696607778207*^9, 3.414696677321493*^9}, {
   3.414697945326724*^9, 3.4146979623565483`*^9}, 3.4151633668903027`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["mp33", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m31", "2"], "+", 
         SuperscriptBox["mp33", "2"]}]]], 
      FractionBox[
       RowBox[{"m31", " ", "m32"}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]}]], 
      FractionBox[
       RowBox[{"m31", " ", "m33"}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m31", "2"], "+", 
          SuperscriptBox["mp33", "2"]}]]}]]},
     {"0", 
      RowBox[{"-", 
       FractionBox["m33", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m32", "2"], "+", 
          SuperscriptBox["m33", "2"]}]]]}], 
      FractionBox["m32", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m32", "2"], "+", 
         SuperscriptBox["m33", "2"]}]]]},
     {
      FractionBox["m31", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m31", "2"], "+", 
         SuperscriptBox["mp33", "2"]}]]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m32", " ", "mp33"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m33", " ", "mp33"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414696490208675*^9, {3.414696607778207*^9, 3.414696677321493*^9}, {
   3.414697945326724*^9, 3.4146979623565483`*^9}, 3.415163366914075*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mq11", ",", "mp12", ",", "mq13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mq21", ",", "mp22", ",", "mq23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "mq33"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "M3", "]"}]}], "Input",
 CellChangeTimes->{{3.41469652721446*^9, 3.4146965518998117`*^9}, {
  3.414696695358021*^9, 3.41469671117255*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"mq11", "mp12", "mq13"},
     {"mq21", "mp22", "mq23"},
     {"0", "0", "mq33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4146967119092207`*^9, 3.4151633669882193`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MRxRyRz", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c3", ",", "s3"}], "}"}], ",", 
     RowBox[{"M3", ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c3", ",", 
          RowBox[{"-", "s3"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s3", ",", "c3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MRxRyRz", "]"}]}], "Input",
 CellChangeTimes->{{3.414696424192423*^9, 3.4146964875892353`*^9}, {
   3.414696718174035*^9, 3.414696772925074*^9}, 3.414696884418536*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"c3", " ", "mq11"}], "+", 
       RowBox[{"mp12", " ", "s3"}]}], 
      RowBox[{
       RowBox[{"c3", " ", "mp12"}], "-", 
       RowBox[{"mq11", " ", "s3"}]}], "mq13"},
     {
      RowBox[{
       RowBox[{"c3", " ", "mq21"}], "+", 
       RowBox[{"mp22", " ", "s3"}]}], 
      RowBox[{
       RowBox[{"c3", " ", "mp22"}], "-", 
       RowBox[{"mq21", " ", "s3"}]}], "mq23"},
     {"0", "0", "mq33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414696490208675*^9, 3.414696774776799*^9, 
  3.414696885632842*^9, 3.415163367058634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"MRxRyRz", ",", "R"}], "}"}], "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c3", "=", 
        RowBox[{
         RowBox[{"-", "mp22"}], "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mq21", "2"], "+", 
           SuperscriptBox["mp22", "2"]}]]}]}], ",", 
       RowBox[{"s3", "=", 
        RowBox[{"mq21", "/", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mq21", "2"], "+", 
           SuperscriptBox["mp22", "2"]}]]}]}], ",", 
       RowBox[{"Rz", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c3", ",", 
            RowBox[{"-", "s3"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s3", ",", "c3", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M3", ".", "Rz"}], ",", 
       RowBox[{
        RowBox[{"Transpose", "[", "Rz", "]"}], ".", "RyTRxT"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "MRxRyRz", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.414696798262834*^9, 3.41469683178465*^9}, {
  3.4146968682123528`*^9, 3.414696869184092*^9}, {3.414696900292391*^9, 
  3.414696909576001*^9}, {3.4146979811606083`*^9, 3.4146980463780117`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"mp22", " ", "mq11"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]]}], "+", 
       FractionBox[
        RowBox[{"mp12", " ", "mq21"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["mp22", "2"], "+", 
          SuperscriptBox["mq21", "2"]}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"mp12", " ", "mp22"}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]]}], "-", 
       FractionBox[
        RowBox[{"mq11", " ", "mq21"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["mp22", "2"], "+", 
          SuperscriptBox["mq21", "2"]}]]]}], "mq13"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["mp22", "2"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]]}], "-", 
       FractionBox[
        SuperscriptBox["mq21", "2"], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["mp22", "2"], "+", 
          SuperscriptBox["mq21", "2"]}]]]}], "mq23"},
     {"0", "0", "mq33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414696834352479*^9, 3.414696869943575*^9, 
  3.4146969116787243`*^9, 3.41469804794517*^9, 3.415163367126135*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"mp22", " ", "mp33"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m31", " ", "m32", " ", "mp22"}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["m32", "2"], "+", 
            SuperscriptBox["m33", "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["m31", "2"], "+", 
            SuperscriptBox["mp33", "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["mp22", "2"], "+", 
            SuperscriptBox["mq21", "2"]}]]}]]}], "-", 
       FractionBox[
        RowBox[{"m33", " ", "mq21"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m31", " ", "m33", " ", "mp22"}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["m32", "2"], "+", 
            SuperscriptBox["m33", "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["m31", "2"], "+", 
            SuperscriptBox["mp33", "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["mp22", "2"], "+", 
            SuperscriptBox["mq21", "2"]}]]}]]}], "+", 
       FractionBox[
        RowBox[{"m32", " ", "mq21"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"mp33", " ", "mq21"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"m33", " ", "mp22"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]], "-", 
       FractionBox[
        RowBox[{"m31", " ", "m32", " ", "mq21"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"m32", " ", "mp22"}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["m32", "2"], "+", 
            SuperscriptBox["m33", "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["mp22", "2"], "+", 
            SuperscriptBox["mq21", "2"]}]]}]]}], "-", 
       FractionBox[
        RowBox[{"m31", " ", "m33", " ", "mq21"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["mp22", "2"], "+", 
           SuperscriptBox["mq21", "2"]}]]}]]}]},
     {
      FractionBox["m31", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m31", "2"], "+", 
         SuperscriptBox["mp33", "2"]}]]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m32", " ", "mp33"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m33", " ", "mp33"}], 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["m32", "2"], "+", 
           SuperscriptBox["m33", "2"]}]], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["m31", "2"], "+", 
           SuperscriptBox["mp33", "2"]}]]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.414696834352479*^9, 3.414696869943575*^9, 
  3.4146969116787243`*^9, 3.41469804794517*^9, 3.415163367149913*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3.5.2 Now rewrite this as a procedure with the projection vector as input\
\>", "Subsubsection",
 CellChangeTimes->{{3.414698109855131*^9, 3.414698149414267*^9}, {
  3.414737939709882*^9, 3.414737940108881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DecomposeProjVect", "[", "PV_", "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PV", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PV", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "6", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PV", "[", 
             RowBox[{"[", "9", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "10", "]"}], "]"}], ",", 
            RowBox[{"PV", "[", 
             RowBox[{"[", "11", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", "c1", 
       ",", "s1", ",", "Rx", ",", "M2", ",", "RxT", ",", "c2", ",", "Ry", ",",
        "M3", ",", "RyTRxT", ",", "c3", ",", "s3", ",", "Rz"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c1", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"M", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rx", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "c1", ",", 
           RowBox[{"-", "s1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "s1", ",", "c1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M2", "=", 
       RowBox[{"M", ".", "Rx"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RxT", "=", 
       RowBox[{"Transpose", "[", "Rx", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"M2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"M2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ry", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c2", ",", "0", ",", "s2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "s2"}], ",", "0", ",", "c2"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M3", "=", 
       RowBox[{"M2", ".", "Ry"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"RyTRxT", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "Ry", "]"}], ".", "RxT"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c3", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"M3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s3", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"M3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"M3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"M3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"]}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rz", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c3", ",", 
           RowBox[{"-", "s3"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s3", ",", "c3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M3", ".", "Rz"}], ",", 
        RowBox[{
         RowBox[{"Transpose", "[", "Rz", "]"}], ".", "RyTRxT"}]}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4146981753017473`*^9, 3.414698225160228*^9}, {
   3.414698263634131*^9, 3.414698327867126*^9}, {3.414698364424959*^9, 
   3.414698369592218*^9}, {3.414698404153631*^9, 3.41469855398969*^9}, {
   3.41469861045016*^9, 3.4146986197421293`*^9}, {3.414698716275436*^9, 
   3.414698860849478*^9}, {3.41469918057312*^9, 3.414699249377965*^9}, {
   3.414699307286256*^9, 3.414699419986948*^9}, {3.414699732187911*^9, 
   3.414699875656225*^9}, {3.414700094360221*^9, 3.414700147173975*^9}, {
   3.4147005809459743`*^9, 3.414700642174342*^9}, {3.414700691563512*^9, 
   3.4147006954324827`*^9}, {3.4147019913558483`*^9, 3.414702021428508*^9}, {
   3.414702124279924*^9, 3.414702126762697*^9}, 3.4147348239345713`*^9, {
   3.414734885241403*^9, 3.414734888926529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"N", "[", 
     RowBox[{"DecomposeProjVect", "[", "ProjVect", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.414698567742736*^9, 3.41469858754074*^9}, {
  3.414699941621249*^9, 3.414699971577057*^9}, {3.4147000508033123`*^9, 
  3.414700053697838*^9}, {3.4147007174432983`*^9, 3.4147007805541143`*^9}, {
  3.414734908468608*^9, 3.414734909177477*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1163.6363635686614`"}], "0", "320.0000000000001`"},
     {"0", 
      RowBox[{"-", "1163.6363636920776`"}], "240.00000000000003`"},
     {"0", "0", "1.0000000000000002`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414698589363937*^9, 3.414698623846615*^9, 3.414698672723152*^9, 
   3.414698865202632*^9, 3.414699424888504*^9, 3.414699499199134*^9, 
   3.414699553482852*^9, 3.4146996617950773`*^9, 3.414699715873012*^9, 
   3.414699889366823*^9, 3.414699972320437*^9, 3.414700054355517*^9, 
   3.4147001191553507`*^9, 3.414700150229637*^9, {3.414700586914637*^9, 
   3.414700645147018*^9}, {3.4147006980147133`*^9, 3.414700722493042*^9}, 
   3.414700782382794*^9, 3.414701908302815*^9, 3.414702028161478*^9, 
   3.414702129729424*^9, 3.414734829198368*^9, {3.414734911404084*^9, 
   3.414734915342483*^9}, 3.415163367238254*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451912656`", "0.26730591487442357`", 
      RowBox[{"-", "0.5370125742738174`"}]},
     {
      RowBox[{"-", "0.46193976625564354`"}], "0.8456708580912725`", 
      RowBox[{"-", "0.26730591487442334`"}]},
     {"0.3826834323650898`", "0.4619397662556434`", "0.8001031451912657`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414698589363937*^9, 3.414698623846615*^9, 3.414698672723152*^9, 
   3.414698865202632*^9, 3.414699424888504*^9, 3.414699499199134*^9, 
   3.414699553482852*^9, 3.4146996617950773`*^9, 3.414699715873012*^9, 
   3.414699889366823*^9, 3.414699972320437*^9, 3.414700054355517*^9, 
   3.4147001191553507`*^9, 3.414700150229637*^9, {3.414700586914637*^9, 
   3.414700645147018*^9}, {3.4147006980147133`*^9, 3.414700722493042*^9}, 
   3.414700782382794*^9, 3.414701908302815*^9, 3.414702028161478*^9, 
   3.414702129729424*^9, 3.414734829198368*^9, {3.414734911404084*^9, 
   3.414734915342483*^9}, 3.415163367259821*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["4. Generation of image data points", "Section",
 CellChangeTimes->{3.411705516492331*^9}],

Cell[CellGroupData[{

Cell["4.1.3 Definition of plotting ranges", "Subsubsection",
 CellChangeTimes->{{3.413209463493021*^9, 3.413209477332624*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PixelPlotRange", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Nfx", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Nfy", "-", "1"}]}], "}"}]}], "}"}], "/.", 
   "projRules"}]}]], "Input",
 CellChangeTimes->{{3.413209492465873*^9, 3.413209518338018*^9}, {
  3.4132095675228662`*^9, 3.413209582619116*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "639"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "479"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.413209514322912*^9, 3.413209585417254*^9, 
  3.413209828088722*^9, 3.413418768000312*^9, 3.4135171212328253`*^9, 
  3.4135198883021507`*^9, 3.4136324602798653`*^9, 3.4138114383552723`*^9, 
  3.4146938906972446`*^9, 3.414701615747061*^9, 3.414701693007345*^9, 
  3.4151633673412733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MetricPlotRange", "=", 
  RowBox[{
   RowBox[{"1.1", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Ncx"}], "*", 
         RowBox[{"dx", "/", "2"}]}], ",", 
        RowBox[{"Ncx", "*", 
         RowBox[{"dx", "/", "2"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Ncy"}], "*", 
         RowBox[{"dy", "/", "2"}]}], ",", 
        RowBox[{"Ncy", "*", 
         RowBox[{"dy", "/", "2"}]}]}], "}"}]}], "}"}]}], "/.", 
   "projRules"}]}]], "Input",
 CellChangeTimes->{{3.413209521107999*^9, 3.413209548911139*^9}, {
  3.4132095951308413`*^9, 3.41320966068972*^9}, {3.4132103922856483`*^9, 
  3.413210393248159*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4200000001408`"}], ",", "2.4200000001408`"}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.8149999999131001`"}], ",", "1.8149999999131001`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.413209649951478*^9, 3.413209662170785*^9}, 
   3.413209829536628*^9, 3.413210399404045*^9, 3.413418768073344*^9, 
   3.413517121408352*^9, 3.413519888451706*^9, 3.413632460367895*^9, 
   3.413811438421398*^9, 3.414693890763816*^9, 3.414701615828258*^9, 
   3.414701693073145*^9, 3.415163367407283*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.1.4 The rotation and translation matrices", "Subsubsection",
 CellChangeTimes->{{3.411699018863141*^9, 3.4116990200270767`*^9}, {
   3.411699363334756*^9, 3.411699372626423*^9}, 3.411705531343248*^9, {
   3.4132094438039293`*^9, 3.413209445173174*^9}, {3.414737717975299*^9, 
   3.414737720494144*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"RotMat", "//.", "projRules"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.411696298322009*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451912656`", "0.26730591487442346`", 
      RowBox[{"-", "0.5370125742738174`"}]},
     {
      RowBox[{"-", "0.46193976625564337`"}], "0.8456708580912725`", 
      RowBox[{"-", "0.26730591487442346`"}]},
     {"0.3826834323650898`", "0.46193976625564337`", "0.8001031451912656`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.411623301565749*^9, 3.4116803380201187`*^9, 
  3.4116962999296722`*^9, 3.411704035181319*^9, 3.411705538773574*^9, 
  3.411710474789514*^9, 3.41171051787166*^9, 3.4118216072288237`*^9, 
  3.411900271589364*^9, 3.41199700706502*^9, 3.412000954559004*^9, 
  3.412425777197893*^9, 3.412947524583725*^9, 3.413105446026835*^9, 
  3.4131919303291073`*^9, 3.413192653668639*^9, 3.413418768157627*^9, 
  3.413517121489563*^9, 3.413519888506177*^9, 3.4136324604508333`*^9, 
  3.413811438505877*^9, 3.414693890831155*^9, 3.414701615895237*^9, 
  3.414701693140203*^9, 3.4151633674742613`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"N", "[", 
   RowBox[{"bigTransfMat", "//.", "projRules"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.4116993303936777`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451912656`", "0.26730591487442346`", 
      RowBox[{"-", "0.5370125742738174`"}], 
      RowBox[{"-", "300.`"}]},
     {
      RowBox[{"-", "0.46193976625564337`"}], "0.8456708580912725`", 
      RowBox[{"-", "0.26730591487442346`"}], "100.`"},
     {"0.3826834323650898`", "0.46193976625564337`", "0.8001031451912656`", 
      RowBox[{"-", "2000.`"}]},
     {"0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.41169933122528*^9, 3.411704035378467*^9, 
  3.411705538923788*^9, 3.411710474855051*^9, 3.411710519185192*^9, 
  3.411821607423189*^9, 3.4119002809504957`*^9, 3.411997007114616*^9, 
  3.412000954624587*^9, 3.412425777423929*^9, 3.4129475246298428`*^9, 
  3.41310544607644*^9, 3.413191930411645*^9, 3.413192653787075*^9, 
  3.413418768241414*^9, 3.413517121552894*^9, 3.413519888572351*^9, 
  3.413632460533539*^9, 3.413811438571765*^9, 3.4146938908975573`*^9, 
  3.41470161596242*^9, 3.4147016933215027`*^9, 3.415163367540989*^9}]
}, Open  ]],

Cell["\<\
4.1.5 Just to make sure that I have a rotation matrix, verify that it is \
indeed orthogonal\
\>", "Subsubsection",
 CellChangeTimes->{{3.4132078685609283`*^9, 3.413207899240201*^9}, 
   3.41320945018993*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"RotMat", ".", 
      RowBox[{"Transpose", "[", "RotMat", "]"}]}], "//.", "projRules"}], 
    "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.41169923922681*^9, 3.411699264353634*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000002`", "0", "0"},
     {"0", "1.`", "0"},
     {"0", "0", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4116992549656897`*^9, 3.411699265079973*^9}, 
   3.4117040354789963`*^9, 3.411704610583205*^9, 3.411705539003076*^9, 
   3.411710474922578*^9, 3.4117105211664667`*^9, 3.4118216075066442`*^9, 
   3.4119002811018753`*^9, 3.411997007166295*^9, 3.4120009547078953`*^9, 
   3.412425777510333*^9, 3.412947524736141*^9, 3.413105446126663*^9, 
   3.413191930495557*^9, 3.4131926538567944`*^9, 3.413418768323818*^9, 
   3.413517121620432*^9, 3.413519888634972*^9, 3.413632460616325*^9, 
   3.413811438655424*^9, 3.414693890964828*^9, 3.414701616045967*^9, 
   3.414701693391061*^9, 3.4151633676087008`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.2 Generation of the original grid (world coordinates)", "Subsection",
 CellChangeTimes->{3.411706170096661*^9}],

Cell["\<\
Our targets are made up of two 10x10 grids perpendicular to each other.  In \
all what follows, I will use the suffix \"Single\" to refer to one half of \
the calibration target (that is, made up of a single plane).\
\>", "Text",
 CellChangeTimes->{{3.4118216438999567`*^9, 3.41182172799962*^9}, {
  3.413207931405746*^9, 3.413208012370078*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptsPerRow", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsPerGrid", "=", 
   SuperscriptBox["ptsPerRow", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalNbPts", "=", 
    RowBox[{"2", "*", "ptsPerGrid"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsWorld", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"100.", "j"}], ",", 
           RowBox[{"150.", "i"}], ",", 
           RowBox[{
            RowBox[{"-", "100."}], "j"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"ptsPerRow", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"ptsPerRow", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "100."}], "j"}], ",", 
           RowBox[{"150.", "i"}], ",", 
           RowBox[{
            RowBox[{"-", "100."}], "j"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"ptsPerRow", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"ptsPerRow", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsWorldSingle", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"100.", "j"}], ",", 
         RowBox[{"150.", "i"}], ",", 
         RowBox[{
          RowBox[{"-", "100."}], "j"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"ptsPerRow", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4116965620023603`*^9, 3.411696584784212*^9}, {
   3.4116966412126217`*^9, 3.411696690062613*^9}, {3.412000854307872*^9, 
   3.412000922114649*^9}, {3.413205963307137*^9, 3.413206005786292*^9}, 
   3.413208022747986*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "PtsWorld", "]"}]], "Input",
 CellChangeTimes->{3.4132080527686768`*^9}],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], 
   Point3DBox[{{0, 0, 0}, {100., 0, -100.}, {200., 0, -200.}, {
     300., 0, -300.}, {400., 0, -400.}, {500., 0, -500.}, {600., 0, -600.}, {
     700., 0, -700.}, {800., 0, -800.}, {900., 0, -900.}, {0, 150., 0}, {100.,
      150., -100.}, {200., 150., -200.}, {300., 150., -300.}, {400., 
     150., -400.}, {500., 150., -500.}, {600., 150., -600.}, {700., 
     150., -700.}, {800., 150., -800.}, {900., 150., -900.}, {0, 300., 0}, {
     100., 300., -100.}, {200., 300., -200.}, {300., 300., -300.}, {400., 
     300., -400.}, {500., 300., -500.}, {600., 300., -600.}, {700., 
     300., -700.}, {800., 300., -800.}, {900., 300., -900.}, {0, 450., 0}, {
     100., 450., -100.}, {200., 450., -200.}, {300., 450., -300.}, {400., 
     450., -400.}, {500., 450., -500.}, {600., 450., -600.}, {700., 
     450., -700.}, {800., 450., -800.}, {900., 450., -900.}, {0, 600., 0}, {
     100., 600., -100.}, {200., 600., -200.}, {300., 600., -300.}, {400., 
     600., -400.}, {500., 600., -500.}, {600., 600., -600.}, {700., 
     600., -700.}, {800., 600., -800.}, {900., 600., -900.}, {0, 750., 0}, {
     100., 750., -100.}, {200., 750., -200.}, {300., 750., -300.}, {400., 
     750., -400.}, {500., 750., -500.}, {600., 750., -600.}, {700., 
     750., -700.}, {800., 750., -800.}, {900., 750., -900.}, {0, 900., 0}, {
     100., 900., -100.}, {200., 900., -200.}, {300., 900., -300.}, {400., 
     900., -400.}, {500., 900., -500.}, {600., 900., -600.}, {700., 
     900., -700.}, {800., 900., -800.}, {900., 900., -900.}, {0, 1050., 0}, {
     100., 1050., -100.}, {200., 1050., -200.}, {300., 1050., -300.}, {400., 
     1050., -400.}, {500., 1050., -500.}, {600., 1050., -600.}, {700., 
     1050., -700.}, {800., 1050., -800.}, {900., 1050., -900.}, {
     0, 1200., 0}, {100., 1200., -100.}, {200., 1200., -200.}, {300., 
     1200., -300.}, {400., 1200., -400.}, {500., 1200., -500.}, {600., 
     1200., -600.}, {700., 1200., -700.}, {800., 1200., -800.}, {900., 
     1200., -900.}, {0, 1350., 0}, {100., 1350., -100.}, {200., 
     1350., -200.}, {300., 1350., -300.}, {400., 1350., -400.}, {500., 
     1350., -500.}, {600., 1350., -600.}, {700., 1350., -700.}, {800., 
     1350., -800.}, {900., 1350., -900.}, {0, 0, 
     0}, {-100., 0, -100.}, {-200., 0, -200.}, {-300., 0, -300.}, {-400., 
      0, -400.}, {-500., 0, -500.}, {-600., 0, -600.}, {-700., 
      0, -700.}, {-800., 0, -800.}, {-900., 0, -900.}, {0, 150., 0}, {-100., 
     150., -100.}, {-200., 150., -200.}, {-300., 150., -300.}, {-400., 
     150., -400.}, {-500., 150., -500.}, {-600., 150., -600.}, {-700., 
     150., -700.}, {-800., 150., -800.}, {-900., 150., -900.}, {
     0, 300., 0}, {-100., 300., -100.}, {-200., 300., -200.}, {-300., 
     300., -300.}, {-400., 300., -400.}, {-500., 300., -500.}, {-600., 
     300., -600.}, {-700., 300., -700.}, {-800., 300., -800.}, {-900., 
     300., -900.}, {0, 450., 0}, {-100., 450., -100.}, {-200., 
     450., -200.}, {-300., 450., -300.}, {-400., 450., -400.}, {-500., 
     450., -500.}, {-600., 450., -600.}, {-700., 450., -700.}, {-800., 
     450., -800.}, {-900., 450., -900.}, {0, 600., 0}, {-100., 
     600., -100.}, {-200., 600., -200.}, {-300., 600., -300.}, {-400., 
     600., -400.}, {-500., 600., -500.}, {-600., 600., -600.}, {-700., 
     600., -700.}, {-800., 600., -800.}, {-900., 600., -900.}, {
     0, 750., 0}, {-100., 750., -100.}, {-200., 750., -200.}, {-300., 
     750., -300.}, {-400., 750., -400.}, {-500., 750., -500.}, {-600., 
     750., -600.}, {-700., 750., -700.}, {-800., 750., -800.}, {-900., 
     750., -900.}, {0, 900., 0}, {-100., 900., -100.}, {-200., 
     900., -200.}, {-300., 900., -300.}, {-400., 900., -400.}, {-500., 
     900., -500.}, {-600., 900., -600.}, {-700., 900., -700.}, {-800., 
     900., -800.}, {-900., 900., -900.}, {0, 1050., 0}, {-100., 
     1050., -100.}, {-200., 1050., -200.}, {-300., 1050., -300.}, {-400., 
     1050., -400.}, {-500., 1050., -500.}, {-600., 1050., -600.}, {-700., 
     1050., -700.}, {-800., 1050., -800.}, {-900., 1050., -900.}, {
     0, 1200., 0}, {-100., 1200., -100.}, {-200., 1200., -200.}, {-300., 
     1200., -300.}, {-400., 1200., -400.}, {-500., 1200., -500.}, {-600., 
     1200., -600.}, {-700., 1200., -700.}, {-800., 1200., -800.}, {-900., 
     1200., -900.}, {0, 1350., 0}, {-100., 1350., -100.}, {-200., 
     1350., -200.}, {-300., 1350., -300.}, {-400., 1350., -400.}, {-500., 
     1350., -500.}, {-600., 1350., -600.}, {-700., 1350., -700.}, {-800., 
     1350., -800.}, {-900., 1350., -900.}}]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  ImageSize->{360., 279.27199182533656`},
  PlotRange->{{-900., 900.}, {0, 1350.}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}},
  ViewPoint->{0.2730988908078461, -2.1416002016273628`, 2.605564348126748},
  ViewVertical->{-0.2181556698066419, 0.20034915414078736`, 
   2.3878184606538433`}]], "Output",
 CellChangeTimes->{3.413208058870214*^9, 3.413418768734445*^9, 
  3.413517122029718*^9, 3.413519889181891*^9, 3.413632461619725*^9, 
  3.413811439447064*^9, 3.414693891717595*^9, 3.414701710246499*^9, 
  3.415163367726359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "PtsWorldSingle", "]"}]], "Input",
 CellChangeTimes->{3.413208056403759*^9}],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], 
   Point3DBox[{{0, 0, 0}, {100., 0, -100.}, {200., 0, -200.}, {
     300., 0, -300.}, {400., 0, -400.}, {500., 0, -500.}, {600., 0, -600.}, {
     700., 0, -700.}, {800., 0, -800.}, {900., 0, -900.}, {0, 150., 0}, {100.,
      150., -100.}, {200., 150., -200.}, {300., 150., -300.}, {400., 
     150., -400.}, {500., 150., -500.}, {600., 150., -600.}, {700., 
     150., -700.}, {800., 150., -800.}, {900., 150., -900.}, {0, 300., 0}, {
     100., 300., -100.}, {200., 300., -200.}, {300., 300., -300.}, {400., 
     300., -400.}, {500., 300., -500.}, {600., 300., -600.}, {700., 
     300., -700.}, {800., 300., -800.}, {900., 300., -900.}, {0, 450., 0}, {
     100., 450., -100.}, {200., 450., -200.}, {300., 450., -300.}, {400., 
     450., -400.}, {500., 450., -500.}, {600., 450., -600.}, {700., 
     450., -700.}, {800., 450., -800.}, {900., 450., -900.}, {0, 600., 0}, {
     100., 600., -100.}, {200., 600., -200.}, {300., 600., -300.}, {400., 
     600., -400.}, {500., 600., -500.}, {600., 600., -600.}, {700., 
     600., -700.}, {800., 600., -800.}, {900., 600., -900.}, {0, 750., 0}, {
     100., 750., -100.}, {200., 750., -200.}, {300., 750., -300.}, {400., 
     750., -400.}, {500., 750., -500.}, {600., 750., -600.}, {700., 
     750., -700.}, {800., 750., -800.}, {900., 750., -900.}, {0, 900., 0}, {
     100., 900., -100.}, {200., 900., -200.}, {300., 900., -300.}, {400., 
     900., -400.}, {500., 900., -500.}, {600., 900., -600.}, {700., 
     900., -700.}, {800., 900., -800.}, {900., 900., -900.}, {0, 1050., 0}, {
     100., 1050., -100.}, {200., 1050., -200.}, {300., 1050., -300.}, {400., 
     1050., -400.}, {500., 1050., -500.}, {600., 1050., -600.}, {700., 
     1050., -700.}, {800., 1050., -800.}, {900., 1050., -900.}, {
     0, 1200., 0}, {100., 1200., -100.}, {200., 1200., -200.}, {300., 
     1200., -300.}, {400., 1200., -400.}, {500., 1200., -500.}, {600., 
     1200., -600.}, {700., 1200., -700.}, {800., 1200., -800.}, {900., 
     1200., -900.}, {0, 1350., 0}, {100., 1350., -100.}, {200., 
     1350., -200.}, {300., 1350., -300.}, {400., 1350., -400.}, {500., 
     1350., -500.}, {600., 1350., -600.}, {700., 1350., -700.}, {800., 
     1350., -800.}, {900., 1350., -900.}}]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  ImageSize->{360., 279.58400761115246`},
  PlotRange->{{0, 900.}, {0, 1350.}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}},
  ViewPoint->{1.3013595026141476`, -2.4943469624350563`, 1.8800789015216535`},
  
  ViewVertical->{0.03205730187969279, -0.032128826068135274`, 
   2.497423757509523}]], "Output",
 CellChangeTimes->{3.413208062297678*^9, 3.413418768835207*^9, 
  3.413517122095533*^9, 3.413519889248979*^9, 3.413632461711954*^9, 
  3.413811439529274*^9, 3.4146938918070583`*^9, 3.414701713159687*^9, 
  3.415163367817512*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3 Now we apply in sequence all our transforms", "Subsection",
 CellChangeTimes->{3.411706171739283*^9}],

Cell[CellGroupData[{

Cell["4.3.1 Change from world to camera coordinate system", "Subsubsection",
 CellChangeTimes->{3.411706173353015*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PtsCam", "=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"w2c", ",", "PtsWorld"}], "]"}], "//.", "\[IndentingNewLine]", 
      "projRules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsCamSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"w2c", ",", "PtsWorldSingle"}], "]"}], "//.", 
     "\[IndentingNewLine]", "projRules"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.411696731929618*^9, 3.41169673420511*^9}, 
   3.411821789137855*^9, {3.4132060287921057`*^9, 3.4132060393236*^9}, 
   3.413208086171069*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "PtsCam", "]"}]], "Input"],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], Point3DBox[CompressedData["
1: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
YfT/AXhDWMg=
    "]]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  ImageSize->{360., 268.8412023765361},
  PlotRange->{{-536.7815138257033, 1264.2671325990464`}, {-75.17046624309796, 
    1897.9767714402778`}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}},
  ViewPoint->{1.358287740809592, 2.239308046519062, 2.142557790576804},
  ViewVertical->{-0.0706049772300924, -0.018286757309796054`, 
   2.493341798291791}]], "Output",
 CellChangeTimes->{3.413206049963091*^9, 3.413208090381256*^9, 
  3.4134187690228662`*^9, 3.413517122256963*^9, 3.4135198894839287`*^9, 
  3.413632462019302*^9, 3.413811439710631*^9, 3.4146938919886847`*^9, 
  3.414701718081946*^9, 3.415163368082808*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "PtsCamSingle", "]"}]], "Input",
 CellChangeTimes->{{3.413206053286417*^9, 3.413206054479107*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], Point3DBox[CompressedData["
1:eJwtlHs4FHgXx2fTRXJpI9G6vcsqbZvLLqXrERJlMLsqGfdLCdEY49JgxmUw
gxmGMfcZuqBU9MZuLXWytcKmu9JrCYnXtaKyJb3tO/t7nvOc5zn//b7n8zmk
uNB/RRAIhAWfK/xzqSEFCX8/8Pt/I6ACVD28bfPtZNNe+Onr/UM9pStQ8eJd
q89QFYJ7VzTOvwRiflA5xdsDlbv+nleD326FtTXcBZdOnbBvk2NQKU448/7J
cYj112s3ZeSDwzfpAW1OZqicmCo60eEFSerj8z/W7YNFtKmaHg4DK5yiKXuv
mkNGuFd5ufIw2rS2JJBMvLGidNj3Td07yOrrNoi9tRV3mtrGTg2rY8VImKP8
RDvkabEjdNAF9zxlVjpcfYaVW/qM3QRyKNiypb7+FyKS2kfGtncEYyXXn/Ay
n4Lx25O2Twffghj/TX4NHiMoX9el5c7Sw6ACkqC55SlEjYfvPVH6CuX3bj+U
RDeBiS59yLRLCYfSeDuKe9+jIvmmZMInDEKqQgzrershQrvJjmGlhkqd3nqF
JAeOWetaGgXRIVQx8s3RBE1Uhh0s213kBynsxGvBXlwIttUzIDfro7KxK/kV
8ztgvB5fTzK9C/7ZDH2B9las0CCRxdQvIMdMljyz6gnsO/14jlJJxIqATnCO
fAT5ROJNgc4z8GmzHvByCMaKeg/zcb9qKKQTVmxaMgruj3V4+0s/57Dw9yVl
e+kYndLz4XaWCdC+Uv1XtrJ2NV9zDfqyrEs4rrNAHez8cX3cOMqaTvQ/f3UH
3DobTqnPCCGh9p8cwiQ1Do9pEHmGImk3dgcK9f2u1ZffokKDH5/XbAIJdZLh
tfONcGzbP/nUczY+rbwJ9GXzjJjJVohfbOm4VO0TKtc7ZQhcHCDz+7qCJ3Ex
ECtLjiCQFqMyozlsx0YNYIWEdKceokL0hpP7J6U6qHzguGvEqhfYXFWeh6/d
9eh5YYAVlg3rio0uQlHTDcrV/bkQ6T23rcPGDCtSbbU367AwktaRcsnlHKSr
P2RxXwaglJC5pqdkC7oRDI3qS9YD/d4RxpKVoSitSpnakDQIvhNpXY3vbOC4
mJCSvjkSZcRjjYwANkSfyzYe9P8VUkMFlDdBR1D2JirtvrMd0Owsqu1lk5Dy
7fqYmOw4lEtDXC3WdkN6Ya5TSuEnSJpuiRisoaLC2U+Tps2ELCp1IvCaOtCa
DgQd7ExGxaj3g9YZK8ittNxM+HkFJGZPHrg3TUfl7pOeBeMjwLnzmFV5YTVQ
PbNJ7gZMVErNbO37moD7Me+BS5U5JOiv3oPbclA5JdXrvc/DkITL7ySLt0Lm
B9V+xWMH7C0NiLhKLqwM/w0gMyhrX/yfR1BS4jWX9PEtBE0rn/6XuhyYv6n2
LnV0+61tUAbxBzzuzHvqA3OtodfIgjiUPtvB+arNFZL/fS5q5zZLYBSoeJDl
biTFnh8HRm7eF876UsjoDyy5ShxG+QZrw2ulpZDd4Og5pH0S0mtmCuwTxlD+
yLL/y9StkDcwKs5dfB7SKOycWuFLVNBNqsOCBqFwuYof+hazDPPmGVR+qeKH
p7AUDR0PhuNqjcnigVlURiz5KqtMhAf6vcfUuAJgvV4c/7WsEkVdG3bGyUPB
yYAyYxASDKx9PjG9NhYoTrNcej1bA8Ln+qcKZ5Mh54o0StRyGiUWxvd0o+qB
0v2gWGOcCDkmw5G+vlYo6VgpjPDyg+P2DuuIPYGQnWUXtnz4LEopWkE/2xOA
eWtvSFvkJsgaTgv6I3UDygwXrVm6uhpy3nw8Hx24E7L23CLnadah7NrcpD/B
G9jm5z9o7fOAzDpdP2eFHcojZxpqh95BkU+w2wUiCTL1An0/2V5ChdY4fb5D
AcU78trXntgAzOQa0pUbDqi49NzFu34Xejb636785jCwR1Q8C68v9LpskQik
EnL69nM8YHuaZu3J7EPRoblVyzSMIerT9LEqh1HIr1dxLtae7iVP3YBEfzJp
FYcF+Ssb6C1Vz1HcMHbq/KMYSGu8OuZ/XAh5qSr+JeTBWMKvupC1dHmLV8ND
yO3dQ3P8YwSlav/5gaT8FXIdWrRfneuF3J0qL6Rn7n84yQoDTniCP//UC2Cd
7o+rezWBMp/2lrcxGsAtUfnCWqbyRTbbwt7tcxGK+0bfR7fPQU5cUtRa/c93
RnHFR7zxIH7/07fs1P0ARX2V0o/Oq7D87NOABWfygSzMyDy2jgpFzhOiXx6J
UEi6b/ETzxbi1BZOYyIZCqs3CaiHjVD4V9vY6cQnkNQzpGuxDqFQM4tv/V6O
IuX1i7P+DGAYmXf9oHUYCuI7uWOFZih2u5zq4bQGst0ffd21KB44jwwLqkwr
UTxZ7yS1vAN5Say4pI+pwHEMzw+9aIGSshr1Sc0kKDi1scnwTSawZRdYJi5V
KN2qvLvjtQnwoqjZAW9vAvuL95ndj61QOigsL378O5QwPNedf90O+ZGuGWVR
Z1HG5gUONh+FH24Es7ykAMXRKn8Fgroje22kEObl4+zz4AwUGwc80dWzwvJt
1bZyfRegqC3bPN79Anh3VF6XP1fMTn0Yg9TA2Ic2bbPAY1Y/7Dx9FoWccnTq
5wOTPOJwJWAh8L5X+S6y4+byWzdDDluURfbVBG7H8Ak9ChlF3bnEodoByP9F
dQe4NnaKuwt7UczI0N9YwobCoTkjpasJFJWmSTnlwShZQ/szP9kWipd2Xaow
4UPh7C2Rm9UASjqPnvxPQDfwzS4cfL1aCIUBuoIFTeEoTYyM+c6ZAcSjtD0F
rSPAj1SEj824YhmTlVTWWAeHSaE3o1cYAd/gxqB7MwsFa9O3D0sPADWb/+Gv
FDMoaR8NqWK1ouAObbEj8xPQ+96WbYuygZI0nWeLvNWxnBZ7m3OoCjJlteVQ
q4QSa/vAMEMPFBpHlP7pSQRWR8DgwMnPefYf7MEBDgpvBJCt7d4C+y8dm2zp
Zx75DH+Ts3+gKNrXnGkgB64lplmWXoFi11Pd9EQtFK/YO3p/3hWKz2x6/nxX
CPDedex/up2I4ssuFy0GJ4B//UuO/c5I4NW87Nq0hIuS4K0ptLbS/wHx3qJA

    "]]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  ImageSize->{360., 269.42929882440984`},
  PlotRange->{{-300., 1264.2671325990464`}, {-75.17046624309796, 
    1241.6556584232178`}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}},
  ViewPoint->{1.7909891220322833`, -2.3399604242942056`, 1.6634131108954597`},
  
  ViewVertical->{0.1652774967842984, -0.02738769019652006, 
   2.464666893672469}]], "Output",
 CellChangeTimes->{3.411623340333036*^9, 3.411680338162736*^9, 
  3.411683342360393*^9, 3.411696737162952*^9, 3.411704042092712*^9, 
  3.411706076990509*^9, 3.4117104919946938`*^9, 3.411710530950554*^9, 
  3.411821881709697*^9, 3.411900464459754*^9, 3.411997007497267*^9, 
  3.412000955162081*^9, 3.412425778562511*^9, 3.412947525045014*^9, 
  3.413105446450199*^9, 3.413191930940246*^9, 3.413192654165154*^9, 
  3.413206055122016*^9, 3.413208092090541*^9, 3.41341876911763*^9, 
  3.413517122424385*^9, 3.4135198895649033`*^9, 3.413632462106077*^9, 
  3.4138114397956133`*^9, 3.414693892073653*^9, 3.414701722822816*^9, 
  3.4151633681689672`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3.2 We project onto the image plane (we're still in mm)", \
"Subsubsection",
 CellChangeTimes->{3.4117061773168364`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pts2D", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Proj", ",", "PtsCam"}], "]"}], "/.", "projRules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pts2DSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Proj", ",", "PtsCamSingle"}], "]"}], "/.", "projRules"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.411704370639082*^9, {3.41320606711341*^9, 3.41320608059641*^9}}],

Cell[CellGroupData[{

Cell[BoxData["MetricPlotRange"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4200000001408`"}], ",", "2.4200000001408`"}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.8149999999131001`"}], ",", "1.8149999999131001`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.413209726668797*^9, 3.4134187692194643`*^9, 
  3.4135171225333033`*^9, 3.413519889633947*^9, 3.413632462211203*^9, 
  3.413811439882195*^9, 3.414693892159421*^9, 3.414701792264426*^9, 
  3.4151633682770348`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Pts2D", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"2", "*", "MetricPlotRange"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413209281673976*^9, 3.413209351219236*^9, {3.413209690653946*^9, 
   3.413209720177596*^9}, {3.413209859281405*^9, 3.4132098843873777`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[CompressedData["
1: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
Fzz8HiA=
    "]]},
  Axes->True,
  PlotRange->{{-4.8400000002816, 4.8400000002816}, {-3.6299999998262003`, 
   3.6299999998262003`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.4132060910568647`*^9, 3.4132061051721897`*^9}, 
   3.413208110216103*^9, 3.41320928287398*^9, 3.413209351653995*^9, {
   3.413209695416127*^9, 3.4132097209834623`*^9}, {3.413209860133972*^9, 
   3.41320988493547*^9}, 3.413210411960516*^9, 3.41341876930762*^9, 
   3.4135171225992002`*^9, 3.413519889684711*^9, 3.413632462304263*^9, 
   3.413811439947424*^9, 3.414693892230332*^9, 3.414701792333663*^9, 
   3.415163368358851*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Pts2DSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"2", "*", "MetricPlotRange"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.413206094328266*^9, 3.4132060954878817`*^9}, 
   3.413209275076573*^9, 3.413209346586689*^9, {3.413209888665832*^9, 
   3.4132099016718483`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[CompressedData["
1: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
    "]]},
  Axes->True,
  PlotRange->{{-4.8400000002816, 4.8400000002816}, {-3.6299999998262003`, 
   3.6299999998262003`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.411623356271921*^9, 3.411680338264249*^9, 3.411683346101852*^9, 
   3.4116967513182*^9, 3.4117040462369747`*^9, 3.41170608070837*^9, 
   3.411710492144165*^9, 3.411710535335732*^9, 3.4118218938059464`*^9, 
   3.411997007626211*^9, 3.412000955226948*^9, 3.412425782530649*^9, 
   3.412947525156303*^9, 3.413105446520833*^9, 3.413191931144191*^9, 
   3.4131926542825403`*^9, {3.413206097341238*^9, 3.4132061066024923`*^9}, 
   3.413208113106146*^9, 3.413209276576591*^9, 3.413209346957574*^9, 
   3.413209902672928*^9, 3.4132104153243637`*^9, 3.413418769391102*^9, 
   3.413517122669599*^9, 3.413519889737665*^9, 3.4136324623982077`*^9, 
   3.413811440019539*^9, 3.414693892296547*^9, 3.414701797444826*^9, 
   3.415163368441677*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3.3 We distort the points", "Subsubsection",
 CellChangeTimes->{3.411706180890645*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CrookedPts2D", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "1"], "/.", "projRules"}], ")"}], 
      "\[NotEqual]", "0"}], ",", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Distort", ",", "Pts2D"}], "]"}], "//.", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Kappa]", "1"], "\[Rule]", 
        SubscriptBox["my\[Kappa]", "1"]}]}], "]"}], ",", "Pts2D"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedPts2DSingle", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "1"], "/.", "projRules"}], ")"}], 
      "\[NotEqual]", "0"}], ",", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Distort", ",", "Pts2DSingle"}], "]"}], "//.", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Kappa]", "1"], "\[Rule]", 
        SubscriptBox["my\[Kappa]", "1"]}]}], "]"}], ",", "Pts2DSingle"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4117042210369463`*^9, 3.411704350399219*^9}, {
  3.411704386738147*^9, 3.411704419231328*^9}, {3.41319260826405*^9, 
  3.4131926107887506`*^9}, {3.413206122268837*^9, 3.41320613702245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"CrookedPts2D", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"2", "*", "MetricPlotRange"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413192616252417*^9, 3.413209268278124*^9, 3.413209341762641*^9, {
   3.413209911562891*^9, 3.413209915350245*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[CompressedData["
1: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
f8u87/8AGc8ULA==
    "]]},
  Axes->True,
  PlotRange->{{-4.8400000002816, 4.8400000002816}, {-3.6299999998262003`, 
   3.6299999998262003`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.4132061464071817`*^9, 3.413208124415407*^9, 
  3.413209269559247*^9, 3.4132093421244297`*^9, 3.4132099157578917`*^9, 
  3.413210419875987*^9, 3.413418769703217*^9, 3.413517122810039*^9, 
  3.413519889887842*^9, 3.413632462542589*^9, 3.413811440253413*^9, 
  3.414693892446164*^9, 3.4147018062925053`*^9, 3.4151633685695257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"CrookedPts2DSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"2", "*", "MetricPlotRange"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "4", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413192616252417*^9, {3.413206151240036*^9, 3.4132061523084707`*^9}, 
   3.413209259414812*^9, 3.413209336658739*^9, {3.413209922755294*^9, 
   3.4132099260380163`*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[4], PointBox[CompressedData["
1:eJwVk3s41Ikeh2eMmTFm3FnCrA3rkVwqHOv6/aKoXGo5qFY3Udon6xa7e4Qp
lXtLJU1RluNSqlFS7Wb8cjuIRFq3IoTJZXZnMGaNS8f+8Xnev96/3ufjFxmy
MYxEIsmtL/QfEnMl/m6a/AzoH2jap1ceSoyXeNacd3KFntW8JPbtRIKQ6U35
5vrAq6VTzcP5i9C/M0lv/K0LNC77OJaNz8BMUOic0N0ZHhfFXk60yYCFSgj7
YvAapLhlSosSymCZZs26GmxM3BvfRP7XNhaSjhoe9Oh2IvjDL/q10Q7lFp9N
D24JIJolPbWWbkFI9d6W0F7OJToO3KVaFuoSIu6otWpDNczK2kXulyqIEQ2h
+8P3NjB9amtUwiUPuIUmD2L5bBAUxUS4DC7CaGCb+KNnHIw/uLldPZkLokCd
DZKTp2D08fP3A/9uA+mBmmt/K/BgqCCGYdb0Haw+KvE/VzwD/XqVdmbRTCRX
n+jJ5H6AN7J9SkS7Pcq7PyZnnHkLHWdsLQPGVJF2xT6Sa3oaGls/OTirVxGz
+TH7dX/KBClptd0qLpzo3S3z9k/cCJLijiij8WBo3fVf5R2F5bCgJqOGuE3B
ZJbP5jqXdJgLjhD8buAMc2Lrv5QOXQZRnrQr9+IGWBJ5XuByroKw5FpU/Ow4
kgxGp1YU1WDayfol3q5COcmXBcFHLUBAO8yPbUhFKidwdipJBOMMr+HdujeQ
/pKvcGiJCqMeGr0Zv/kQgrz9cxfqrsHnVAntZraQaJHFLmuF6MAaU8fP61Ue
9CZYMF1Tr8KK9z4Zr/oIzJSFt9l8dAXZd13aNHEgSKJ3F9zx1oa/9yapqR9I
hpVjW/RK8rVh0dWib+x5O5L9zzqn9GrCAiRl031HUd6o0TDr3O8wF5jtqG8X
i7S7FUpoHQyiTKkFae8VVBCbRD2JpoKwke1aed2QGAuS1nTFbkLKfPyXOaX3
iOtcW1ZknwtSDOO27N3UBCNBSY0XX/Wg3GbZrpvv1nvu4omZKT1I1mmqT4hx
AGn39eyS7+nweWoYKfJesPZwx1Nf8rewyjXnja1tRbnYtjFeyglY9psMSLt8
A6ng2GhllgVLxrrtUcMRSG8os7QKCAGp5kZK/LFBVKTF08ttOSAx0RVo23sT
g4w8ed2nRahAwbr6N9FQ/5AU7VhHQTq71DSkdBAm9pqVnK8dRZrqH59t0gQw
V9Y3FBZfg/ITrcbVFUkgU18K6uu6h5SKo/fNVPYj6Yc7DR95V1EutOBldLoX
Us79PDO3R4Rk4++Nt8U5Im2Xq+VzYR98Hno0fjuGigpt/VmRszmwmpOgy4aT
yGTO11Q05MJyWNrO/LorROeAPyfTZyMyRfu56iYR0MOgONlUAipKTK1jjFZg
2lDlCKnaHhk9BsdrVVVgYVbLi2XPRoUrZLFjsDOs2Oecvv/6KdKRXGTIUUdy
fMQF1bt3kDrxg+9AlT7Kn0uaD/LUQ/msudzy7hakby809msLRYpzkym9rBQZ
DbUPlp3WvZWib2zj9JBFaQy7SFpGUodtgbJHN1H9gRm12MVDFX6c/vkdNHi/
rN8yudMdle95Tzg9doY/O1O1Ws+2olI89TevMxyQsskDivlpyDKcLTQvLoe1
3e82K77pRUW+mx1V6d16T9M8dpwEGXtO2r0wGUHqj9t2+KQfQPrYfzZp0raj
gk1qaa7GINISUy0S6nmoWOW+5Kq3/pOvE0vys8ORJUqOdlgTImUovDv0tRBq
vjL434WON6j2zLwxgCuAj0FHb90wEqCaccrFD2YhIL5/ZI/DEydUTf7li63n
42HJRas4fekPVLnhZ+4bkIkkE8+vDJrDUdloRMblv0BKuFIw6Ogiq9TsEE/4
HmnHxqrZnTrINLk0T+X/igx9p08oBmQ86DDfkLGEzLwfOU9+mkYFt9c/f5t+
BpXeztj2XOIgbWIwV+xpC53FkpC6nFbUSNM2sxiOhE9arVHqI52oPmV1lq1Z
DvOTY88qvYWo7pCQc9wnGpb9F0OfixiolswZenTiIJINFSPOjpxG1drDwtjD
j1B+n4qOq0cmqkznvijOlUO61622magWVA7WUC1sFiBjrcU4ySofWT2/FNeG
HUdWnLvujIEdMgO6FjQXq1C5ur612aoMGZMW30gOKvwfUfrgPw==
    "]]},
  Axes->True,
  PlotRange->{{-4.8400000002816, 4.8400000002816}, {-3.6299999998262003`, 
   3.6299999998262003`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.411623371235588*^9, 3.411680338347122*^9, {3.411683350434886*^9, 
   3.411683365769562*^9}, 3.411696758509612*^9, 3.411704050995338*^9, 
   3.411704318454075*^9, {3.411704422520063*^9, 3.4117044683535357`*^9}, {
   3.411704548559134*^9, 3.411704588926868*^9}, 3.411706086288858*^9, 
   3.411710501811617*^9, 3.4117105398179092`*^9, 3.4119970198495626`*^9, 
   3.4120009552909*^9, 3.412947525260943*^9, 3.413105446683792*^9, 
   3.413191931245797*^9, 3.413192654419992*^9, 3.413206153505494*^9, {
   3.413208126374908*^9, 3.4132081285221987`*^9}, 3.413209260660762*^9, 
   3.4132093370375967`*^9, 3.413209926348852*^9, 3.413210423620302*^9, 
   3.41341876979095*^9, 3.413517122864833*^9, 3.413519889954957*^9, 
   3.413632462647434*^9, 3.413811440335869*^9, 3.41469389260878*^9, 
   3.414701806363*^9, 3.415163368657832*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
4.3.4 We get the positions in (integer) pixels in the image and clip out \
points\
\>", "Subsubsection",
 CellChangeTimes->{3.411706183554372*^9}],

Cell["\<\
Apply the \"integer\" mm-to-pixel mapping to our lists of image points\
\>", "Text",
 CellChangeTimes->{{3.413208282677306*^9, 3.413208313363855*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ImageGrid", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2pixel", ",", "Pts2D"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImageGridSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2pixel", ",", "Pts2DSingle"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedImageGrid", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2pixel", ",", "CrookedPts2D"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedImageGridSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2pixel", ",", "CrookedPts2DSingle"}], "]"}], "//.", 
     "projRules"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.411696782013383*^9, 3.411696788611555*^9}, {
  3.41319255236353*^9, 3.413192576163003*^9}, {3.413205792326214*^9, 
  3.413205856810979*^9}, {3.413206166126008*^9, 3.41320619580553*^9}, {
  3.4132062504874372`*^9, 3.4132062664498377`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
I build \"boolean\" tables indicating for each point whether it falls within \
image boundaries\
\>", "Text",
 CellChangeTimes->{{3.413208207029954*^9, 3.413208262958139*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PointIsIn", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "ImageGrid"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PointIsInSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "ImageGridSingle"}], "]"}], "//.", "projRules"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedPointIsIn", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "CrookedImageGrid"}], "]"}], "//.", 
     "projRules"}], "]"}]}], ";", 
  RowBox[{"CrookedPointIsInSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "CrookedImageGridSingle"}], "]"}], "//.", 
     "projRules"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.41169680243884*^9, 3.41169680493347*^9}, {
  3.413192686616084*^9, 3.413192716637244*^9}, {3.413205867266304*^9, 
  3.413205889464127*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We apply this function to our set of points to eliminate the ones that are \
not visible.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GridPtsIn", "=", "ImageGrid"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsWorldIn", "=", "PtsWorld"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "ImageGrid", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"i", ">", "0"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PointIsIn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GridPtsIn", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"GridPtsIn", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PtsWorldIn", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"PtsWorldIn", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GridPtsInSingle", "=", "ImageGridSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PtsWorldInSingle", "=", "PtsWorldSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "ImageGridSingle", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"i", ">", "0"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PointIsInSingle", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GridPtsInSingle", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"GridPtsInSingle", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PtsWorldInSingle", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"PtsWorldInSingle", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedGridPtsIn", "=", "CrookedImageGrid"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedPtsWorldIn", "=", "PtsWorld"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "CrookedImageGrid", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"i", ">", "0"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CrookedPointIsIn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CrookedGridPtsIn", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"CrookedGridPtsIn", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CrookedPtsWorldIn", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"CrookedPtsWorldIn", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedGridPtsInSingle", "=", "CrookedImageGridSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrookedPtsWorldInSingle", "=", "PtsWorldSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "CrookedImageGridSingle", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"i", ">", "0"}], ",", 
   RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CrookedPointIsInSingle", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CrookedGridPtsInSingle", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"CrookedGridPtsInSingle", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CrookedPtsWorldInSingle", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"CrookedPtsWorldInSingle", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.4117059717409897`*^9, 3.411705988077283*^9}, {
   3.413192736477763*^9, 3.413192781292151*^9}, {3.413205911849524*^9, 
   3.413205943984713*^9}, {3.413206288359682*^9, 3.413206328336329*^9}, {
   3.4132064319818563`*^9, 3.4132064361916037`*^9}, {3.4132083694325333`*^9, 
   3.413208404198387*^9}, 3.4132088622656727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Finally, we get an \"image\" plot",
 "\n",
 "Reminder: ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " displays 2D graphics with the y axis pointing ",
 StyleBox["up",
  FontWeight->"Bold"],
 ", so the grid below is the symmetric of the one that will appear in the \
image"
}], "Text",
 CellChangeTimes->{3.413208445595661*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"GridPtsIn", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413207104028274*^9, {3.413209243231502*^9, 3.4132092442708063`*^9}, 
   3.413209330548621*^9, {3.41320994571941*^9, 3.413209948955846*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{145., 298.}, {225., 286.}, {302., 274.}, {375., 263.}, {446., 
    252.}, {514., 241.}, {580., 231.}, {163., 377.}, {246., 362.}, {324., 
    349.}, {400., 335.}, {473., 323.}, {542., 310.}, {609., 299.}, {183., 
    461.}, {267., 444.}, {348., 428.}, {426., 413.}, {501., 398.}, {572., 
    384.}, {531., 479.}, {604., 463.}, {145., 298.}, {141., 335.}, {137., 
    368.}, {133., 398.}, {129., 424.}, {126., 449.}, {123., 471.}, {163., 
    377.}, {157., 410.}, {152., 440.}, {147., 467.}, {183., 461.}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.413207129547621*^9, 3.413209245150382*^9, 
  3.413209330924334*^9, 3.413209949842083*^9, 3.413418769923724*^9, 
  3.413517122997656*^9, 3.413519890073598*^9, 3.4136324630203657`*^9, 
  3.413811440470799*^9, 3.4146938927419357`*^9, 3.414701806478581*^9, 
  3.415163368792447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"GridPtsInSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413207117773628*^9, {3.4132093051193438`*^9, 3.413209325706604*^9}, 
   3.41320995767749*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{145., 298.}, {225., 286.}, {302., 274.}, {375., 263.}, {446., 
    252.}, {514., 241.}, {580., 231.}, {163., 377.}, {246., 362.}, {324., 
    349.}, {400., 335.}, {473., 323.}, {542., 310.}, {609., 299.}, {183., 
    461.}, {267., 444.}, {348., 428.}, {426., 413.}, {501., 398.}, {572., 
    384.}, {531., 479.}, {604., 463.}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.413207132492856*^9, {3.41320930705781*^9, 3.413209326633626*^9}, 
   3.413209958639881*^9, 3.413418770001419*^9, 3.413517123067675*^9, 
   3.4135198901337137`*^9, 3.413632463118558*^9, 3.413811440551139*^9, 
   3.4146938928135*^9, 3.4147018065458307`*^9, 3.415163368874051*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"CrookedGridPtsIn", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.413207123269342*^9, {3.4132093109336042`*^9, 3.4132093205066023`*^9}, 
   3.413209963715303*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{151., 296.}, {226., 285.}, {302., 274.}, {375., 263.}, {444., 
    252.}, {508., 241.}, {566., 232.}, {618., 223.}, {169., 372.}, {247., 
    360.}, {324., 347.}, {399., 334.}, {469., 320.}, {532., 307.}, {590., 
    295.}, {190., 449.}, {269., 437.}, {348., 422.}, {422., 407.}, {492., 
    391.}, {556., 375.}, {613., 359.}, {515., 461.}, {578., 442.}, {635., 
    424.}, {151., 296.}, {147., 332.}, {144., 363.}, {142., 390.}, {140., 
    414.}, {138., 435.}, {137., 455.}, {136., 472.}, {169., 372.}, {165., 
    402.}, {161., 429.}, {158., 453.}, {156., 473.}, {190., 449.}, {185., 
    475.}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.413207136507111*^9, {3.4132093125921164`*^9, 3.413209321589876*^9}, 
   3.4132099643222857`*^9, 3.413210431820822*^9, 3.4134187700897303`*^9, 
   3.413517123134973*^9, 3.4135198901878357`*^9, 3.4136324631927757`*^9, 
   3.413811440617311*^9, 3.414693892880355*^9, 3.414701806609058*^9, 
   3.415163369036964*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"CrookedGridPtsInSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{3.413207127837997*^9, 3.4132073985912848`*^9, 
  3.413209969523733*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{151., 296.}, {226., 285.}, {302., 274.}, {375., 263.}, {444., 
    252.}, {508., 241.}, {566., 232.}, {618., 223.}, {169., 372.}, {247., 
    360.}, {324., 347.}, {399., 334.}, {469., 320.}, {532., 307.}, {590., 
    295.}, {190., 449.}, {269., 437.}, {348., 422.}, {422., 407.}, {492., 
    391.}, {556., 375.}, {613., 359.}, {515., 461.}, {578., 442.}, {635., 
    424.}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.411623379562104*^9, 3.411680338483551*^9, 
  3.411683366049363*^9, 3.4116968152265778`*^9, 3.411706371533667*^9, 
  3.411709615521315*^9, 3.411710547224745*^9, 3.412000955475773*^9, 
  3.412947587082239*^9, 3.4129477236908083`*^9, 3.413105446839758*^9, 
  3.413191931456073*^9, 3.4132071407937517`*^9, 3.413207399632268*^9, 
  3.413209970803516*^9, 3.413418770173407*^9, 3.413517123201783*^9, 
  3.413519890253858*^9, 3.4136324632753143`*^9, 3.41381144068381*^9, 
  3.414693892945961*^9, 3.41470180667929*^9, 3.415163369123827*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3.5 We do the same (clip-out) for exact \"float\" pixels", \
"Subsubsection",
 CellChangeTimes->{
  3.411706187597568*^9, {3.413208748708055*^9, 3.413208749967024*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlImageGrid", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2flPixel", ",", "Pts2D"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlImageGridSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"mm2flPixel", ",", "Pts2DSingle"}], "]"}], "//.", "projRules"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.411696823331942*^9, 3.4116968254786873`*^9}, {
  3.413208771316733*^9, 3.413208794486293*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A function to check whether a  point is out of image boundaries\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlPointIsIn", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "FlImageGrid"}], "]"}], "//.", "projRules"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlPointIsInSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"isItIn", ",", "FlImageGridSingle"}], "]"}], "//.", 
     "projRules"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.411696831995303*^9, 3.4116968342529173`*^9}, {
  3.4132088088262787`*^9, 3.413208839173922*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We apply this function to our set of points to eliminate the ones that are \
not visible.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlGridPtsIn", "=", "FlImageGrid"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlPtsWorldIn", "=", "PtsWorld"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "ImageGrid", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"i", ">", "0"}], ",", 
   RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FlPointIsIn", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FlGridPtsIn", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"FlGridPtsIn", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FlPtsWorldIn", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"FlPtsWorldIn", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nbFlPtsIn", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "FlGridPtsIn", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlGridPtsInSingle", "=", "FlImageGridSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlPtsWorldInSingle", "=", "PtsWorldSingle"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "ImageGridSingle", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"i", ">", "0"}], ",", 
   RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FlPointIsInSingle", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FlGridPtsInSingle", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"FlGridPtsInSingle", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FlPtsWorldInSingle", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"FlPtsWorldInSingle", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}]}], "]"}]}]}]}], "]"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbFlPtsInSingle", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "FlGridPtsInSingle", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4117064182798967`*^9, 3.411706450296273*^9}, {
  3.413208882134192*^9, 3.413208959581224*^9}, {3.413418901156846*^9, 
  3.41341896295848*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Finally, we get an \"image\" plot\nReminder: ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " displays 2D graphics with the y axis pointing ",
 StyleBox["up",
  FontWeight->"Bold"],
 ", so the grid below is the symmetric of the one that will appear in the \
image"
}], "Text",
 CellChangeTimes->{{3.411710338596627*^9, 3.4117103401292753`*^9}, {
  3.4132090278727407`*^9, 3.413209031158462*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"FlGridPtsIn", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{3.413209053464719*^9, 3.4132099777397203`*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{145.45454546470083`, 298.18181818460386`}, {225.2283469481904, 
    285.899694956593}, {301.8056604121667, 274.1097089844537}, {
    375.37483436618766`, 262.7828617804469}, {446.10970480556307`, 
    251.8923892305886}, {514.170966557055, 241.41355045970798`}, {
    579.7073920080973, 231.32344019362466`}, {163.35605667831223`, 
    376.7226422541869}, {245.55342118020954`, 362.3469364836926}, {
    324.34388270244546`, 348.5670726251747}, {399.9349539093897, 
    335.34675826190306`}, {472.5176301693622, 322.65258972898954`}, {
    542.2680008905436, 310.45377030276023`}, {609.3486758352153, 
    298.7218607490359}, {182.59032919445426`, 461.1108034418347}, {
    267.3585012712627, 444.3608177226836}, {348.4880421148001, 
    428.3298167321324}, {426.2083088343513, 412.97248006027957`}, {
    500.72977886229467`, 398.24721787570434`}, {572.2459533991043, 
    384.11579480933847`}, {530.9375908748526, 479.1892383176727}, {
    604.3002382586377, 462.8797969935945}, {145.45454546470083`, 
    298.18181818460386`}, {140.7482838938373, 334.99284473046646`}, {
    136.5397965564245, 367.91042416432754`}, {132.7540768674609, 
    397.5212364549975}, {129.3304672382842, 424.2997278424133}, {
    126.2193844288472, 448.63372419178125`}, {123.37990254094419`, 
    470.84333612648555`}, {163.35605667831223`, 376.7226422541869}, {
    157.45727055876233`, 410.2447121489864}, {152.20233747040402`, 
    440.1078451241965}, {147.49129779042036`, 466.8800993183591}, {
    182.59032919445426`, 461.1108034418347}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.413209059507695*^9, 3.4132099784196177`*^9, 
  3.4132100595981417`*^9, 3.4134187703005667`*^9, 3.4135171234120617`*^9, 
  3.413519890420545*^9, 3.4136324634222403`*^9, 3.413811440794941*^9, 
  3.414693893057872*^9, 3.414701806780116*^9, 3.415163369251206*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"FlGridPtsInSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", "PixelPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{3.413209057684363*^9, 3.4132099826192017`*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{145.45454546470083`, 298.18181818460386`}, {225.2283469481904, 
    285.899694956593}, {301.8056604121667, 274.1097089844537}, {
    375.37483436618766`, 262.7828617804469}, {446.10970480556307`, 
    251.8923892305886}, {514.170966557055, 241.41355045970798`}, {
    579.7073920080973, 231.32344019362466`}, {163.35605667831223`, 
    376.7226422541869}, {245.55342118020954`, 362.3469364836926}, {
    324.34388270244546`, 348.5670726251747}, {399.9349539093897, 
    335.34675826190306`}, {472.5176301693622, 322.65258972898954`}, {
    542.2680008905436, 310.45377030276023`}, {609.3486758352153, 
    298.7218607490359}, {182.59032919445426`, 461.1108034418347}, {
    267.3585012712627, 444.3608177226836}, {348.4880421148001, 
    428.3298167321324}, {426.2083088343513, 412.97248006027957`}, {
    500.72977886229467`, 398.24721787570434`}, {572.2459533991043, 
    384.11579480933847`}, {530.9375908748526, 479.1892383176727}, {
    604.3002382586377, 462.8797969935945}}]},
  Axes->True,
  PlotRange->{{0, 639}, {0, 479}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.411623390339834*^9, 3.4116803386143847`*^9, 
  3.411683366180366*^9, 3.4116968576509647`*^9, 3.411706525235983*^9, 
  3.4117070482352543`*^9, 3.411709200105175*^9, 3.411709710942729*^9, 
  3.411709796217557*^9, 3.411710556380753*^9, 3.4120009558738003`*^9, 
  3.412947587366403*^9, 3.412947751899501*^9, 3.413105447043054*^9, 
  3.413191931743885*^9, 3.4132090618224173`*^9, 3.41320998359945*^9, 
  3.413210062080276*^9, 3.4134187703899183`*^9, 3.4135171234679937`*^9, 
  3.413519890718854*^9, 3.4136324635063467`*^9, 3.413811440867208*^9, 
  3.4146938931246777`*^9, 3.4147018068860826`*^9, 3.415163369323728*^9},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
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
dIvTxTI+0cYyIbJiy6Aa0oyQfwEc7avR\
\>"]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3.6 For more verification, we convert back to metric", "Subsubsection",
 CellChangeTimes->{{3.4117087886646*^9, 3.411708801704564*^9}, {
  3.411710351684124*^9, 3.4117103530104437`*^9}, {3.413209035867914*^9, 
  3.413209036897944*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlMetricPtsIn", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"flPixel2mm", ",", "FlGridPtsIn"}], "]"}], "//.", "projRules"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"FlMetricPtsIn", ",", 
   RowBox[{"PlotRange", "\[Rule]", "MetricPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.411708810625033*^9, 3.4117088737578163`*^9}, {
   3.41320909522771*^9, 3.413209113830577*^9}, 3.413209190022684*^9, {
   3.413209993219117*^9, 3.413210030086009*^9}, {3.4132104557640467`*^9, 
   3.413210459088483*^9}}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{-1.2, 0.3999999999999999}, {-0.6515551147690998, 
    0.31556040281146824`}, {-0.12508608467363186`, 0.2345042492568912}, {
    0.3807019862896901, 0.1566321747330732}, {0.86700422058869, 
    0.08176017595638208}, {1.3349253951574214`, 0.009718159410027048}, {
    1.7854883201595517`, -0.0596513486659744}, {-1.076927110399261, 
    0.9399681654525301}, {-0.511820229415838, 0.841135188285114}, {
    0.02986419358105006, 0.7463986242623394}, {0.5495528081590283, 
    0.6555089630191985}, {1.0485587074753722`, 0.5682365543595965}, {
    1.5280925062113944`, 0.48436967080828547`}, {1.989272146482845, 
    0.4037127926302924}, {-0.9446914868430909, 
    1.520136773589831}, {-0.3619103037811256, 1.4049806217761804`}, {
    0.19585528955064607`, 1.2947674899714179`}, {0.7301821232786487, 
    1.189185800357485}, {1.2425172297505678`, 1.0879496228433774`}, {
    1.7341909297197409`, 0.9907960892667637}, {1.4501959373489868`, 
    1.6444260133552662`}, {1.9545641381418544`, 1.5322986042575972`}, {-1.2, 
    0.3999999999999999}, {-1.2323555483015693`, 
    0.6530758074906883}, {-1.2612888987479656`, 
    0.8793841660876478}, {-1.2873157216111049`, 
    1.082958500576257}, {-1.310853037813064, 
    1.2670606288559259`}, {-1.3322417321291877`, 
    1.4343568537498206`}, {-1.3517631701096569`, 
    1.5870479357936018`}, {-1.076927110399261, 
    0.9399681654525301}, {-1.1174812649735262`, 
    1.1704323959682426`}, {-1.1536089299580916`, 
    1.3757414351629818`}, {-1.1859973277598637`, 
    1.5598006827390372`}, {-0.9446914868430909, 1.520136773589831}}]},
  Axes->True,
  PlotRange->{{-2.4200000001408, 2.4200000001408}, {-1.8149999999131001`, 
   1.8149999999131001`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{
  3.413209122643653*^9, 3.413209191552174*^9, {3.413210001084673*^9, 
   3.413210030894025*^9}, 3.413210064316402*^9, {3.4132104469999657`*^9, 
   3.413210459710739*^9}, 3.413418770472726*^9, 3.413517123568482*^9, 
   3.413519890748152*^9, 3.413632463591401*^9, 3.413811440934444*^9, 
   3.414693893196106*^9, 3.4147018069624643`*^9, 3.4151633694067707`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlMetricPtsInSingle", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"flPixel2mm", ",", "FlGridPtsInSingle"}], "]"}], "//.", 
     "projRules"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"FlMetricPtsInSingle", ",", 
   RowBox[{"PlotRange", "\[Rule]", "MetricPlotRange"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.411708810625033*^9, 3.4117088737578163`*^9}, {
   3.41320909522771*^9, 3.4132091363941603`*^9}, 3.4132091846239853`*^9, 
   3.413210470632707*^9}],

Cell[BoxData[
 GraphicsBox[
  {RGBColor[1, 0, 0], AbsolutePointSize[5], 
   PointBox[{{-1.2, 0.3999999999999999}, {-0.6515551147690998, 
    0.31556040281146824`}, {-0.12508608467363186`, 0.2345042492568912}, {
    0.3807019862896901, 0.1566321747330732}, {0.86700422058869, 
    0.08176017595638208}, {1.3349253951574214`, 0.009718159410027048}, {
    1.7854883201595517`, -0.0596513486659744}, {-1.076927110399261, 
    0.9399681654525301}, {-0.511820229415838, 0.841135188285114}, {
    0.02986419358105006, 0.7463986242623394}, {0.5495528081590283, 
    0.6555089630191985}, {1.0485587074753722`, 0.5682365543595965}, {
    1.5280925062113944`, 0.48436967080828547`}, {1.989272146482845, 
    0.4037127926302924}, {-0.9446914868430909, 
    1.520136773589831}, {-0.3619103037811256, 1.4049806217761804`}, {
    0.19585528955064607`, 1.2947674899714179`}, {0.7301821232786487, 
    1.189185800357485}, {1.2425172297505678`, 1.0879496228433774`}, {
    1.7341909297197409`, 0.9907960892667637}, {1.4501959373489868`, 
    1.6444260133552662`}, {1.9545641381418544`, 1.5322986042575972`}}]},
  Axes->True,
  PlotRange->{{-2.4200000001408, 2.4200000001408}, {-1.8149999999131001`, 
   1.8149999999131001`}},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.411708852121409*^9, 3.4117088750465307`*^9}, 
   3.411709202776271*^9, 3.4117097152273073`*^9, 3.411709811042947*^9, 
   3.411710556462923*^9, 3.412000955906707*^9, 3.412947761283662*^9, 
   3.413105447109724*^9, 3.4131919318274517`*^9, {3.41320911551532*^9, 
   3.413209137590559*^9}, 3.413209196869747*^9, 3.413210471522386*^9, 
   3.4134187706942883`*^9, 3.413517123650895*^9, 3.413519890786416*^9, 
   3.413632463707884*^9, 3.413811441017305*^9, 3.414693893262719*^9, 
   3.414701807046241*^9, 3.415163369490271*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
5. Calibration Calculations
\
\>", "Section",
 CellChangeTimes->{{3.4129478451485033`*^9, 3.4129478937735863`*^9}, 
   3.41294821715492*^9}],

Cell[CellGroupData[{

Cell["\<\
5.1 Build and check the matrix of the homogeneous equation (using \"metric\" \
points)\
\>", "Subsection",
 CellChangeTimes->{{3.411680580103607*^9, 3.411680580201041*^9}, {
   3.411681882331951*^9, 3.411681899348461*^9}, 3.411706193131791*^9, {
   3.413105519804335*^9, 3.413105555239949*^9}, {3.413105593986743*^9, 
   3.4131056043123493`*^9}, {3.413105801070949*^9, 3.413105801658201*^9}, {
   3.4131069211191683`*^9, 3.413106921654595*^9}, {3.413421225679042*^9, 
   3.413421227366721*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "5.1.1 Single calibration plane, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " exact points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413106858512265*^9, 3.413106873539527*^9}, {3.413192284994383*^9, 
  3.413192286078477*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmatSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", "0.", ",", 
            "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Pts2D", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Pts2D", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ptsPerGrid"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
  3.413419231546109*^9, 3.413419250471953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"AmatSingle", ".", "fullStateVec"}], "/.", "projRules"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, {
   3.4134192539486847`*^9, 3.413419254959339*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.413105744723072*^9, 3.413105773857744*^9}, 
   3.413191931923588*^9, 3.413418770797369*^9, 3.4134192682919188`*^9, 
   3.413423143599082*^9, 3.4135199151570787`*^9, 3.4136324638289127`*^9, 
   3.413811441142416*^9, 3.414693893389634*^9, 3.415163369635928*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "5.1.2 Two calibration planes, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " exact points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413105701620224*^9, 3.4131057051053333`*^9}, {3.413106268391552*^9, 
  3.413106268950416*^9}, {3.413106876467608*^9, 3.4131068800200033`*^9}, {
  3.413192294379245*^9, 3.413192294455318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Amat", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", "0.", ",", 
            "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Pts2D", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Pts2D", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "totalNbPts"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
  3.413105709886571*^9, 3.4131057397904587`*^9}, {3.413419257785578*^9, 
  3.413419259503627*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"Amat", ".", "fullStateVec"}], "/.", "projRules"}], "]"}]], "Input",\

 CellChangeTimes->{
  3.413105722417491*^9, {3.413419261828421*^9, 3.413419263358273*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.413105779982234*^9, 3.413191931990962*^9, 
  3.4134187708651876`*^9, 3.413419268401927*^9, 3.413423133228335*^9, 
  3.413519915224267*^9, 3.413632464014645*^9, 3.4138114413001823`*^9, 
  3.414693893487136*^9, 3.41516336972683*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
5.1.3  Single calibration plane, using only points that fall inside the image\
\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134192097644653`*^9, 
  3.413419214414975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmatInSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", "0.", ",", 
            "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"FlMetricPtsInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"FlMetricPtsInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsInSingle"}], "}"}]}], "]"}], ",",
       "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413105926794887*^9, 3.4131059271803617`*^9}, {3.413105980221602*^9, 
   3.4131060555862627`*^9}, 3.4131062964478903`*^9, {3.413106332625787*^9, 
   3.413106345923931*^9}, {3.413419050308426*^9, 3.413419051397531*^9}, {
   3.413419099284766*^9, 3.413419120189744*^9}, {3.4134191570539503`*^9, 
   3.413419165581452*^9}, {3.413419279550721*^9, 3.41341928360959*^9}, {
   3.413420864873191*^9, 3.413420918361927*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"AmatInSingle", ".", "fullStateVec"}], "/.", "projRules"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, 
   3.413106062029768*^9, 3.413419294171317*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.41342092529362*^9, 3.4135199153022623`*^9, 
  3.413632464107609*^9, 3.41381144137987*^9, 3.414693893641141*^9, 
  3.415163369818995*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
5.1.4  Two calibration planes, using only points that fall inside the image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134211453874903`*^9, 
  3.4134211465102177`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmatIn", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", "0.", ",", 
            "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"FlMetricPtsIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"f", "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", "f", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"FlMetricPtsIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsIn"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413105926794887*^9, 3.4131059271803617`*^9}, {3.413105980221602*^9, 
   3.4131060555862627`*^9}, 3.4131062964478903`*^9, {3.413106332625787*^9, 
   3.413106345923931*^9}, {3.413419050308426*^9, 3.413419051397531*^9}, {
   3.413419099284766*^9, 3.413419120189744*^9}, {3.4134191570539503`*^9, 
   3.413419165581452*^9}, {3.413419220858223*^9, 3.4134192238298273`*^9}, {
   3.413420830449464*^9, 3.413420832276122*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"AmatIn", ".", "fullStateVec"}], "/.", "projRules"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, 
   3.413106062029768*^9, 3.4134209356929207`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{3.413421768624692*^9, 3.413519915373088*^9, 
  3.413632464205419*^9, 3.413811441463131*^9, 3.414693893725214*^9, 
  3.415163369901157*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
5.2 Build and check the matrix and right side term of the scaled LLS system\
\>", "Subsection",
 CellChangeTimes->{{3.413421152060074*^9, 3.413421217662405*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "5.2.1 Single calibration plane, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " exact points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413106858512265*^9, 3.413106873539527*^9}, {3.413192284994383*^9, 
  3.413192286078477*^9}, {3.413421785464116*^9, 3.413421785674644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LLSmatSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ptsPerGrid"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";", 
  RowBox[{"BmatSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Pts2D", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Pts2D", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ptsPerGrid"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413419231546109*^9, 3.413419250471953*^9}, {3.413421919147687*^9, 
   3.4134219209439163`*^9}, {3.4134219683027897`*^9, 
   3.4134219695542917`*^9}, {3.4134220151923513`*^9, 3.413422066601055*^9}, 
   3.413422310862969*^9, {3.413422998523243*^9, 3.4134230225220737`*^9}, {
   3.4134232960975857`*^9, 3.413423297186627*^9}, {3.413425245615397*^9, 
   3.413425252976026*^9}, 3.41342571680105*^9, {3.413425763784182*^9, 
   3.4134257755638027`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"LLSmatSingle", ".", "partialScaledStateVec"}], "-", 
    "BmatSingle"}], "/.", "projRules"}], "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, {
   3.4134192539486847`*^9, 3.413419254959339*^9}, 3.413421748764063*^9, {
   3.413422145623015*^9, 3.4134221767668247`*^9}, {3.413423030295985*^9, 
   3.413423030932433*^9}, {3.413423266037839*^9, 3.4134232679048147`*^9}, {
   3.413425187929369*^9, 3.413425200616715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.413422166428445*^9, 3.413422177841861*^9}, 
   3.413423031930538*^9, {3.41342326106345*^9, 3.413423268861669*^9}, 
   3.4134232994733143`*^9, {3.413425206286016*^9, 3.413425221094715*^9}, 
   3.413425255198379*^9, 3.413425789204566*^9, 3.413519915441647*^9, 
   3.4136324643141737`*^9, 3.4138114415473747`*^9, 3.4146938938065042`*^9, 
   3.414701829669579*^9, 3.415163370075574*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"LLSmatSingle", ",", "BmatSingle"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413425855842358*^9, 3.413425873919549*^9}, {
  3.413432903092855*^9, 3.413432904807809*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002674231439060184`", ",", "0.0010692236594974352`", ",", 
   RowBox[{"-", "0.0026742314388017415`"}], ",", 
   RowBox[{"-", "1.2000000000001478`"}], ",", 
   RowBox[{"-", "0.00038926770283710525`"}], ",", "0.0033826834323653055`", 
   ",", "0.0003892677026873028`", ",", "0.40000000000001257`", ",", 
   RowBox[{"-", "0.00010435492829721317`"}], ",", "0.00023096988312790948`", 
   ",", "0.00010435492811629138`"}], "}"}]], "Output",
 CellChangeTimes->{3.413425874789917*^9, 3.4134329111652727`*^9, 
  3.4135199155141983`*^9, 3.413632464457637*^9, 3.4138114416657667`*^9, 
  3.414693893879961*^9, 3.414701829755746*^9, 3.4151633701388683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["partialScaledStateVec"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`"}], "}"}]], "Output",
 CellChangeTimes->{3.413425882914113*^9, 3.413519915579927*^9, 
  3.413632464522091*^9, 3.41381144173234*^9, 3.414693893944253*^9, 
  3.414701829841186*^9, 3.41516337020479*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"partialScaleToFullStateVect", "[", "sol", "]"}], "-", 
   "fullStateVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.4134329083365993`*^9, 3.413432908680113*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.07484197094967848`"}], ",", "0.02267138308394695`", ",", 
   RowBox[{"-", "0.18824859989767906`"}], ",", 
   RowBox[{"-", "25.444311355441073`"}], ",", "0.3563689666867096`", ",", 
   "0.0717250420582699`", ",", "0.3728767144027303`", ",", 
   "8.481437118470396`", ",", 
   RowBox[{"-", "0.6090948842066151`"}], ",", "0.03917913080035629`", ",", 
   RowBox[{"-", "0.5736916937422735`"}], ",", 
   RowBox[{"-", "169.62874236933976`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.41343291396453*^9, 3.4135199156469507`*^9, 
  3.413632464589369*^9, 3.4138114417987957`*^9, 3.414693894010784*^9, 
  3.4147018299219112`*^9, 3.4151633702723103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "5.1.2 Two calibration planes, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " exact points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413105701620224*^9, 3.4131057051053333`*^9}, {3.413106268391552*^9, 
  3.413106268950416*^9}, {3.413106876467608*^9, 3.4131068800200033`*^9}, {
  3.413192294379245*^9, 3.413192294455318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LLSmat", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Pts2D", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "totalNbPts"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";", 
  RowBox[{"Bmat", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Pts2D", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Pts2D", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "totalNbPts"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413419231546109*^9, 3.413419250471953*^9}, {3.413421919147687*^9, 
   3.4134219209439163`*^9}, {3.4134219683027897`*^9, 
   3.4134219695542917`*^9}, {3.4134220151923513`*^9, 3.413422066601055*^9}, 
   3.413422310862969*^9, {3.413422998523243*^9, 3.4134230225220737`*^9}, {
   3.4134232960975857`*^9, 3.413423297186627*^9}, {3.413425245615397*^9, 
   3.413425252976026*^9}, 3.41342571680105*^9, {3.413425763784182*^9, 
   3.4134257755638027`*^9}, {3.413425987400457*^9, 3.41342600222217*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"LLSmat", ".", "partialScaledStateVec"}], "-", "Bmat"}], "/.", 
   "projRules"}], "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, {
   3.4134192539486847`*^9, 3.413419254959339*^9}, 3.413421748764063*^9, {
   3.413422145623015*^9, 3.4134221767668247`*^9}, {3.413423030295985*^9, 
   3.413423030932433*^9}, {3.413423266037839*^9, 3.4134232679048147`*^9}, {
   3.413425187929369*^9, 3.413425200616715*^9}, {3.4134260046502647`*^9, 
   3.41342601224857*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.413426014786338*^9, 3.4135199157285137`*^9, 
  3.4136324646748857`*^9, 3.413811441881165*^9, 3.414693894093155*^9, 
  3.414701830029068*^9, 3.4151633703576813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"LLSmat", ",", "Bmat"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413425855842358*^9, 3.413425873919549*^9}, {
  3.41342601874926*^9, 3.413426023451891*^9}, {3.413432888979145*^9, 
  3.41343289000795*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.003200412580765202`", ",", "0.001069223659497688`", ",", 
   RowBox[{"-", "0.0021480502970954592`"}], ",", 
   RowBox[{"-", "1.2000000000001236`"}], ",", 
   RowBox[{"-", "0.0018477590650225284`"}], ",", "0.003382683432365122`", ",",
    
   RowBox[{"-", "0.0010692236594980282`"}], ",", "0.3999999999999926`", ",", 
   "0.00019134171618267004`", ",", "0.00023096988312785142`", ",", 
   "0.0004000515725957994`"}], "}"}]], "Output",
 CellChangeTimes->{3.41342602494405*^9, 3.4134329233798943`*^9, 
  3.4135199157961206`*^9, 3.413632464755814*^9, 3.413811441949306*^9, 
  3.414693894160969*^9, 3.4147018301048307`*^9, 3.415163370421131*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["partialScaledStateVec"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`"}], "}"}]], "Output",
 CellChangeTimes->{3.4134260272760897`*^9, 3.413519915863243*^9, 
  3.4136324648224583`*^9, 3.4138114420158653`*^9, 3.414693894226729*^9, 
  3.414701830170702*^9, 3.415163370488789*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"partialScaleToFullStateVect", "[", "sol", "]"}], "-", 
   "fullStateVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.413432894472386*^9, 3.413432894911874*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.4134329257270803`*^9, 3.413519915929884*^9, 
  3.413632464888958*^9, 3.413811442082922*^9, 3.41469389429351*^9, 
  3.414701830237431*^9, 3.4151633705554667`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
5.1.3  Single calibration plane, using only exact points that fall inside the \
image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134192097644653`*^9, 
  3.413419214414975*^9}, {3.413517904030048*^9, 3.413517906767741*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLSmatInSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldInSingle", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldInSingle", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsInSingle"}], "}"}]}], "]"}], ",",
       "1"}], "]"}], "//.", "projRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BmatInSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FlMetricPtsInSingle", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"FlMetricPtsInSingle", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsInSingle"}], "}"}]}], "]"}], ",",
       "1"}], "]"}], "//.", "projRules"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413105926794887*^9, 3.4131059271803617`*^9}, {3.413105980221602*^9, 
   3.4131060555862627`*^9}, 3.4131062964478903`*^9, {3.413106332625787*^9, 
   3.413106345923931*^9}, {3.413419050308426*^9, 3.413419051397531*^9}, {
   3.413419099284766*^9, 3.413419120189744*^9}, {3.4134191570539503`*^9, 
   3.413419165581452*^9}, {3.413419279550721*^9, 3.41341928360959*^9}, {
   3.413420864873191*^9, 3.413420918361927*^9}, {3.413426058286268*^9, 
   3.413426084892356*^9}, {3.4134261227840233`*^9, 3.413426190241323*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"LLSmatInSingle", ".", "partialScaledStateVec"}], "-", 
    "BmatInSingle"}], "/.", "projRules"}], "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, 
   3.413106062029768*^9, 3.413419294171317*^9, 3.4134217358321857`*^9, {
   3.413426199796855*^9, 3.413426218807736*^9}, {3.413426296891477*^9, 
   3.413426297392034*^9}, 3.413430805704447*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.413426220015416*^9, 3.413426299089768*^9, 
  3.4134308093197527`*^9, 3.413519916011232*^9, 3.413632465050331*^9, 
  3.4138114421821947`*^9, 3.414693894374341*^9, 3.4147018303341208`*^9, 
  3.4151633706351223`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"LLSmatInSingle", ",", "BmatInSingle"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413425855842358*^9, 3.413425873919549*^9}, {
  3.41342601874926*^9, 3.413426023451891*^9}, {3.4134308162635717`*^9, 
  3.413430821199622*^9}, {3.4134329460196323`*^9, 3.4134329471844378`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0026742314388203247`", ",", "0.001069223659497632`", ",", 
   RowBox[{"-", "0.002674231439040088`"}], ",", 
   RowBox[{"-", "1.1999999999999833`"}], ",", 
   RowBox[{"-", "0.0003892677027416983`"}], ",", "0.003382683432364828`", ",",
    "0.0003892677027830201`", ",", "0.3999999999999915`", ",", 
   RowBox[{"-", "0.00010435492819049812`"}], ",", "0.00023096988312809393`", 
   ",", "0.00010435492822276712`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.413430823113778*^9, {3.413432948024665*^9, 3.413432952839026*^9}, 
   3.4135199160804863`*^9, 3.4136324651310673`*^9, 3.413811442251153*^9, 
   3.41469389444349*^9, 3.414701830404867*^9, 3.415163370704832*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["partialScaledStateVec"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`"}], "}"}]], "Output",
 CellChangeTimes->{3.4134308250145493`*^9, 3.413519916225877*^9, 
  3.413632465203588*^9, 3.413811442401504*^9, 3.414693894512553*^9, 
  3.414701830505172*^9, 3.415163370771858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"partialScaleToFullStateVect", "[", "sol", "]"}], "-", 
   "fullStateVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.4134329501073*^9, 3.413432950560191*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.07484197101458712`"}], ",", "0.022671383084057195`", ",", 
   RowBox[{"-", "0.18824859996246168`"}], ",", 
   RowBox[{"-", "25.44431135546023`"}], ",", "0.3563689667125636`", ",", 
   "0.0717250420583202`", ",", "0.37287671442870984`", ",", 
   "8.481437118485928`", ",", 
   RowBox[{"-", "0.6090948839751273`"}], ",", "0.03917913080085467`", ",", 
   RowBox[{"-", "0.5736916935112163`"}], ",", 
   RowBox[{"-", "169.62874236976495`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4134329549059677`*^9, 3.413519916296309*^9, 
  3.4136324652662697`*^9, 3.4138114424661217`*^9, 3.414693894577574*^9, 
  3.414701830737789*^9, 3.415163370839052*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
5.1.4  Two calibration planes, using only exact points that fall inside the \
image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134211453874903`*^9, 
  3.4134211465102177`*^9}, {3.413517912024694*^9, 3.413517913792927*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLSmatIn", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", "0.", ",", "0.", 
            ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", "0.", ",", 
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"FlPtsWorldIn", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1.", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"FlMetricPtsIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"FlPtsWorldIn", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsIn"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BmatIn", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FlMetricPtsIn", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"FlMetricPtsIn", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nbFlPtsIn"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.413105674362904*^9, 3.41310567688614*^9}, {
   3.413105926794887*^9, 3.4131059271803617`*^9}, {3.413105980221602*^9, 
   3.4131060555862627`*^9}, 3.4131062964478903`*^9, {3.413106332625787*^9, 
   3.413106345923931*^9}, {3.413419050308426*^9, 3.413419051397531*^9}, {
   3.413419099284766*^9, 3.413419120189744*^9}, {3.4134191570539503`*^9, 
   3.413419165581452*^9}, {3.413419220858223*^9, 3.4134192238298273`*^9}, {
   3.413420830449464*^9, 3.413420832276122*^9}, {3.413430853252858*^9, 
   3.413430876840798*^9}, {3.413430958965605*^9, 3.413431003925109*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"LLSmatIn", ".", "partialScaledStateVec"}], "-", "BmatIn"}], "/.",
    "projRules"}], "]"}]], "Input",
 CellChangeTimes->{
  3.413105715698535*^9, {3.413105767678598*^9, 3.413105772591654*^9}, 
   3.413106062029768*^9, 3.4134209356929207`*^9, 3.413421733523755*^9, {
   3.4134308849191217`*^9, 3.413430903403249*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{3.413430907262027*^9, 3.4134309704118357`*^9, 
  3.413431007401888*^9, 3.4135199163963203`*^9, 3.413632465382187*^9, 
  3.413811442563407*^9, 3.414693894754682*^9, 3.4147018308446903`*^9, 
  3.41516337092024*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"LLSmatIn", ",", "BmatIn"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.413425855842358*^9, 3.413425873919549*^9}, {
  3.41342601874926*^9, 3.413426023451891*^9}, {3.4134308162635717`*^9, 
  3.413430821199622*^9}, {3.413431039284955*^9, 3.413431043896182*^9}, {
  3.4134329606116877`*^9, 3.413432961368482*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807646978`", ",", "0.0010692236594974866`", ",", 
   RowBox[{"-", "0.0021480502970951695`"}], ",", 
   RowBox[{"-", "1.199999999999947`"}], ",", 
   RowBox[{"-", "0.0018477590650228057`"}], ",", "0.003382683432364888`", ",",
    
   RowBox[{"-", "0.0010692236594976058`"}], ",", "0.40000000000001057`", ",", 
   "0.0001913417161825307`", ",", "0.00023096988312772208`", ",", 
   "0.00040005157259529275`"}], "}"}]], "Output",
 CellChangeTimes->{3.41343105611893*^9, 3.413432962268436*^9, 
  3.4135199164640503`*^9, 3.41363246545546*^9, 3.413811442649365*^9, 
  3.414693894828165*^9, 3.414701830920506*^9, 3.4151633710678673`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["partialScaledStateVec"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0032004125807650625`", ",", "0.0010692236594976939`", ",", 
   RowBox[{"-", "0.0021480502970952697`"}], ",", 
   RowBox[{"-", "1.2`"}], ",", 
   RowBox[{"-", "0.0018477590650225735`"}], ",", "0.00338268343236509`", ",", 
   
   RowBox[{"-", "0.0010692236594976939`"}], ",", "0.4`", ",", 
   "0.0001913417161825449`", ",", "0.0002309698831278217`", ",", 
   "0.0004000515725956328`"}], "}"}]], "Output",
 CellChangeTimes->{3.413431058201582*^9, 3.413519916530237*^9, 
  3.413632465521887*^9, 3.413811442732458*^9, 3.414693894894334*^9, 
  3.4147018310055437`*^9, 3.415163371138465*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"partialScaleToFullStateVect", "[", "sol", "]"}], "-", 
   "fullStateVec"}], "]"}]], "Input",
 CellChangeTimes->{{3.4134329681555977`*^9, 3.413432968576453*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.2187229003757238`*^-10"}]}], "}"}]], "Output",
 CellChangeTimes->{3.413432973315633*^9, 3.413519916596408*^9, 
  3.4136324655882177`*^9, 3.413811442815056*^9, 3.414693894960763*^9, 
  3.414701831088071*^9, 3.415163371204661*^9}]
}, Open  ]],

Cell["\<\
Since we have a solution, I verify that this is the one that a QR \
factorization would give us\
\>", "Text",
 CellChangeTimes->{{3.413517151272018*^9, 3.413517180331719*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"myQt", ",", "myR"}], "}"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"QRDecomposition", "[", "LLSmatIn", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dmat", "=", 
   RowBox[{"myQt", ".", "BmatIn"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qrSol", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"myR", ",", "Dmat"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"qrSol", "-", "partialScaledStateVec"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4135172036609297`*^9, 3.4135172678547573`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.413517232892951*^9, 3.413517268531705*^9}, 
   3.413519916663261*^9, 3.413632465693482*^9, 3.413811442932488*^9, 
   3.414693895027746*^9, 3.414701831171239*^9, 3.4151633712707*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
5.3 Build and check the \"projection matrix\" of the DLT algorithm\
\>", "Subsection",
 CellChangeTimes->{{3.4134730737510777`*^9, 3.413473114040989*^9}}],

Cell[TextData[{
 "We simply express that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["m",
     FontWeight->"Bold"], "i"], TraditionalForm]]],
 " \[Times] (",
 StyleBox["P",
  FontWeight->"Bold"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["M",
      FontWeight->"Bold"], "i"], ")"}], TraditionalForm]]],
 StyleBox[" ",
  FontWeight->"Bold"],
 "= ",
 StyleBox["0",
  FontWeight->"Bold"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["m",
     FontWeight->"Bold"], "i"], TraditionalForm]]],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "i"], ",", 
     SubscriptBox["y", "i"], ",", "1"}], ")"}], TraditionalForm]]],
 ", ",
 StyleBox["P",
  FontWeight->"Bold"],
 " is the projection matrix, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["M",
      FontWeight->"Bold"], "i"], "="}], TraditionalForm]]],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["X", "i"], ",", 
      SubscriptBox["Y", "i"], ",", 
      RowBox[{
       SubscriptBox["Z", "i"], "1"}]}], ")"}], "."}], TraditionalForm]]],
 "\nEach point gives us three linear equations in terms of the flattened \
projection matrix, but these equations are linearly dependent, we only use \
the first two equations."
}], "Text",
 CellChangeTimes->{{3.4138152021208477`*^9, 3.413815545255672*^9}, {
  3.413815686513133*^9, 3.413815700432311*^9}, {3.413816041674411*^9, 
  3.413816042827796*^9}, {3.413816249676293*^9, 3.41381626333645*^9}, {
  3.413816300394393*^9, 3.41381633999164*^9}, {3.4138167306675873`*^9, 
  3.413816746093656*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "5.3.1 Single calibration plane, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " float points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413106858512265*^9, 3.413106873539527*^9}, {3.413192284994383*^9, 
  3.413192286078477*^9}, {3.413421785464116*^9, 3.413421785674644*^9}, {
  3.413816785937085*^9, 3.413816813546616*^9}, {3.414737038811307*^9, 
  3.41473704035811*^9}, {3.4147370837130423`*^9, 3.414737084591529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlDLTmatSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"FlImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"FlImageGrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"FlImageGrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"FlImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], "}"}], ",",
         
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ptsPerGrid"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413816355347766*^9, 3.413816386776144*^9}, {
   3.41381664063918*^9, 3.4138166543089046`*^9}, 3.413816687016637*^9, {
   3.413816874217177*^9, 3.413816875677622*^9}, {3.413817135589122*^9, 
   3.4138171486706543`*^9}, {3.413817299036677*^9, 3.413817305732922*^9}, {
   3.4138175382244577`*^9, 3.413817542574048*^9}, 3.414735177433786*^9, {
   3.4147370898707523`*^9, 3.41473710792612*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"FlDLTmatSingle", ".", "ProjVect"}], ",", 
   SuperscriptBox["10", 
    RowBox[{"-", "8"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.4138168947251*^9, 3.41381690936583*^9}, {
  3.414737114241962*^9, 3.414737135804834*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.414737117603467*^9, 3.4147371369589577`*^9}, 
   3.415163371351783*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now use SVD and get the eigenvector associated to the smallest singular value\
\
\>", "Text",
 CellChangeTimes->{{3.414694394259173*^9, 3.4146944320629673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"S1", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "[", 
  RowBox[{"[", "9", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4152025837250023`*^9, 3.415202617326202*^9}, {
  3.415202765602558*^9, 3.4152027673025837`*^9}}],

Cell[BoxData["1888.7792689858882`"], "Output",
 CellChangeTimes->{{3.415202604618881*^9, 3.415202618098421*^9}, 
   3.415202768528131*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U1", ",", "S1", ",", "V1"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "FlDLTmatSingle", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.414694437628783*^9, 3.414694486212101*^9}, {
  3.414694518206705*^9, 3.414694520473792*^9}, {3.4147371455006857`*^9, 
  3.414737145808889*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"DecomposeProjVect", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "V1", "]"}], "[", 
     RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"RotMat", "/.", "projRules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.414694571526679*^9, 3.414694601205921*^9}, 
   3.4147376015697327`*^9, {3.4151664740562677`*^9, 3.415166475320489*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.001646676904138117`", 
      RowBox[{"-", "0.00015640980955608565`"}], "0.0015466144740217541`"},
     {
      RowBox[{"-", "8.491219411748359`*^-20"}], 
      RowBox[{"-", "0.003548080260235179`"}], "0.00472695419835937`"},
     {"4.1137539834644723`*^-23", "1.4834123469325778`*^-23", 
      "1.961363651159632`*^-6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.415166307548954*^9, 3.415166479631793*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6952909748989862`", "0.40261122534413657`", 
      RowBox[{"-", "0.5953777468556494`"}]},
     {"0.5340903767010241`", 
      RowBox[{"-", "0.843755177493982`"}], "0.05314762428798355`"},
     {
      RowBox[{"-", "0.4809552263354409`"}], 
      RowBox[{"-", "0.35493858860229793`"}], 
      RowBox[{"-", "0.801686140943969`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.415166307548954*^9, 3.41516647964212*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451912656`", "0.26730591487442346`", 
      RowBox[{"-", "0.5370125742738174`"}]},
     {
      RowBox[{"-", "0.46193976625564337`"}], "0.8456708580912725`", 
      RowBox[{"-", "0.26730591487442346`"}]},
     {"0.3826834323650898`", "0.46193976625564337`", "0.8001031451912656`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.415166307548954*^9, 3.415166479650189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rankMat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V1", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"V1", "[", 
      RowBox[{"[", "11", "]"}], "]"}], ",", 
     RowBox[{"V1", "[", 
      RowBox[{"[", "12", "]"}], "]"}], ",", "ProjVect"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U2", ",", "S2", ",", "V2"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "rankMat", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "S2", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.415202851190427*^9, 3.415202900147028*^9}, {
  3.41520297201943*^9, 3.415203057574888*^9}, {3.415203126534685*^9, 
  3.415203133299529*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"663539.4141036761`", "0.`", "0.`", "0.`"},
     {"0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.9999999999999997`", "0.`"},
     {"0.`", "0.`", "0.`", "0.999676270299501`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.41520288956498*^9, 3.41520297960664*^9, 
  3.415203059033828*^9, 3.415203134097983*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The eigenvector compared to the solution, normalized", "Text",
 CellChangeTimes->{{3.4146946098032417`*^9, 3.414694620161455*^9}, {
  3.4147349628458567`*^9, 3.414734964703424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "V1", "]"}], "[", 
    RowBox[{"[", "12", "]"}], "]"}], "-", 
   RowBox[{"ProjVect", "/", 
    RowBox[{"Norm", "[", "ProjVect", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.413818914606864*^9, 3.4138189182870197`*^9}, {
  3.413819020916525*^9, 3.4138190606512747`*^9}, {3.413819193638865*^9, 
  3.413819243950182*^9}, {3.41469462671576*^9, 3.414694633854453*^9}, {
  3.4147350028547907`*^9, 3.41473501478699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001536102098160966`", ",", "0.0004919821946502925`", ",", 
   RowBox[{"-", "0.0035562151815623543`"}], ",", "0.8768330710801967`", ",", 
   RowBox[{"-", "0.00511695909618263`"}], ",", "0.0026318873497334543`", ",", 
   
   RowBox[{"-", "0.004736269617804906`"}], ",", "1.7975077956056622`", ",", 
   RowBox[{"-", "1.5200586203197315`*^-6"}], ",", 
   RowBox[{"-", "1.392338969558883`*^-6"}], ",", 
   RowBox[{"-", "2.7782090877297472`*^-6"}], ",", "0.006028227363255329`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.41473715239657*^9, 3.415163371503109*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "5.3.2 Two calibration planes, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " float points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413106858512265*^9, 3.413106873539527*^9}, {3.413192284994383*^9, 
  3.413192286078477*^9}, {3.413421785464116*^9, 3.413421785674644*^9}, {
  3.413816785937085*^9, 3.413816813546616*^9}, {3.414737038811307*^9, 
  3.41473704035811*^9}, {3.4147370837130423`*^9, 3.414737084591529*^9}, {
  3.414737225027648*^9, 3.414737231032195*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlDLTmat", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"FlImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"FlImageGrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"FlImageGrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"FlImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], "}"}], ",",
         
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "totalNbPts"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413816355347766*^9, 3.413816386776144*^9}, {
   3.41381664063918*^9, 3.4138166543089046`*^9}, 3.413816687016637*^9, {
   3.413816874217177*^9, 3.413816875677622*^9}, {3.413817135589122*^9, 
   3.4138171486706543`*^9}, {3.413817299036677*^9, 3.413817305732922*^9}, {
   3.4138175382244577`*^9, 3.413817542574048*^9}, 3.414735177433786*^9, {
   3.4147370898707523`*^9, 3.41473710792612*^9}, {3.414737234490922*^9, 
   3.414737250049624*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{"FlDLTmat", ".", "ProjVect"}], ",", 
   SuperscriptBox["10", 
    RowBox[{"-", "8"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.4138168947251*^9, 3.41381690936583*^9}, {
  3.414737114241962*^9, 3.414737135804834*^9}, {3.414737263296907*^9, 
  3.414737264508494*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.414737117603467*^9, 3.4147371369589577`*^9}, 
   3.414737265892874*^9, 3.415163371588863*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now use SVD and get the eigenvector associated to the smallest singular value\
\
\>", "Text",
 CellChangeTimes->{{3.414694394259173*^9, 3.4146944320629673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U1", ",", "S1", ",", "V1"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "FlDLTmat", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.414694437628783*^9, 3.414694486212101*^9}, {
  3.414694518206705*^9, 3.414694520473792*^9}, {3.4147371455006857`*^9, 
  3.414737145808889*^9}, {3.414737270512125*^9, 3.414737271798315*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"S1", "[", 
   RowBox[{"[", "11", "]"}], "]"}], "[", 
  RowBox[{"[", "11", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4152025837250023`*^9, 3.415202650405044*^9}}],

Cell[BoxData["5.627733976725607`"], "Output",
 CellChangeTimes->{{3.415202644910097*^9, 3.415202650992106*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"DecomposeProjVect", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "V1", "]"}], "[", 
     RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"RotMat", "/.", "projRules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.414694571526679*^9, 3.414694601205921*^9}, 
   3.4147376015697327`*^9, {3.415166373240057*^9, 3.4151663850519342`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0017536808497510402`", "2.369975461483002`*^-16", 
      "0.0004822622337104005`"},
     {
      RowBox[{"-", "6.092245319462036`*^-20"}], 
      RowBox[{"-", "0.0017536808499370735`"}], "0.0003616966752824167`"},
     {
      RowBox[{"-", "4.9104230757595706`*^-23"}], 
      RowBox[{"-", "2.3108518190393462`*^-23"}], "1.5070694803452773`*^-6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4151663402683764`*^9, 3.41516638582135*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451914218`", "0.2673059148747446`", 
      RowBox[{"-", "0.5370125742734247`"}]},
     {"0.46193976625573585`", 
      RowBox[{"-", "0.8456708580912269`"}], "0.26730591487440825`"},
     {
      RowBox[{"-", "0.3826834323646514`"}], 
      RowBox[{"-", "0.4619397662555413`"}], 
      RowBox[{"-", "0.8001031451915341`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4151663402683764`*^9, 3.4151663858316927`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451912656`", "0.26730591487442346`", 
      RowBox[{"-", "0.5370125742738174`"}]},
     {
      RowBox[{"-", "0.46193976625564337`"}], "0.8456708580912725`", 
      RowBox[{"-", "0.26730591487442346`"}]},
     {"0.3826834323650898`", "0.46193976625564337`", "0.8001031451912656`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4151663402683764`*^9, 3.415166385839614*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The eigenvector compared to the solution, normalized", "Text",
 CellChangeTimes->{{3.4146946098032417`*^9, 3.414694620161455*^9}, {
  3.4147349628458567`*^9, 3.414734964703424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "V1", "]"}], "[", 
    RowBox[{"[", "12", "]"}], "]"}], "-", 
   RowBox[{"ProjVect", "/", 
    RowBox[{"Norm", "[", "ProjVect", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.413818914606864*^9, 3.4138189182870197`*^9}, {
  3.413819020916525*^9, 3.4138190606512747`*^9}, {3.413819193638865*^9, 
  3.413819243950182*^9}, {3.41469462671576*^9, 3.414694633854453*^9}, {
  3.4147350028547907`*^9, 3.41473501478699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002437143593303219`", ",", "0.0004919863208534907`", ",", 
   RowBox[{"-", "0.0026552163951550725`"}], ",", "0.8768404249877995`", ",", 
   RowBox[{"-", "0.0018970204941580115`"}], ",", "0.0026319094230982786`", 
   ",", 
   RowBox[{"-", "0.00151632782297764`"}], ",", "1.7975228711162092`", ",", 
   RowBox[{"-", "1.1534610431006863`*^-6"}], ",", 
   RowBox[{"-", "1.3923506469619905`*^-6"}], ",", 
   RowBox[{"-", "2.411622062490236`*^-6"}], ",", "0.006028277921369963`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.41473715239657*^9, 3.414737282746359*^9, 
  3.415163371737667*^9, 3.41516635388122*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"DecomposeProjVect", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "V1", "]"}], "[", 
     RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.4147373236606007`*^9, 3.414737373801759*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0017536808497510402`", "2.369975461483002`*^-16", 
      "0.0004822622337104005`"},
     {
      RowBox[{"-", "6.092245319462036`*^-20"}], 
      RowBox[{"-", "0.0017536808499370735`"}], "0.0003616966752824167`"},
     {
      RowBox[{"-", "4.9104230757595706`*^-23"}], 
      RowBox[{"-", "2.3108518190393462`*^-23"}], "1.5070694803452773`*^-6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414737326374034*^9, {3.414737359068768*^9, 3.4147373747255173`*^9}, 
   3.415163371804564*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001031451914218`", "0.2673059148747446`", 
      RowBox[{"-", "0.5370125742734247`"}]},
     {"0.46193976625573585`", 
      RowBox[{"-", "0.8456708580912269`"}], "0.26730591487440825`"},
     {
      RowBox[{"-", "0.3826834323646514`"}], 
      RowBox[{"-", "0.4619397662555413`"}], 
      RowBox[{"-", "0.8001031451915341`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.414737326374034*^9, {3.414737359068768*^9, 3.4147373747255173`*^9}, 
   3.41516337181312*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"R", "-", "RotMat"}], "/.", "projRules"}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.414738014448419*^9, 3.414738046397118*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0.9238795325113792`", 
      RowBox[{"-", "1.6913417161824995`"}], "0.5346118297488317`"},
     {
      RowBox[{"-", "0.7653668647297411`"}], 
      RowBox[{"-", "0.9238795325111846`"}], 
      RowBox[{"-", "1.6002062903827996`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.414738038495433*^9, 3.4147380472179127`*^9}, 
   3.41516337188804*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "5.3.3 Single calibration plane, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " integer points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413106858512265*^9, 3.413106873539527*^9}, {3.413192284994383*^9, 
  3.413192286078477*^9}, {3.413421785464116*^9, 3.413421785674644*^9}, {
  3.413816785937085*^9, 3.413816813546616*^9}, {3.414737038811307*^9, 
  3.41473704035811*^9}, {3.41473721123701*^9, 3.414737212487825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DLTmatSingle", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ImageGrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"ImageGrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"ImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], "}"}], ",",
         
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ptsPerGrid"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.413816355347766*^9, 3.413816386776144*^9}, {
   3.41381664063918*^9, 3.4138166543089046`*^9}, 3.413816687016637*^9, {
   3.413816874217177*^9, 3.413816875677622*^9}, {3.413817135589122*^9, 
   3.4138171486706543`*^9}, {3.413817299036677*^9, 3.413817305732922*^9}, {
   3.4138175382244577`*^9, 3.413817542574048*^9}, 3.414735177433786*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DLTmatSingle", ".", "ProjVect"}]], "Input",
 CellChangeTimes->{{3.4138168947251*^9, 3.41381690936583*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"363.6363692077575`", ",", 
   RowBox[{"-", "909.090929401631`"}], ",", 
   RowBox[{"-", "204.7970170553308`"}], ",", 
   RowBox[{"-", "466.22554813465104`"}], ",", "228.5769074644195`", ",", 
   "404.90341065544635`", ",", 
   RowBox[{"-", "461.46777108102106`"}], ",", 
   RowBox[{"-", "796.6077084227`"}], ",", 
   RowBox[{"-", "233.18908140866552`"}], ",", 
   RowBox[{"-", "237.72679049964063`"}], ",", "913.4129764810787`", ",", 
   RowBox[{"-", "377.61551968427375`"}], ",", "727.8865748929093`", ",", 
   "658.5001901756041`", ",", 
   RowBox[{"-", "914.9942000213196`"}], ",", "327.97471240651794`", ",", 
   "527.4162784124492`", ",", "589.0660757247824`", ",", 
   "428.98844095499953`", ",", 
   RowBox[{"-", "1184.355289107887`"}], ",", 
   RowBox[{"-", "535.4971057856455`"}], ",", 
   RowBox[{"-", "687.441845811496`"}], ",", "684.3152163969353`", ",", 
   "880.8548425077461`", ",", 
   RowBox[{"-", "871.9992781953188`"}], ",", 
   RowBox[{"-", "692.6461243929807`"}], ",", "712.9124294696376`", ",", 
   "133.73053097561933`", ",", 
   RowBox[{"-", "728.7545073361835`"}], ",", "1011.8560607256368`", ",", 
   "970.8047581153223`", ",", 
   RowBox[{"-", "573.3661681609228`"}], ",", 
   RowBox[{"-", "606.6664485994261`"}], ",", 
   RowBox[{"-", "760.5180855609942`"}], ",", "957.0885469430359`", ",", 
   "199.94848082959652`", ",", 
   RowBox[{"-", "1006.6387573768152`"}], ",", 
   RowBox[{"-", "207.06310200714506`"}], ",", "170.86014056100976`", ",", 
   RowBox[{"-", "50.843799009686336`"}], ",", "206.2515288630966`", ",", 
   "762.5686402448919`", ",", "686.6938720425824`", ",", 
   RowBox[{"-", "682.2852942604804`"}], ",", "641.4612261425937`", ",", 
   RowBox[{"-", "949.19409135147`"}], ",", 
   RowBox[{"-", "54.67232268478256`"}], ",", 
   RowBox[{"-", "413.8354925720487`"}], ",", "501.4532669663895`", ",", 
   "548.1127605343936`", ",", "239.7100685595069`", ",", 
   RowBox[{"-", "509.1550001122523`"}], ",", 
   RowBox[{"-", "965.1278317528777`"}], ",", "137.19736573495902`", ",", 
   "1068.9373903842643`", ",", "83.10616127843969`", ",", 
   RowBox[{"-", "118.9298723336542`"}], ",", 
   RowBox[{"-", "1047.106355025433`"}], ",", 
   RowBox[{"-", "304.9898242687341`"}], ",", "845.0736986140255`", ",", 
   "43.992536859354004`", ",", 
   RowBox[{"-", "559.059471232642`"}], ",", 
   RowBox[{"-", "784.2927576962393`"}], ",", "345.9612709635403`", ",", 
   RowBox[{"-", "26.38314351195004`"}], ",", 
   RowBox[{"-", "780.48627985036`"}], ",", "400.36836037877947`", ",", 
   RowBox[{"-", "729.8256548483623`"}], ",", "370.73584012826905`", ",", 
   "122.26540442649275`", ",", 
   RowBox[{"-", "240.50661811127793`"}], ",", 
   RowBox[{"-", "600.7278051681351`"}], ",", "483.9940046928823`", ",", 
   "685.4489267379977`", ",", "459.9168043775717`", ",", 
   RowBox[{"-", "438.2980358770583`"}], ",", 
   RowBox[{"-", "437.9641329051228`"}], ",", 
   RowBox[{"-", "220.74659751309082`"}], ",", 
   RowBox[{"-", "167.069874274428`"}], ",", 
   RowBox[{"-", "1080.1534325943794`"}], ",", "432.83618190838024`", ",", 
   "516.1822404957493`", ",", 
   RowBox[{"-", "508.95629758457653`"}], ",", 
   RowBox[{"-", "187.180369323818`"}], ",", "385.89795935805887`", ",", 
   RowBox[{"-", "602.2684795195237`"}], ",", 
   RowBox[{"-", "578.7251554536633`"}], ",", "618.076308611664`", ",", 
   "126.33058103988878`", ",", 
   RowBox[{"-", "681.4317972285207`"}], ",", "569.5191721781157`", ",", 
   "667.7156237005256`", ",", "625.6147041136865`", ",", "468.4908078184817`",
    ",", "169.3912629983388`", ",", "235.02003895840608`", ",", 
   RowBox[{"-", "924.3770650157239`"}], ",", 
   RowBox[{"-", "408.37442442332394`"}], ",", 
   RowBox[{"-", "682.4023119857302`"}], ",", "261.14355792012066`", ",", 
   RowBox[{"-", "479.1976229012944`"}], ",", "57.58474036853295`", ",", 
   RowBox[{"-", "630.6336719142273`"}], ",", 
   RowBox[{"-", "794.2959633466089`"}], ",", 
   RowBox[{"-", "348.51633210433647`"}], ",", 
   RowBox[{"-", "830.2864799891831`"}], ",", "241.92848268011585`", ",", 
   RowBox[{"-", "551.2904649502598`"}], ",", 
   RowBox[{"-", "805.0382018473465`"}], ",", 
   RowBox[{"-", "458.2115736210253`"}], ",", 
   RowBox[{"-", "15.358149939915165`"}], ",", "810.3015703281853`", ",", 
   "706.9716353993863`", ",", 
   RowBox[{"-", "929.4227806541603`"}], ",", 
   RowBox[{"-", "709.0137339653447`"}], ",", 
   RowBox[{"-", "466.2972729478497`"}], ",", 
   RowBox[{"-", "538.8041945900768`"}], ",", 
   RowBox[{"-", "38.254679817473516`"}], ",", 
   RowBox[{"-", "811.6226633270271`"}], ",", 
   RowBox[{"-", "20.972742806188762`"}], ",", "763.0013861362822`", ",", 
   RowBox[{"-", "558.470656059566`"}], ",", "513.6582778349984`", ",", 
   RowBox[{"-", "265.135119082639`"}], ",", 
   RowBox[{"-", "566.6428593785968`"}], ",", 
   RowBox[{"-", "212.5479179539252`"}], ",", "690.6063952334225`", ",", 
   "682.6415023051668`", ",", "782.961850672029`", ",", "168.3073908034712`", 
   ",", 
   RowBox[{"-", "540.0283207595348`"}], ",", 
   RowBox[{"-", "588.7157549159601`"}], ",", "140.59612937434576`", ",", 
   RowBox[{"-", "254.62555217859335`"}], ",", 
   RowBox[{"-", "928.0608176223468`"}], ",", "794.900257471716`", ",", 
   RowBox[{"-", "160.07102818437852`"}], ",", "265.99395186058246`", ",", 
   "484.63354577566497`", ",", 
   RowBox[{"-", "382.31617248943076`"}], ",", 
   RowBox[{"-", "237.4366141858045`"}], ",", 
   RowBox[{"-", "232.76649298681878`"}], ",", 
   RowBox[{"-", "83.21293995855376`"}], ",", "776.6834790230496`", ",", 
   RowBox[{"-", "203.9456519416999`"}], ",", "627.3285221406259`", ",", 
   "790.1025814486202`", ",", "208.00231255870312`", ",", 
   RowBox[{"-", "590.1564147595782`"}], ",", "574.506411599461`", ",", 
   "450.6189234238118`", ",", 
   RowBox[{"-", "497.73593797301874`"}], ",", "381.59844974428415`", ",", 
   RowBox[{"-", "104.02415914251469`"}], ",", "759.4873809164856`", ",", 
   RowBox[{"-", "427.19303786358796`"}], ",", 
   RowBox[{"-", "389.83921260014176`"}], ",", 
   RowBox[{"-", "119.24721383512951`"}], ",", "464.4488154486753`", ",", 
   "444.1355713997036`", ",", "459.6353944069706`", ",", "411.0785451414995`",
    ",", 
   RowBox[{"-", "134.64548233011737`"}], ",", "220.1268947494682`", ",", 
   RowBox[{"-", "447.88110257452354`"}], ",", 
   RowBox[{"-", "463.43206720845774`"}], ",", 
   RowBox[{"-", "730.5232940223068`"}], ",", "750.8425648617558`", ",", 
   "379.6162812553812`", ",", "136.7668043221347`", ",", 
   RowBox[{"-", "551.4525644034147`"}], ",", "251.74944189819507`", ",", 
   RowBox[{"-", "507.159356163349`"}], ",", "594.8868221982848`", ",", 
   "387.2699921273161`", ",", "665.275289830286`", ",", "227.00151586695574`",
    ",", 
   RowBox[{"-", "37.98881059582345`"}], ",", "582.9334093960933`", ",", 
   RowBox[{"-", "194.45911243604496`"}], ",", 
   RowBox[{"-", "364.70600733999163`"}], ",", 
   RowBox[{"-", "626.9355416747276`"}], ",", 
   RowBox[{"-", "190.28407998848706`"}], ",", "485.69591214181855`", ",", 
   RowBox[{"-", "471.71262643206865`"}], ",", "479.02029872802086`", ",", 
   RowBox[{"-", "83.06215880997479`"}], ",", 
   RowBox[{"-", "21.936549447709695`"}], ",", "725.21549518127`", ",", 
   RowBox[{"-", "225.18091478804126`"}], ",", "117.57733587780967`", ",", 
   RowBox[{"-", "756.8423665317241`"}], ",", 
   RowBox[{"-", "654.8212350131944`"}], ",", 
   RowBox[{"-", "616.2173306674231`"}], ",", 
   RowBox[{"-", "173.85693065426312`"}], ",", 
   RowBox[{"-", "304.20946258632466`"}], ",", 
   RowBox[{"-", "275.07275070855394`"}], ",", 
   RowBox[{"-", "321.7224176810123`"}], ",", "543.1385342259891`", ",", 
   "582.3992057568394`"}], "}"}]], "Output",
 CellChangeTimes->{3.415163372077981*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now use SVD and get the eigenvector associated to the smallest singular value\
\
\>", "Text",
 CellChangeTimes->{{3.414694394259173*^9, 3.4146944320629673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U1", ",", "S1", ",", "V1"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "DLTmatSingle", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.414694437628783*^9, 3.414694486212101*^9}, {
  3.414694518206705*^9, 3.414694520473792*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"DecomposeProjVect", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "V1", "]"}], "[", 
     RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.414694571526679*^9, 3.414694601205921*^9}, 
   3.4147376015697327`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "7.213152145123934`*^-15"}], 
      RowBox[{"-", "1.5585198569186335`*^-14"}], 
      RowBox[{"-", "0.12927803585560618`"}]},
     {"3.30630148742953`*^-31", 
      RowBox[{"-", "3.600895188313494`*^-14"}], "0.99160834565298`"},
     {
      RowBox[{"-", "1.3111756935731613`*^-20"}], 
      RowBox[{"-", "3.836227217715253`*^-21"}], "0.0002797796938304086`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4151662310469637`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.6786558051399217`", 
      RowBox[{"-", "0.28080704460500744`"}], 
      RowBox[{"-", "0.6786558051399003`"}]},
     {"0.19856056544513492`", "0.9597642438120944`", 
      RowBox[{"-", "0.1985605654451733`"}]},
     {"0.7071067811865427`", "3.033301220974364`*^-14", 
      "0.7071067811865526`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4151662310534983`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The eigenvector, normalized", "Text",
 CellChangeTimes->{{3.4146945564348917`*^9, 3.414694583135817*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "V1", "]"}], "[", 
  RowBox[{"[", "12", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.414694571526679*^9, 3.414694601205921*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.09141337581198411`"}], ",", 
   RowBox[{"-", "1.6854004623317716`*^-14"}], ",", 
   RowBox[{"-", "0.0914133758119694`"}], ",", "3.1379772377081554`*^-12", ",",
    "0.7011729854923839`", ",", 
   RowBox[{"-", "4.4816364186075736`*^-15"}], ",", "0.701172985492408`", ",", 
   "1.0864220863308064`*^-12", ",", "0.00019783411874577662`", ",", 
   "8.48656086899612`*^-18", ",", "0.00019783411874577938`", ",", 
   RowBox[{"-", "6.431860819072288`*^-15"}]}], "}"}]], "Output",
 CellChangeTimes->{3.415163372182485*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The eigenvector compared to the solution, normalized", "Text",
 CellChangeTimes->{{3.4146946098032417`*^9, 3.414694620161455*^9}, {
  3.4147349628458567`*^9, 3.414734964703424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "V1", "]"}], "[", 
    RowBox[{"[", "12", "]"}], "]"}], "-", 
   RowBox[{"ProjVect", "/", 
    RowBox[{"Norm", "[", "ProjVect", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.413818914606864*^9, 3.4138189182870197`*^9}, {
  3.413819020916525*^9, 3.4138190606512747`*^9}, {3.413819193638865*^9, 
  3.413819243950182*^9}, {3.41469462671576*^9, 3.414694633854453*^9}, {
  3.4147350028547907`*^9, 3.41473501478699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.09019480401533263`"}], ",", "0.0002459931604098736`", ",", 
   
   RowBox[{"-", "0.09274098400954693`"}], ",", "0.43842021249702334`", ",", 
   "0.700224475245305`", ",", "0.0013159547115447264`", ",", 
   "0.7004148215809193`", ",", "0.8987614355591982`", ",", 
   "0.00019725738822422647`", ",", 
   RowBox[{"-", "6.961753234719466`*^-7"}], ",", "0.00019662830771453556`", 
   ",", "0.0030141389606785887`"}], "}"}]], "Output",
 CellChangeTimes->{3.415163372270945*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "5.3.2 Two calibration planes, using ",
 StyleBox["all",
  FontVariations->{"Underline"->True}],
 " integer points"
}], "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.413105701620224*^9, 3.4131057051053333`*^9}, {3.413106268391552*^9, 
  3.413106268950416*^9}, {3.413106876467608*^9, 3.4131068800200033`*^9}, {
  3.413192294379245*^9, 3.413192294455318*^9}, {3.413816789211014*^9, 
  3.413816789520277*^9}, {3.413816821867367*^9, 3.413816822362892*^9}, {
  3.41516628552356*^9, 3.415166287447591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DLTmat", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ImageGrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PtsWorld", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "1", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"ImageGrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "*", 
              RowBox[{"PtsWorld", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"ImageGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], "}"}], ",",
         
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "totalNbPts"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}], "//.", "projRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.414735131756461*^9, 3.4147351327915897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U1", ",", "S1", ",", "V1"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "DLTmat", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.414735276896544*^9, 3.414735277886039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"K", ",", "R"}], "}"}], "=", 
   RowBox[{"DecomposeProjVect", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "V1", "]"}], "[", 
     RowBox[{"[", "12", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "R", "]"}]}], "Input",
 CellChangeTimes->{{3.414694571526679*^9, 3.414694601205921*^9}, 
   3.4147376015697327`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.0017542688991628265`", 
      RowBox[{"-", "1.3610847510827735`*^-7"}], "0.0004823804588284783`"},
     {
      RowBox[{"-", "7.716492121689153`*^-20"}], 
      RowBox[{"-", "0.0017543414455340205`"}], "0.00036218671118137233`"},
     {
      RowBox[{"-", "1.0077401457057096`*^-23"}], "5.2182316058757714`*^-23", 
      "1.5076250062522096`*^-6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.41473535154152*^9, 3.415163372414339*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8001430338222504`", "0.267333349037371`", 
      RowBox[{"-", "0.5369394806849168`"}]},
     {"0.4619021412290049`", 
      RowBox[{"-", "0.845705963374422`"}], "0.26725986500221294`"},
     {
      RowBox[{"-", "0.38264544601208217`"}], 
      RowBox[{"-", "0.4618596150405488`"}], 
      RowBox[{"-", "0.8001675815982616`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.41473535154152*^9, 3.415163372420023*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The eigenvector compared to the solution, normalized", "Text",
 CellChangeTimes->{{3.4146946098032417`*^9, 3.414694620161455*^9}, {
  3.4147349628458567`*^9, 3.414734964703424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "V1", "]"}], "[", 
    RowBox[{"[", "12", "]"}], "]"}], "-", 
   RowBox[{"ProjVect", "/", 
    RowBox[{"Norm", "[", "ProjVect", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.413818914606864*^9, 3.4138189182870197`*^9}, {
  3.413819020916525*^9, 3.4138190606512747`*^9}, {3.413819193638865*^9, 
  3.413819243950182*^9}, {3.41469462671576*^9, 3.414694633854453*^9}, {
  3.4147350028547907`*^9, 3.41473501478699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002437594281155612`", ",", "0.0004922907950834887`", ",", 
   RowBox[{"-", "0.0026555660107594518`"}], ",", "0.876638647849848`", ",", 
   RowBox[{"-", "0.001897433412857559`"}], ",", "0.002632332318833202`", ",", 
   
   RowBox[{"-", "0.0015168390341629345`"}], ",", "1.7976212661149025`", ",", 
   RowBox[{"-", "1.153616364486489`*^-6"}], ",", 
   RowBox[{"-", "1.3924864284935836`*^-6"}], ",", 
   RowBox[{"-", "2.412163686453703`*^-6"}], ",", "0.0060289158841874465`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.414735356090537*^9, 3.415163372505248*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
5.3.3  Single calibration plane, using only points that fall inside the image\
\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134192097644653`*^9, 
  3.413419214414975*^9}, {3.413517904030048*^9, 3.413517906767741*^9}, {
  3.41381679282689*^9, 3.413816816811048*^9}}],

Cell["\<\
5.3.4  Two calibration planes, using only points that fall inside the image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134211453874903`*^9, 
  3.4134211465102177`*^9}, {3.413517912024694*^9, 3.413517913792927*^9}, {
  3.413816794834584*^9, 3.413816818794258*^9}}],

Cell["\<\
5.3.5  Single calibration plane, using only crooked points that fall inside \
the image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134192097644653`*^9, 
  3.413419214414975*^9}, {3.413517904030048*^9, 3.413517906767741*^9}, {
  3.41381679282689*^9, 3.413816853104595*^9}}],

Cell["\<\
5.3.4  Two calibration planes, using only crooked points that fall inside the \
image\
\>", "Subsubsection",
 CellChangeTimes->{{3.4131056341070747`*^9, 3.4131056619288273`*^9}, {
  3.4131062369499197`*^9, 3.413106242910043*^9}, {3.4131068867557383`*^9, 
  3.413106905580057*^9}, {3.413192301028062*^9, 3.413192302679381*^9}, {
  3.413192466047964*^9, 3.413192466546826*^9}, {3.4134211453874903`*^9, 
  3.4134211465102177`*^9}, {3.413517912024694*^9, 3.413517913792927*^9}, {
  3.413816794834584*^9, 3.413816818794258*^9}, {3.4138168585031157`*^9, 
  3.413816858643309*^9}}],

Cell["6. Output of Calibration Data Files", "Section",
 CellChangeTimes->{{3.411706210713298*^9, 3.411706222287887*^9}, 
   3.414697105160345*^9}],

Cell["6.1 Where we work...", "Subsection",
 CellChangeTimes->{3.411680564019103*^9, 3.4117062360585318`*^9, 
  3.41469710700393*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</SDKs/urivisionLib/SDK/Demos/C++/Computer_Vision/Calibration_3D/Data\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FileNames", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.41168035850669*^9, 3.4116803612839403`*^9}, {
  3.4116804247742243`*^9, 3.411680507175013*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"calibration.nb\"\>", ",", "\<\"data01.txt\"\>", 
   ",", "\<\"data02.txt\"\>", ",", "\<\"data03.txt\"\>", 
   ",", "\<\".DS_Store\"\>", ",", "\<\".svn\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.4116805013860283`*^9, 3.4116805079257708`*^9}, 
   3.411710191404146*^9, 3.411729253087023*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.2 Data file index", "Subsection",
 CellChangeTimes->{3.411707526834673*^9, 3.4146971087748613`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataNum", "=", "\"\<01\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.411710185067685*^9, 3.4117101860261583`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["5.3 We generate the parameter file", "Subsection",
 CellChangeTimes->{{3.411707530244856*^9, 3.411707532339981*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataFileName", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<data\>\"", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"dataNum", ",", "\"\<.txt\>\""}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strm", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"dataFileName", ",", 
     RowBox[{"FormatType", "->", "OutputForm"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{
   "strm", ",", "myNcx", ",", "\"\< \>\"", ",", "myNcy", ",", "\"\< \>\"", 
    ",", "mydx", ",", "\"\< \>\"", ",", "mydy", ",", "\"\< \>\"", ",", 
    "myNfx", ",", "\"\< \>\"", ",", "myNfy", ",", "\"\< \>\"", ",", "mydpx", 
    ",", "\"\< \>\"", ",", "mydpy"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", "nbFlPtsIn"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", 
      SuperscriptBox["ptsPerRow", "2"]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"flPointIsIn", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Write", "[", 
          RowBox[{"strm", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flGridPtsIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flGridPtsIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "strm", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.411707613402981*^9, 3.4117076241496058`*^9}, 
   3.411707657761307*^9, {3.411707712130674*^9, 3.4117077168962183`*^9}, {
   3.411707813900557*^9, 3.411707841712907*^9}, 3.412000854423891*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(61\\) of \\!\\({\\(\\({0, 600.`, 0}\\)\\), \
\\(\\({0, 750.`, 0}\\)\\), \\(\\({100.`, 750.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 750.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\({300.`, 750.`, \
\\(\\(-300.`\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({500.`, 750.`, \\(\\(-500.`\\)\\)}\\)\\), \
\\(\\({0, 900.`, 0}\\)\\), \\(\\({100.`, 900.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 900.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 46 \
\[RightSkeleton]\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.411710195470646*^9, 3.411729256792471*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(61\\) of \\!\\({\\(\\({0, 600.`, 0}\\)\\), \
\\(\\({0, 750.`, 0}\\)\\), \\(\\({100.`, 750.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 750.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\({300.`, 750.`, \
\\(\\(-300.`\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({500.`, 750.`, \\(\\(-500.`\\)\\)}\\)\\), \
\\(\\({0, 900.`, 0}\\)\\), \\(\\({100.`, 900.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 900.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 46 \
\[RightSkeleton]\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.411710195470646*^9, 3.41172925685419*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(61\\) of \\!\\({\\(\\({0, 600.`, 0}\\)\\), \
\\(\\({0, 750.`, 0}\\)\\), \\(\\({100.`, 750.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 750.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\({300.`, 750.`, \
\\(\\(-300.`\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({500.`, 750.`, \\(\\(-500.`\\)\\)}\\)\\), \
\\(\\({0, 900.`, 0}\\)\\), \\(\\({100.`, 900.`, \\(\\(-100.`\\)\\)}\\)\\), \
\\(\\({200.`, 900.`, \\(\\(-200.`\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 46 \
\[RightSkeleton]\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.411710195470646*^9, 3.411729256913652*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partw\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.411710195470646*^9, 3.4117292569736958`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataFileName", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<dataAndSol\>\"", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"dataNum", ",", "\"\<.txt\>\""}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strm", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"dataFileName", ",", 
     RowBox[{"FormatType", "->", "OutputForm"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{
   "strm", ",", "my\[Psi]", ",", "\"\< \>\"", ",", "my\[Theta]", ",", 
    "\"\< \>\"", ",", "my\[CurlyPhi]", " ", ",", "\"\< \>\"", ",", 
    SubscriptBox["myT", "x"], ",", "\"\< \>\"", ",", 
    SubscriptBox["myT", "y"], ",", "\"\< \>\"", ",", 
    SubscriptBox["myT", "z"]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{
   "strm", ",", "myNcx", ",", "\"\< \>\"", ",", "myNcy", ",", "\"\< \>\"", 
    ",", "mydx", ",", "\"\< \>\"", ",", "mydy", ",", "\"\< \>\"", ",", 
    "myNfx", ",", "\"\< \>\"", ",", "myNfy", ",", "\"\< \>\"", ",", "mydpx", 
    ",", "\"\< \>\"", ",", "mydpy", ",", "\"\< \>\"", ",", "myCx", ",", 
    "\"\< \>\"", ",", "myCy", ",", "\"\< \>\"", ",", "mysx", ",", "\"\< \>\"",
     ",", "myFoc", ",", "\"\< \>\"", ",", 
    SubscriptBox["my\[Kappa]", "1"]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", "nbFlPtsIn"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", 
      SuperscriptBox["ptsPerRow", "2"]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"flPointIsIn", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Write", "[", 
          RowBox[{"strm", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flPtsWorldIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flGridPtsIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
           RowBox[{
            RowBox[{"flGridPtsIn", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}]}], "]"}], ";"}]}], 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "strm", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.411707660286768*^9, 3.41170772163468*^9}, {
   3.4117078434526463`*^9, 3.4117078451634407`*^9}, 3.412000854473207*^9}]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{981, 938},
WindowMargins->{{4, Automatic}, {Automatic, 17}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
MacintoshSystemPageSetup -> \
"00<0004/0B`000002mT8o?mooh<<H`Ui0fL5:0?l0080004/0B`000000]P2:001\n\
0000I00000400`<300000BL?00400@KI>H0000000000060801T1T00000000000\n\
00000000000000000000000000000000",
FrontEndVersion->"6.0 for Mac OS X PowerPC (32-bit) (June 19, 2007)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 88, 2, 113, "Title"],
Cell[681, 27, 348, 7, 81, "Subtitle"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1066, 39, 203, 4, 72, "Section"],
Cell[1272, 45, 80, 1, 37, "Input"],
Cell[1355, 48, 108, 1, 34, "Subsection"],
Cell[1466, 51, 884, 16, 158, "Text"],
Cell[2353, 69, 4448, 128, 498, "Input"],
Cell[CellGroupData[{
Cell[6826, 201, 177, 2, 34, "Subsection"],
Cell[CellGroupData[{
Cell[7028, 207, 1481, 37, 78, "Input"],
Cell[8512, 246, 1631, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10180, 288, 1362, 30, 70, "Input"],
Cell[11545, 320, 1856, 34, 53, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[13440, 359, 187, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[13652, 365, 108, 1, 26, "Subsection"],
Cell[13763, 368, 113, 1, 24, "Subsubsection"],
Cell[13879, 371, 665, 17, 74, "Text"],
Cell[CellGroupData[{
Cell[14569, 392, 916, 26, 72, "Input"],
Cell[15488, 420, 1156, 28, 88, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16693, 454, 132, 1, 24, "Subsubsection"],
Cell[16828, 457, 148, 5, 26, "Text"],
Cell[16979, 464, 1248, 36, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18264, 505, 206, 3, 53, "Input"],
Cell[18473, 510, 1281, 30, 73, "Output"],
Cell[19757, 542, 1323, 31, 89, "Output"]
}, Open  ]],
Cell[21095, 576, 1173, 33, 53, "Input"],
Cell[CellGroupData[{
Cell[22293, 613, 205, 3, 53, "Input"],
Cell[22501, 618, 1265, 30, 73, "Output"],
Cell[23769, 650, 1305, 31, 89, "Output"]
}, Open  ]],
Cell[25089, 684, 1248, 37, 53, "Input"],
Cell[CellGroupData[{
Cell[26362, 725, 206, 3, 53, "Input"],
Cell[26571, 730, 1281, 30, 73, "Output"],
Cell[27855, 762, 1321, 31, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29213, 798, 784, 18, 113, "Input"],
Cell[30000, 818, 2810, 71, 74, "Output"],
Cell[32813, 891, 2852, 72, 90, "Output"],
Cell[35668, 965, 2928, 75, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38633, 1045, 133, 1, 24, "Subsubsection"],
Cell[38769, 1048, 337, 11, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39143, 1064, 114, 1, 34, "Subsection"],
Cell[39260, 1067, 145, 1, 24, "Subsubsection"],
Cell[39408, 1070, 155, 3, 23, "Text"],
Cell[39566, 1075, 26815, 414, 208, "Graphics"]
}, Open  ]],
Cell[66396, 1492, 814, 22, 53, "Input"],
Cell[67213, 1516, 153, 2, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[67391, 1522, 434, 12, 34, "Input"],
Cell[67828, 1536, 9876, 159, 305, 2296, 34, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[77719, 1698, 156, 2, 24, "Subsubsection"],
Cell[77878, 1702, 421, 11, 34, "Input"],
Cell[CellGroupData[{
Cell[78324, 1717, 73, 1, 37, "Input"],
Cell[78400, 1720, 4285, 76, 292, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82722, 1801, 166, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[82913, 1807, 105, 1, 34, "Subsection"],
Cell[83021, 1810, 100, 1, 24, "Subsubsection"],
Cell[83124, 1813, 259, 7, 23, "Text"],
Cell[83386, 1822, 432, 14, 37, "Input"],
Cell[83821, 1838, 101, 1, 24, "Subsubsection"],
Cell[83925, 1841, 120, 3, 23, "Text"],
Cell[84048, 1846, 1119, 35, 109, "Input"],
Cell[85170, 1883, 272, 8, 37, "Input"],
Cell[CellGroupData[{
Cell[85467, 1895, 514, 15, 37, "Input"],
Cell[85984, 1912, 1734, 32, 388, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87767, 1950, 91, 1, 34, "Subsection"],
Cell[87861, 1953, 177, 2, 24, "Subsubsection"],
Cell[88041, 1957, 1124, 21, 185, "Text"],
Cell[CellGroupData[{
Cell[89190, 1982, 128, 1, 24, "Subsubsection"],
Cell[89321, 1985, 398, 14, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89756, 2004, 121, 1, 24, "Subsubsection"],
Cell[89880, 2007, 323, 11, 37, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90252, 2024, 124, 2, 34, "Subsection"],
Cell[90379, 2028, 424, 13, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90840, 2046, 117, 1, 34, "Subsection"],
Cell[90960, 2049, 136, 1, 24, "Subsubsection"],
Cell[91099, 2052, 622, 19, 34, "Input"],
Cell[91724, 2073, 545, 17, 37, "Input"],
Cell[92272, 2092, 109, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[92406, 2097, 545, 11, 34, "Input"],
Cell[92954, 2110, 741, 12, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93732, 2127, 384, 9, 37, "Input"],
Cell[94119, 2138, 590, 10, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94746, 2153, 159, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[94930, 2160, 332, 8, 37, "Input"],
Cell[95265, 2170, 514, 9, 37, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95828, 2185, 337, 8, 37, "Input"],
Cell[96168, 2195, 510, 9, 37, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96739, 2211, 165, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[96929, 2217, 214, 4, 34, "Subsection",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[97168, 2225, 132, 4, 26, "Text",
 Evaluatable->False],
Cell[97303, 2231, 298, 10, 37, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97662, 2248, 971, 39, 48, "Text",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[98658, 2291, 412, 13, 43, "Input"],
Cell[99073, 2306, 670, 13, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99792, 2325, 271, 8, 60, "Input"],
Cell[100066, 2335, 764, 17, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100867, 2357, 407, 9, 41, "Text",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[101299, 2370, 283, 9, 43, "Input"],
Cell[101585, 2381, 4947, 153, 240, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106581, 2540, 109, 2, 24, "SmallText",
 Evaluatable->False],
Cell[106693, 2544, 1390, 44, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108120, 2593, 95, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[108240, 2598, 120, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[108385, 2603, 110, 2, 26, "Text",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[108520, 2609, 343, 10, 37, "Input"],
Cell[108866, 2621, 646, 11, 37, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109585, 2640, 315, 9, 37, "Input"],
Cell[109903, 2651, 646, 11, 37, "Output"]
}, Open  ]],
Cell[110564, 2665, 96, 1, 24, "Subsubsection"],
Cell[110663, 2668, 87, 2, 23, "Text"],
Cell[CellGroupData[{
Cell[110775, 2674, 244, 6, 41, "Text",
 Evaluatable->False],
Cell[111022, 2682, 545, 15, 98, "Input"],
Cell[111570, 2699, 1545, 47, 68, "Input"]
}, Open  ]],
Cell[113130, 2749, 333, 10, 37, "Input"],
Cell[113466, 2761, 152, 4, 37, "Input"],
Cell[CellGroupData[{
Cell[113643, 2769, 210, 5, 24, "SmallText",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[113878, 2778, 642, 18, 53, "Input"],
Cell[114523, 2798, 1193, 23, 388, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115765, 2827, 640, 18, 53, "Input"],
Cell[116408, 2847, 1740, 32, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118185, 2884, 142, 3, 37, "Input"],
Cell[118330, 2889, 2250, 41, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120617, 2935, 116, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[120758, 2940, 123, 1, 24, "Subsubsection"],
Cell[120884, 2943, 409, 13, 37, "Input"],
Cell[121296, 2958, 438, 14, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121771, 2977, 121, 1, 24, "Subsubsection"],
Cell[121895, 2980, 326, 8, 37, "Input"],
Cell[CellGroupData[{
Cell[122246, 2992, 706, 19, 53, "Input"],
Cell[122955, 3013, 1474, 28, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124466, 3046, 141, 3, 37, "Input"],
Cell[124610, 3051, 1883, 36, 388, "Output"]
}, Open  ]],
Cell[126508, 3090, 291, 8, 37, "Input"],
Cell[CellGroupData[{
Cell[126824, 3102, 767, 20, 53, "Input"],
Cell[127594, 3124, 897, 19, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128528, 3148, 218, 5, 37, "Input"],
Cell[128749, 3155, 2368, 45, 388, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[131156, 3205, 129, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[131310, 3210, 336, 6, 18, "Subsubsection"],
Cell[CellGroupData[{
Cell[131671, 3220, 327, 8, 37, "Input"],
Cell[132001, 3230, 1056, 18, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133094, 3253, 854, 22, 53, "Input"],
Cell[133951, 3277, 683, 13, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134671, 3295, 328, 8, 37, "Input"],
Cell[135002, 3305, 708, 14, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135747, 3324, 514, 8, 37, "Input"],
Cell[136264, 3334, 1201, 21, 53, "Output"]
}, Open  ]],
Cell[137480, 3358, 935, 24, 61, "Text"],
Cell[138418, 3384, 176, 3, 37, "Input"],
Cell[138597, 3389, 2578, 71, 108, "Input"],
Cell[CellGroupData[{
Cell[141200, 3464, 338, 7, 37, "Input"],
Cell[141541, 3473, 529, 9, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142107, 3487, 187, 2, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[142319, 3493, 909, 21, 53, "Input"],
Cell[143231, 3516, 1101, 26, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144369, 3547, 649, 16, 53, "Input"],
Cell[145021, 3565, 1312, 29, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146370, 3599, 164, 3, 37, "Input"],
Cell[146537, 3604, 772, 14, 37, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147370, 3625, 179, 2, 34, "Subsection"],
Cell[CellGroupData[{
Cell[147574, 3631, 330, 6, 24, "Subsubsection"],
Cell[147907, 3639, 1065, 35, 52, "Text"],
Cell[CellGroupData[{
Cell[148997, 3678, 468, 13, 53, "Input"],
Cell[149468, 3693, 699, 19, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150204, 3717, 1454, 42, 113, "Input"],
Cell[151661, 3761, 2655, 87, 122, "Output"],
Cell[154319, 3850, 1316, 42, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155672, 3897, 473, 13, 53, "Input"],
Cell[156148, 3912, 727, 20, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156912, 3937, 812, 23, 53, "Input"],
Cell[157727, 3962, 859, 14, 59, "Message"],
Cell[158589, 3978, 214, 6, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158840, 3989, 1479, 42, 111, "Input"],
Cell[160322, 4033, 2748, 88, 125, "Output"],
Cell[163073, 4123, 2706, 88, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165816, 4216, 522, 14, 53, "Input"],
Cell[166341, 4232, 704, 19, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167082, 4256, 730, 20, 53, "Input"],
Cell[167815, 4278, 1099, 32, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168951, 4315, 1504, 43, 111, "Input"],
Cell[170458, 4360, 1996, 62, 108, "Output"],
Cell[172457, 4424, 5741, 184, 122, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178247, 4614, 221, 4, 24, "Subsubsection"],
Cell[178471, 4620, 7805, 215, 461, "Input"],
Cell[CellGroupData[{
Cell[186301, 4839, 629, 14, 68, "Input"],
Cell[186933, 4855, 1387, 30, 83, "Output"],
Cell[188323, 4887, 1485, 31, 83, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[189847, 4923, 95, 1, 72, "Section"],
Cell[CellGroupData[{
Cell[189967, 4928, 126, 1, 18, "Subsubsection"],
Cell[CellGroupData[{
Cell[190118, 4933, 430, 13, 37, "Input"],
Cell[190551, 4948, 483, 11, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191071, 4964, 751, 23, 37, "Input"],
Cell[191825, 4989, 612, 15, 37, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192486, 5010, 310, 4, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[192821, 5018, 172, 4, 37, "Input"],
Cell[192996, 5024, 1451, 30, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194484, 5059, 180, 4, 37, "Input"],
Cell[194667, 5065, 1506, 32, 99, "Output"]
}, Open  ]],
Cell[196188, 5100, 218, 5, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[196431, 5109, 304, 8, 34, "Input"],
Cell[196738, 5119, 1257, 27, 83, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198044, 5152, 119, 1, 34, "Subsection"],
Cell[198166, 5155, 355, 6, 41, "Text"],
Cell[198524, 5163, 2462, 72, 132, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201023, 5240, 119, 2, 37, "Input"],
Cell[201145, 5244, 5268, 82, 304, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206450, 5331, 123, 2, 37, "Input"],
Cell[206576, 5335, 2952, 50, 305, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209565, 5390, 111, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[209701, 5395, 118, 1, 24, "Subsubsection"],
Cell[209822, 5398, 691, 19, 98, "Input"],
Cell[CellGroupData[{
Cell[210538, 5421, 73, 1, 37, "Input"],
Cell[210614, 5424, 6714, 117, 294, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217365, 5546, 145, 2, 37, "Input"],
Cell[217513, 5550, 4346, 79, 294, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221920, 5636, 128, 2, 24, "Subsubsection"],
Cell[222051, 5640, 516, 16, 53, "Input"],
Cell[CellGroupData[{
Cell[222592, 5660, 41, 0, 37, "Input"],
Cell[222636, 5662, 521, 14, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223194, 5681, 612, 14, 37, "Input"],
Cell[223809, 5697, 4810, 82, 295, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228656, 5784, 621, 14, 53, "Input"],
Cell[229280, 5800, 3199, 55, 295, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232528, 5861, 94, 1, 24, "Subsubsection"],
Cell[232625, 5864, 1361, 39, 87, "Input"],
Cell[CellGroupData[{
Cell[234011, 5907, 593, 14, 53, "Input"],
Cell[234607, 5923, 4717, 80, 295, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239361, 6008, 653, 15, 53, "Input"],
Cell[240017, 6025, 3299, 56, 295, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[243365, 6087, 156, 4, 24, "Subsubsection"],
Cell[243524, 6093, 160, 3, 26, "Text"],
Cell[243687, 6098, 1179, 32, 83, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244903, 6135, 185, 4, 26, "Text"],
Cell[245091, 6141, 1054, 30, 83, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246182, 6176, 113, 3, 26, "Text"],
Cell[246298, 6181, 5134, 142, 428, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251469, 6328, 352, 12, 41, "Text"],
Cell[CellGroupData[{
Cell[251846, 6344, 589, 13, 37, "Input"],
Cell[252438, 6359, 982, 17, 296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253457, 6381, 549, 13, 53, "Input"],
Cell[254009, 6396, 806, 15, 296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254852, 6416, 553, 13, 53, "Input"],
Cell[255408, 6431, 1113, 20, 296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256558, 6456, 529, 12, 53, "Input"],
Cell[257090, 6470, 1104, 19, 296, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[258243, 6495, 176, 3, 24, "Subsubsection"],
Cell[258422, 6500, 570, 16, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259029, 6521, 87, 2, 26, "Text"],
Cell[259119, 6525, 577, 16, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259733, 6546, 113, 3, 26, "Text"],
Cell[259849, 6551, 2845, 81, 248, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262731, 6637, 419, 11, 41, "Text"],
Cell[CellGroupData[{
Cell[263175, 6652, 493, 11, 37, "Input"],
Cell[263671, 6665, 1983, 32, 296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265691, 6702, 499, 11, 53, "Input"],
Cell[266193, 6715, 5056, 84, 296, 1158, 20, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[271298, 6805, 243, 3, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[271566, 6812, 901, 21, 68, "Input"],
Cell[272470, 6835, 2191, 38, 295, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274698, 6878, 848, 20, 68, "Input"],
Cell[275549, 6900, 1789, 29, 295, "Output"]
}, Open  ]]
}, Open  ]],
Cell[277365, 6933, 150, 5, 92, "Section"],
Cell[CellGroupData[{
Cell[277540, 6942, 504, 9, 26, "Subsection"],
Cell[CellGroupData[{
Cell[278069, 6955, 321, 8, 24, "Subsubsection"],
Cell[278393, 6965, 4345, 111, 143, "Input"],
Cell[CellGroupData[{
Cell[282763, 7080, 279, 7, 37, "Input"],
Cell[283045, 7089, 2442, 33, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[285536, 7128, 418, 9, 24, "Subsubsection"],
Cell[285957, 7139, 4390, 112, 143, "Input"],
Cell[CellGroupData[{
Cell[290372, 7255, 220, 6, 37, "Input"],
Cell[290595, 7263, 4520, 60, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295164, 7329, 430, 8, 24, "Subsubsection"],
Cell[295597, 7339, 4956, 116, 188, "Input"],
Cell[CellGroupData[{
Cell[300578, 7459, 277, 7, 37, "Input"],
Cell[300858, 7468, 677, 12, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301584, 7486, 428, 7, 24, "Subsubsection"],
Cell[302015, 7495, 4827, 116, 158, "Input"],
Cell[CellGroupData[{
Cell[306867, 7615, 273, 7, 37, "Input"],
Cell[307143, 7624, 930, 15, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[308134, 7646, 171, 3, 26, "Subsection"],
Cell[CellGroupData[{
Cell[308330, 7653, 367, 8, 24, "Subsubsection"],
Cell[308700, 7663, 4841, 122, 128, "Input"],
Cell[CellGroupData[{
Cell[313566, 7789, 548, 11, 37, "Input"],
Cell[314117, 7802, 2565, 35, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[316731, 7843, 248, 5, 37, "Input"],
Cell[316982, 7850, 686, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317705, 7866, 47, 0, 37, "Input"],
Cell[317755, 7868, 622, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318414, 7885, 220, 5, 37, "Input"],
Cell[318637, 7892, 701, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319375, 7910, 418, 9, 24, "Subsubsection"],
Cell[319796, 7921, 4874, 122, 128, "Input"],
Cell[CellGroupData[{
Cell[324695, 8047, 586, 12, 37, "Input"],
Cell[325284, 8061, 4454, 59, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329775, 8125, 283, 6, 37, "Input"],
Cell[330061, 8133, 682, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330780, 8150, 47, 0, 37, "Input"],
Cell[330830, 8152, 630, 12, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[331509, 8170, 218, 5, 37, "Input"],
Cell[331730, 8177, 363, 7, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332130, 8189, 482, 8, 24, "Subsubsection"],
Cell[332615, 8199, 5190, 123, 158, "Input"],
Cell[CellGroupData[{
Cell[337830, 8326, 472, 10, 37, "Input"],
Cell[338305, 8338, 754, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339096, 8356, 352, 6, 37, "Input"],
Cell[339451, 8364, 706, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340194, 8381, 47, 0, 37, "Input"],
Cell[340244, 8383, 626, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340907, 8400, 216, 5, 37, "Input"],
Cell[341126, 8407, 701, 13, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[341876, 8426, 482, 8, 24, "Subsubsection"],
Cell[342361, 8436, 5047, 123, 158, "Input"],
Cell[CellGroupData[{
Cell[347433, 8563, 389, 9, 37, "Input"],
Cell[347825, 8574, 1004, 16, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348866, 8595, 387, 7, 37, "Input"],
Cell[349256, 8604, 681, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[349974, 8621, 47, 0, 37, "Input"],
Cell[350024, 8623, 626, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350687, 8640, 220, 5, 37, "Input"],
Cell[350910, 8647, 404, 8, 70, "Output"]
}, Open  ]],
Cell[351329, 8658, 185, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[351539, 8666, 628, 17, 83, "Input"],
Cell[352170, 8685, 374, 7, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[352605, 8699, 164, 3, 26, "Subsection"],
Cell[352772, 8704, 1680, 63, 41, "Text"],
Cell[CellGroupData[{
Cell[354477, 8771, 512, 10, 24, "Subsubsection"],
Cell[354992, 8783, 2324, 56, 83, "Input"],
Cell[CellGroupData[{
Cell[357341, 8843, 282, 7, 43, "Input"],
Cell[357626, 8852, 2254, 31, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359917, 8888, 171, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[360113, 8896, 249, 6, 37, "Input"],
Cell[360365, 8904, 138, 2, 37, "Output"]
}, Open  ]],
Cell[360518, 8909, 365, 9, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[360920, 8923, 631, 14, 83, "Input"],
Cell[361554, 8939, 943, 23, 89, "Output"],
Cell[362500, 8964, 951, 24, 83, "Output"],
Cell[363454, 8990, 911, 22, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364402, 9017, 899, 26, 68, "Input"],
Cell[365304, 9045, 844, 21, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[366185, 9071, 187, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[366397, 9077, 508, 11, 37, "Input"],
Cell[366908, 9090, 600, 11, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[367569, 9108, 559, 11, 24, "Subsubsection"],
Cell[368131, 9121, 2368, 57, 83, "Input"],
Cell[CellGroupData[{
Cell[370524, 9182, 325, 8, 43, "Input"],
Cell[370852, 9192, 4384, 58, 158, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375273, 9255, 171, 4, 26, "Text"],
Cell[375447, 9261, 405, 9, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375889, 9275, 200, 5, 37, "Input"],
Cell[376092, 9282, 111, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[376240, 9288, 631, 14, 83, "Input"],
Cell[376874, 9304, 971, 24, 92, "Output"],
Cell[377848, 9330, 957, 24, 83, "Output"],
Cell[378808, 9356, 913, 22, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[379758, 9383, 187, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[379970, 9389, 508, 11, 37, "Input"],
Cell[380481, 9402, 647, 12, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[381189, 9421, 456, 11, 68, "Input"],
Cell[381648, 9434, 1025, 26, 92, "Output"],
Cell[382676, 9462, 1007, 26, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383720, 9493, 225, 6, 37, "Input"],
Cell[383948, 9501, 904, 24, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384889, 9530, 511, 10, 24, "Subsubsection"],
Cell[385403, 9542, 2263, 55, 83, "Input"],
Cell[CellGroupData[{
Cell[387691, 9601, 130, 2, 37, "Input"],
Cell[387824, 9605, 7712, 141, 263, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[395573, 9751, 171, 4, 26, "Text"],
Cell[395747, 9757, 312, 8, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[396096, 9770, 482, 12, 68, "Input"],
Cell[396581, 9784, 980, 25, 92, "Output"],
Cell[397564, 9811, 900, 23, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398501, 9839, 111, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[398637, 9844, 181, 4, 37, "Input"],
Cell[398821, 9850, 573, 11, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[399443, 9867, 187, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[399655, 9873, 508, 11, 37, "Input"],
Cell[400166, 9886, 530, 11, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[400747, 9903, 563, 11, 24, "Subsubsection"],
Cell[401313, 9916, 1964, 51, 80, "Input"],
Cell[403280, 9969, 257, 7, 37, "Input"],
Cell[CellGroupData[{
Cell[403562, 9980, 482, 12, 68, "Input"],
Cell[404047, 9994, 970, 24, 92, "Output"],
Cell[405020, 10020, 950, 24, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406007, 10049, 187, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[406219, 10055, 508, 11, 37, "Input"],
Cell[406730, 10068, 601, 11, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[407358, 10083, 524, 9, 24, "Subsubsection"],
Cell[407885, 10094, 523, 8, 18, "Subsubsection"],
Cell[408411, 10104, 532, 9, 18, "Subsubsection"],
Cell[408946, 10115, 584, 10, 18, "Subsubsection"],
Cell[409533, 10127, 146, 2, 42, "Section"],
Cell[409682, 10131, 132, 2, 26, "Subsection"],
Cell[CellGroupData[{
Cell[409839, 10137, 345, 8, 50, "Input"],
Cell[410187, 10147, 338, 6, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410562, 10158, 107, 1, 34, "Subsection"],
Cell[410672, 10161, 150, 3, 37, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410859, 10169, 122, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[411006, 10174, 2655, 67, 199, "Input"],
Cell[413664, 10243, 911, 15, 57, "Message"],
Cell[414578, 10260, 910, 15, 57, "Message"],
Cell[415491, 10277, 911, 15, 57, "Message"],
Cell[416405, 10294, 477, 9, 23, "Message"]
}, Open  ]],
Cell[416897, 10306, 3131, 77, 236, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
